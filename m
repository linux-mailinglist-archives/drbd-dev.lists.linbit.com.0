Return-Path: <drbd-dev-bounces@lists.linbit.com>
X-Original-To: lists+drbd-dev@lfdr.de
Delivered-To: lists+drbd-dev@lfdr.de
Received: from mail19.linbit.com (mail19.linbit.com [159.69.154.96])
	by mail.lfdr.de (Postfix) with ESMTPS id CFE414F5A14
	for <lists+drbd-dev@lfdr.de>; Wed,  6 Apr 2022 11:36:38 +0200 (CEST)
Received: from mail19.linbit.com (localhost [127.0.0.1])
	by mail19.linbit.com (LINBIT Mail Daemon) with ESMTP id 9FA46420FC7;
	Wed,  6 Apr 2022 11:36:37 +0200 (CEST)
X-Original-To: drbd-dev@lists.linbit.com
Delivered-To: drbd-dev@lists.linbit.com
Received: from mail-ej1-f43.google.com (mail-ej1-f43.google.com
	[209.85.218.43])
	by mail19.linbit.com (LINBIT Mail Daemon) with ESMTP id C2A05420FBB
	for <drbd-dev@lists.linbit.com>; Wed,  6 Apr 2022 11:36:36 +0200 (CEST)
Received: by mail-ej1-f43.google.com with SMTP id ot30so2965447ejb.12
	for <drbd-dev@lists.linbit.com>; Wed, 06 Apr 2022 02:36:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=linbit-com.20210112.gappssmtp.com; s=20210112;
	h=message-id:date:mime-version:user-agent:subject:content-language:to
	:references:cc:from:in-reply-to:content-transfer-encoding;
	bh=PWGMoKi8OF6Zq/711+UiAQ+xa9ney+szy3B/3NgjzSc=;
	b=a22T7E1nfhoSx1okJzZoXCA4svHYPYHT7JUHzn5uJUtghSBmXMl6XJX4z+p5d5Y2qY
	QkafctBdcM/j5f65l6ubqQAts61JIRmAFtwgBdrxGOrI1FddNgyD58JOeGS1iVZVYfsR
	8pIQsdHP5o49WhE6Ay7pWatQwlLPwTAEH915cfwpnZLlyxIEJ7kJELkF3RmXvnMD8aOJ
	MdP7Zaa0i+HxMr+kbtljx6B4GywRNOBUx6/aEDoCfc9guIZe0gtQD9b7yuZU3fcVOVmH
	TXTYKZTVQEiATq7vDEj7fiTdJ7cbSs2SclAGDGLUFu11IMUicb2cRlcLmVa1t5Zbwh/Z
	mLnw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=1e100.net; s=20210112;
	h=x-gm-message-state:message-id:date:mime-version:user-agent:subject
	:content-language:to:references:cc:from:in-reply-to
	:content-transfer-encoding;
	bh=PWGMoKi8OF6Zq/711+UiAQ+xa9ney+szy3B/3NgjzSc=;
	b=QY0yaK4e1GJA+vZMe8GbyU6/hmhrOLNMajZSlmDOleS+ZVMBs3IQBb+baFqdfndoLc
	Rnvr8LVTQeMHZXUVri9IWeK4idUM0jPst3RGohJA/C0zgHKnymdG2rz7p9XS14cRHDse
	JTcPLqypBYg/Qawl1VMol5icpN071okLjkyON+6+wf2IW4cCMg0dbNsppOj0cTql0+P4
	5wqg56yYIifU0P4jYKNVy6gjcH7WwSi6Cf+RAJB7sZb2uGd1X/3i2LqgSoLSBSWElFum
	6ampGzmbjKT6siztwgDJbdg4CP9USyCKtn+wCWGgg4K2EMsyrESIl+uHkqgFKtf5IxcO
	g43A==
X-Gm-Message-State: AOAM530Bvo4gB3UqQ/oevAJv28fR+3T/EYQ7yku0muKq2xFh/ltgqf7u
	9c6GA8XU6dyTXIaOweeNsVNyXRs/
X-Google-Smtp-Source: ABdhPJzyoUAVQ6w2uwfROduvLMbbIXH7Ik0Ldggdm6WPtVgEt/3pn1eD1qxQKBZ31QaVM9uquGCXGQ==
X-Received: by 2002:a17:907:9482:b0:6da:a24e:e767 with SMTP id
	dm2-20020a170907948200b006daa24ee767mr7471675ejc.479.1649237795717;
	Wed, 06 Apr 2022 02:36:35 -0700 (PDT)
Received: from [192.168.178.55] (85-127-190-169.dsl.dynamic.surfer.at.
	[85.127.190.169]) by smtp.gmail.com with ESMTPSA id
	n27-20020a1709062bdb00b006da975173bfsm6479297ejg.170.2022.04.06.02.36.34
	(version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
	Wed, 06 Apr 2022 02:36:35 -0700 (PDT)
Message-ID: <d302fc03-f97e-ad43-6a11-dd3dfe0cffaa@linbit.com>
Date: Wed, 6 Apr 2022 11:36:34 +0200
MIME-Version: 1.0
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101
	Thunderbird/91.7.0
Content-Language: en-US
To: Christoph Hellwig <hch@lst.de>
References: <20220406060516.409838-1-hch@lst.de>
	<20220406060516.409838-24-hch@lst.de>
From: =?UTF-8?Q?Christoph_B=c3=b6hmwalder?= <christoph.boehmwalder@linbit.com>
In-Reply-To: <20220406060516.409838-24-hch@lst.de>
Cc: linux-block@vger.kernel.org, Jens Axboe <axboe@kernel.dk>,
	drbd-dev@lists.linbit.com
Subject: Re: [Drbd-dev] [PATCH 23/27] block: add a bdev_max_discard_sectors
 helper
X-BeenThere: drbd-dev@lists.linbit.com
X-Mailman-Version: 2.1.11
Precedence: list
List-Id: "*Coordination* of development, patches,
	contributions -- *Questions* \(even to developers\) go to drbd-user,
	please." <drbd-dev.lists.linbit.com>
List-Unsubscribe: <https://lists.linbit.com/mailman/options/drbd-dev>,
	<mailto:drbd-dev-request@lists.linbit.com?subject=unsubscribe>
List-Archive: <http://lists.linbit.com/pipermail/drbd-dev>
List-Post: <mailto:drbd-dev@lists.linbit.com>
List-Help: <mailto:drbd-dev-request@lists.linbit.com?subject=help>
List-Subscribe: <https://lists.linbit.com/mailman/listinfo/drbd-dev>,
	<mailto:drbd-dev-request@lists.linbit.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: drbd-dev-bounces@lists.linbit.com
Errors-To: drbd-dev-bounces@lists.linbit.com

QW0gMDYuMDQuMjIgdW0gMDg6MDUgc2NocmllYiBDaHJpc3RvcGggSGVsbHdpZzoKPiBBZGQgYSBo
ZWxwZXIgdG8gcXVlcnkgdGhlIG51bWJlciBvZiBzZWN0b3JzIHN1cHBvcnQgcGVyIGVhY2ggZGlz
Y2FyZCBiaW8KPiBiYXNlZCBvbiB0aGUgYmxvY2sgZGV2aWNlIGFuZCB1c2UgdGhpcyBoZWxwZXIg
dG8gc3RvcCB2YXJpb3VzIHBsYWNlcyBmcm9tCj4gcG9raW5nIGludG8gdGhlIHJlcXVlc3RfcXVl
dWUgdG8gc2VlIGlmIGRpc2NhcmQgaXMgc3VwcG9ydGVkIGFuZCBpZiBzbyBob3cKPiBtdWNoLiAg
VGhpcyBtaXJyb3JzIHdoYXQgaXMgZG9uZSBlLmcuIGZvciB3cml0ZSB6ZXJvZXMgYXMgd2VsbC4K
PiAKPiBTaWduZWQtb2ZmLWJ5OiBDaHJpc3RvcGggSGVsbHdpZyA8aGNoQGxzdC5kZT4KPiAtLS0K
PiAgYmxvY2svYmxrLWNvcmUuYyAgICAgICAgICAgICAgICAgICAgfCAgMiArLQo+ICBibG9jay9i
bGstbGliLmMgICAgICAgICAgICAgICAgICAgICB8ICAyICstCj4gIGJsb2NrL2lvY3RsLmMgICAg
ICAgICAgICAgICAgICAgICAgIHwgIDMgKy0tCj4gIGRyaXZlcnMvYmxvY2svZHJiZC9kcmJkX21h
aW4uYyAgICAgIHwgIDIgKy0KPiAgZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfbmwuYyAgICAgICAg
fCAxMiArKysrKysrLS0tLS0KPiAgZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfcmVjZWl2ZXIuYyAg
fCAgNSArKy0tLQoKRm9yIHRoZSBEUkJEIHBhcnQ6CgpBY2tlZC1ieTogQ2hyaXN0b3BoIELDtmht
d2FsZGVyIDxjaHJpc3RvcGguYm9laG13YWxkZXJAbGluYml0LmNvbT4KCj4gIGRyaXZlcnMvYmxv
Y2svbG9vcC5jICAgICAgICAgICAgICAgIHwgIDkgKysrLS0tLS0tCj4gIGRyaXZlcnMvYmxvY2sv
cm5iZC9ybmJkLXNydi1kZXYuaCAgIHwgIDYgKy0tLS0tCj4gIGRyaXZlcnMvYmxvY2sveGVuLWJs
a2JhY2sveGVuYnVzLmMgIHwgIDIgKy0KPiAgZHJpdmVycy9tZC9iY2FjaGUvcmVxdWVzdC5jICAg
ICAgICAgfCAgNCArKy0tCj4gIGRyaXZlcnMvbWQvYmNhY2hlL3N1cGVyLmMgICAgICAgICAgIHwg
IDIgKy0KPiAgZHJpdmVycy9tZC9iY2FjaGUvc3lzZnMuYyAgICAgICAgICAgfCAgMiArLQo+ICBk
cml2ZXJzL21kL2RtLWNhY2hlLXRhcmdldC5jICAgICAgICB8ICA5ICstLS0tLS0tLQo+ICBkcml2
ZXJzL21kL2RtLWNsb25lLXRhcmdldC5jICAgICAgICB8ICA5ICstLS0tLS0tLQo+ICBkcml2ZXJz
L21kL2RtLWlvLmMgICAgICAgICAgICAgICAgICB8ICAyICstCj4gIGRyaXZlcnMvbWQvZG0tbG9n
LXdyaXRlcy5jICAgICAgICAgIHwgIDMgKy0tCj4gIGRyaXZlcnMvbWQvZG0tcmFpZC5jICAgICAg
ICAgICAgICAgIHwgIDkgKystLS0tLS0tCj4gIGRyaXZlcnMvbWQvZG0tdGFibGUuYyAgICAgICAg
ICAgICAgIHwgIDQgKy0tLQo+ICBkcml2ZXJzL21kL2RtLXRoaW4uYyAgICAgICAgICAgICAgICB8
ICA5ICstLS0tLS0tLQo+ICBkcml2ZXJzL21kL2RtLmMgICAgICAgICAgICAgICAgICAgICB8ICAy
ICstCj4gIGRyaXZlcnMvbWQvbWQtbGluZWFyLmMgICAgICAgICAgICAgIHwgIDQgKystLQo+ICBk
cml2ZXJzL21kL3JhaWQwLmMgICAgICAgICAgICAgICAgICB8ICAyICstCj4gIGRyaXZlcnMvbWQv
cmFpZDEuYyAgICAgICAgICAgICAgICAgIHwgIDYgKysrLS0tCj4gIGRyaXZlcnMvbWQvcmFpZDEw
LmMgICAgICAgICAgICAgICAgIHwgIDggKysrKy0tLS0KPiAgZHJpdmVycy9tZC9yYWlkNS1jYWNo
ZS5jICAgICAgICAgICAgfCAgMiArLQo+ICBkcml2ZXJzL3RhcmdldC90YXJnZXRfY29yZV9kZXZp
Y2UuYyB8ICA4ICsrKy0tLS0tCj4gIGZzL2J0cmZzL2V4dGVudC10cmVlLmMgICAgICAgICAgICAg
IHwgIDQgKystLQo+ICBmcy9idHJmcy9pb2N0bC5jICAgICAgICAgICAgICAgICAgICB8ICAyICst
Cj4gIGZzL2V4ZmF0L2ZpbGUuYyAgICAgICAgICAgICAgICAgICAgIHwgIDIgKy0KPiAgZnMvZXhm
YXQvc3VwZXIuYyAgICAgICAgICAgICAgICAgICAgfCAxMCArKystLS0tLS0tCj4gIGZzL2V4dDQv
aW9jdGwuYyAgICAgICAgICAgICAgICAgICAgIHwgMTAgKysrLS0tLS0tLQo+ICBmcy9leHQ0L3N1
cGVyLmMgICAgICAgICAgICAgICAgICAgICB8IDEwICsrKy0tLS0tLS0KPiAgZnMvZjJmcy9mMmZz
LmggICAgICAgICAgICAgICAgICAgICAgfCAgMyArLS0KPiAgZnMvZjJmcy9zZWdtZW50LmMgICAg
ICAgICAgICAgICAgICAgfCAgNiArKy0tLS0KPiAgZnMvZmF0L2ZpbGUuYyAgICAgICAgICAgICAg
ICAgICAgICAgfCAgMiArLQo+ICBmcy9mYXQvaW5vZGUuYyAgICAgICAgICAgICAgICAgICAgICB8
IDEwICsrKy0tLS0tLS0KPiAgZnMvZ2ZzMi9yZ3JwLmMgICAgICAgICAgICAgICAgICAgICAgfCAg
MiArLQo+ICBmcy9qYmQyL2pvdXJuYWwuYyAgICAgICAgICAgICAgICAgICB8ICA3ICsrLS0tLS0K
PiAgZnMvamZzL2lvY3RsLmMgICAgICAgICAgICAgICAgICAgICAgfCAgMiArLQo+ICBmcy9qZnMv
c3VwZXIuYyAgICAgICAgICAgICAgICAgICAgICB8ICA4ICsrLS0tLS0tCj4gIGZzL25pbGZzMi9p
b2N0bC5jICAgICAgICAgICAgICAgICAgIHwgIDIgKy0KPiAgZnMvbnRmczMvZmlsZS5jICAgICAg
ICAgICAgICAgICAgICAgfCAgMiArLQo+ICBmcy9udGZzMy9zdXBlci5jICAgICAgICAgICAgICAg
ICAgICB8ICAyICstCj4gIGZzL29jZnMyL2lvY3RsLmMgICAgICAgICAgICAgICAgICAgIHwgIDIg
Ky0KPiAgZnMveGZzL3hmc19kaXNjYXJkLmMgICAgICAgICAgICAgICAgfCAgMiArLQo+ICBmcy94
ZnMveGZzX3N1cGVyLmMgICAgICAgICAgICAgICAgICB8IDEyICsrKystLS0tLS0tLQo+ICBpbmNs
dWRlL2xpbnV4L2Jsa2Rldi5oICAgICAgICAgICAgICB8ICA1ICsrKysrCj4gIG1tL3N3YXBmaWxl
LmMgICAgICAgICAgICAgICAgICAgICAgIHwgMTcgKystLS0tLS0tLS0tLS0tLS0KPiAgNDggZmls
ZXMgY2hhbmdlZCwgODcgaW5zZXJ0aW9ucygrKSwgMTYzIGRlbGV0aW9ucygtKQo+IAo+IGRpZmYg
LS1naXQgYS9ibG9jay9ibGstY29yZS5jIGIvYmxvY2svYmxrLWNvcmUuYwo+IGluZGV4IDkzN2Ji
NmI4NjMzMTcuLmI1YzNhODA0OTEzNGMgMTAwNjQ0Cj4gLS0tIGEvYmxvY2svYmxrLWNvcmUuYwo+
ICsrKyBiL2Jsb2NrL2Jsay1jb3JlLmMKPiBAQCAtODIwLDcgKzgyMCw3IEBAIHZvaWQgc3VibWl0
X2Jpb19ub2FjY3Qoc3RydWN0IGJpbyAqYmlvKQo+ICAKPiAgCXN3aXRjaCAoYmlvX29wKGJpbykp
IHsKPiAgCWNhc2UgUkVRX09QX0RJU0NBUkQ6Cj4gLQkJaWYgKCFibGtfcXVldWVfZGlzY2FyZChx
KSkKPiArCQlpZiAoIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhiZGV2KSkKPiAgCQkJZ290byBu
b3Rfc3VwcG9ydGVkOwo+ICAJCWJyZWFrOwo+ICAJY2FzZSBSRVFfT1BfU0VDVVJFX0VSQVNFOgo+
IGRpZmYgLS1naXQgYS9ibG9jay9ibGstbGliLmMgYi9ibG9jay9ibGstbGliLmMKPiBpbmRleCAy
YWUzMmE3MjI4NTFjLi44YjRiNjZkM2E5YmZjIDEwMDY0NAo+IC0tLSBhL2Jsb2NrL2Jsay1saWIu
Ywo+ICsrKyBiL2Jsb2NrL2Jsay1saWIuYwo+IEBAIC01Myw3ICs1Myw3IEBAIGludCBfX2Jsa2Rl
dl9pc3N1ZV9kaXNjYXJkKHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYsIHNlY3Rvcl90IHNlY3Rv
ciwKPiAgCQkJcmV0dXJuIC1FT1BOT1RTVVBQOwo+ICAJCW9wID0gUkVRX09QX1NFQ1VSRV9FUkFT
RTsKPiAgCX0gZWxzZSB7Cj4gLQkJaWYgKCFibGtfcXVldWVfZGlzY2FyZChxKSkKPiArCQlpZiAo
IWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhiZGV2KSkKPiAgCQkJcmV0dXJuIC1FT1BOT1RTVVBQ
Owo+ICAJCW9wID0gUkVRX09QX0RJU0NBUkQ7Cj4gIAl9Cj4gZGlmZiAtLWdpdCBhL2Jsb2NrL2lv
Y3RsLmMgYi9ibG9jay9pb2N0bC5jCj4gaW5kZXggYWQzNzcxYjI2OGI4MS4uYzJjZDNiYTUyOTBj
ZSAxMDA2NDQKPiAtLS0gYS9ibG9jay9pb2N0bC5jCj4gKysrIGIvYmxvY2svaW9jdGwuYwo+IEBA
IC04NywxNCArODcsMTMgQEAgc3RhdGljIGludCBibGtfaW9jdGxfZGlzY2FyZChzdHJ1Y3QgYmxv
Y2tfZGV2aWNlICpiZGV2LCBmbW9kZV90IG1vZGUsCj4gIHsKPiAgCXVpbnQ2NF90IHJhbmdlWzJd
Owo+ICAJdWludDY0X3Qgc3RhcnQsIGxlbjsKPiAtCXN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxID0g
YmRldl9nZXRfcXVldWUoYmRldik7Cj4gIAlzdHJ1Y3QgaW5vZGUgKmlub2RlID0gYmRldi0+YmRf
aW5vZGU7Cj4gIAlpbnQgZXJyOwo+ICAKPiAgCWlmICghKG1vZGUgJiBGTU9ERV9XUklURSkpCj4g
IAkJcmV0dXJuIC1FQkFERjsKPiAgCj4gLQlpZiAoIWJsa19xdWV1ZV9kaXNjYXJkKHEpKQo+ICsJ
aWYgKCFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoYmRldikpCj4gIAkJcmV0dXJuIC1FT1BOT1RT
VVBQOwo+ICAKPiAgCWlmIChjb3B5X2Zyb21fdXNlcihyYW5nZSwgKHZvaWQgX191c2VyICopYXJn
LCBzaXplb2YocmFuZ2UpKSkKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRf
bWFpbi5jIGIvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfbWFpbi5jCj4gaW5kZXggOWQ0M2FhZGRl
MTlhZC4uOGZkODlhMWIwYjdiMyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJi
ZF9tYWluLmMKPiArKysgYi9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9tYWluLmMKPiBAQCAtOTQy
LDcgKzk0Miw3IEBAIGludCBkcmJkX3NlbmRfc2l6ZXMoc3RydWN0IGRyYmRfcGVlcl9kZXZpY2Ug
KnBlZXJfZGV2aWNlLCBpbnQgdHJpZ2dlcl9yZXBseSwgZW51Cj4gIAkJCWNwdV90b19iZTMyKGJk
ZXZfYWxpZ25tZW50X29mZnNldChiZGV2KSk7Cj4gIAkJcC0+cWxpbS0+aW9fbWluID0gY3B1X3Rv
X2JlMzIoYmRldl9pb19taW4oYmRldikpOwo+ICAJCXAtPnFsaW0tPmlvX29wdCA9IGNwdV90b19i
ZTMyKGJkZXZfaW9fb3B0KGJkZXYpKTsKPiAtCQlwLT5xbGltLT5kaXNjYXJkX2VuYWJsZWQgPSBi
bGtfcXVldWVfZGlzY2FyZChxKTsKPiArCQlwLT5xbGltLT5kaXNjYXJkX2VuYWJsZWQgPSAhIWJk
ZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhiZGV2KTsKPiAgCQlwLT5xbGltLT53cml0ZV9zYW1lX2Nh
cGFibGUgPSAwOwo+ICAJCXB1dF9sZGV2KGRldmljZSk7Cj4gIAl9IGVsc2Ugewo+IGRpZmYgLS1n
aXQgYS9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9ubC5jIGIvZHJpdmVycy9ibG9jay9kcmJkL2Ry
YmRfbmwuYwo+IGluZGV4IDQwYmIwYjM1NmE2ZDYuLjhlMjhlMGE4ZTVlNDEgMTAwNjQ0Cj4gLS0t
IGEvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfbmwuYwo+ICsrKyBiL2RyaXZlcnMvYmxvY2svZHJi
ZC9kcmJkX25sLmMKPiBAQCAtMTIxMCw3ICsxMjEwLDcgQEAgc3RhdGljIHZvaWQgZGVjaWRlX29u
X2Rpc2NhcmRfc3VwcG9ydChzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwKPiAgCQlmaXJzdF9w
ZWVyX2RldmljZShkZXZpY2UpLT5jb25uZWN0aW9uOwo+ICAJc3RydWN0IHJlcXVlc3RfcXVldWUg
KnEgPSBkZXZpY2UtPnJxX3F1ZXVlOwo+ICAKPiAtCWlmIChiZGV2ICYmICFibGtfcXVldWVfZGlz
Y2FyZChiZGV2LT5iYWNraW5nX2JkZXYtPmJkX2Rpc2stPnF1ZXVlKSkKPiArCWlmIChiZGV2ICYm
ICFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoYmRldi0+YmFja2luZ19iZGV2KSkKPiAgCQlnb3Rv
IG5vdF9zdXBwb3J0ZWQ7Cj4gIAo+ICAJaWYgKGNvbm5lY3Rpb24tPmNzdGF0ZSA+PSBDX0NPTk5F
Q1RFRCAmJgo+IEBAIC0xNDM5LDE0ICsxNDM5LDE1IEBAIHN0YXRpYyBib29sIHdyaXRlX29yZGVy
aW5nX2NoYW5nZWQoc3RydWN0IGRpc2tfY29uZiAqYSwgc3RydWN0IGRpc2tfY29uZiAqYikKPiAg
c3RhdGljIHZvaWQgc2FuaXRpemVfZGlza19jb25mKHN0cnVjdCBkcmJkX2RldmljZSAqZGV2aWNl
LCBzdHJ1Y3QgZGlza19jb25mICpkaXNrX2NvbmYsCj4gIAkJCSAgICAgICBzdHJ1Y3QgZHJiZF9i
YWNraW5nX2RldiAqbmJjKQo+ICB7Cj4gLQlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqIGNvbnN0IHEg
PSBuYmMtPmJhY2tpbmdfYmRldi0+YmRfZGlzay0+cXVldWU7Cj4gKwlzdHJ1Y3QgYmxvY2tfZGV2
aWNlICpiZGV2ID0gbmJjLT5iYWNraW5nX2JkZXY7Cj4gKwlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAq
cSA9IGJkZXYtPmJkX2Rpc2stPnF1ZXVlOwo+ICAKPiAgCWlmIChkaXNrX2NvbmYtPmFsX2V4dGVu
dHMgPCBEUkJEX0FMX0VYVEVOVFNfTUlOKQo+ICAJCWRpc2tfY29uZi0+YWxfZXh0ZW50cyA9IERS
QkRfQUxfRVhURU5UU19NSU47Cj4gIAlpZiAoZGlza19jb25mLT5hbF9leHRlbnRzID4gZHJiZF9h
bF9leHRlbnRzX21heChuYmMpKQo+ICAJCWRpc2tfY29uZi0+YWxfZXh0ZW50cyA9IGRyYmRfYWxf
ZXh0ZW50c19tYXgobmJjKTsKPiAgCj4gLQlpZiAoIWJsa19xdWV1ZV9kaXNjYXJkKHEpKSB7Cj4g
KwlpZiAoIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhiZGV2KSkgewo+ICAJCWlmIChkaXNrX2Nv
bmYtPnJzX2Rpc2NhcmRfZ3JhbnVsYXJpdHkpIHsKPiAgCQkJZGlza19jb25mLT5yc19kaXNjYXJk
X2dyYW51bGFyaXR5ID0gMDsgLyogZGlzYWJsZSBmZWF0dXJlICovCj4gIAkJCWRyYmRfaW5mbyhk
ZXZpY2UsICJyc19kaXNjYXJkX2dyYW51bGFyaXR5IGZlYXR1cmUgZGlzYWJsZWRcbiIpOwo+IEBA
IC0xNDU1LDYgKzE0NTYsNyBAQCBzdGF0aWMgdm9pZCBzYW5pdGl6ZV9kaXNrX2NvbmYoc3RydWN0
IGRyYmRfZGV2aWNlICpkZXZpY2UsIHN0cnVjdCBkaXNrX2NvbmYgKmRpcwo+ICAKPiAgCWlmIChk
aXNrX2NvbmYtPnJzX2Rpc2NhcmRfZ3JhbnVsYXJpdHkpIHsKPiAgCQlpbnQgb3JpZ192YWx1ZSA9
IGRpc2tfY29uZi0+cnNfZGlzY2FyZF9ncmFudWxhcml0eTsKPiArCQlzZWN0b3JfdCBkaXNjYXJk
X3NpemUgPSBiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoYmRldikgPDwgOTsKPiAgCQlpbnQgcmVt
YWluZGVyOwo+ICAKPiAgCQlpZiAocS0+bGltaXRzLmRpc2NhcmRfZ3JhbnVsYXJpdHkgPiBkaXNr
X2NvbmYtPnJzX2Rpc2NhcmRfZ3JhbnVsYXJpdHkpCj4gQEAgLTE0NjMsOCArMTQ2NSw4IEBAIHN0
YXRpYyB2b2lkIHNhbml0aXplX2Rpc2tfY29uZihzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwg
c3RydWN0IGRpc2tfY29uZiAqZGlzCj4gIAkJcmVtYWluZGVyID0gZGlza19jb25mLT5yc19kaXNj
YXJkX2dyYW51bGFyaXR5ICUgcS0+bGltaXRzLmRpc2NhcmRfZ3JhbnVsYXJpdHk7Cj4gIAkJZGlz
a19jb25mLT5yc19kaXNjYXJkX2dyYW51bGFyaXR5ICs9IHJlbWFpbmRlcjsKPiAgCj4gLQkJaWYg
KGRpc2tfY29uZi0+cnNfZGlzY2FyZF9ncmFudWxhcml0eSA+IHEtPmxpbWl0cy5tYXhfZGlzY2Fy
ZF9zZWN0b3JzIDw8IDkpCj4gLQkJCWRpc2tfY29uZi0+cnNfZGlzY2FyZF9ncmFudWxhcml0eSA9
IHEtPmxpbWl0cy5tYXhfZGlzY2FyZF9zZWN0b3JzIDw8IDk7Cj4gKwkJaWYgKGRpc2tfY29uZi0+
cnNfZGlzY2FyZF9ncmFudWxhcml0eSA+IGRpc2NhcmRfc2l6ZSkKPiArCQkJZGlza19jb25mLT5y
c19kaXNjYXJkX2dyYW51bGFyaXR5ID0gZGlzY2FyZF9zaXplOwo+ICAKPiAgCQlpZiAoZGlza19j
b25mLT5yc19kaXNjYXJkX2dyYW51bGFyaXR5ICE9IG9yaWdfdmFsdWUpCj4gIAkJCWRyYmRfaW5m
byhkZXZpY2UsICJyc19kaXNjYXJkX2dyYW51bGFyaXR5IGNoYW5nZWQgdG8gJWRcbiIsCj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX3JlY2VpdmVyLmMgYi9kcml2ZXJzL2Js
b2NrL2RyYmQvZHJiZF9yZWNlaXZlci5jCj4gaW5kZXggMDhkYTkyMmY4MWQxZC4uOGE0YTQ3ZGE1
NmZlOSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9yZWNlaXZlci5jCj4g
KysrIGIvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfcmVjZWl2ZXIuYwo+IEBAIC0xNTI0LDcgKzE1
MjQsNyBAQCBpbnQgZHJiZF9pc3N1ZV9kaXNjYXJkX29yX3plcm9fb3V0KHN0cnVjdCBkcmJkX2Rl
dmljZSAqZGV2aWNlLCBzZWN0b3JfdCBzdGFydCwgdQo+ICAJZ3JhbnVsYXJpdHkgPSBtYXgocS0+
bGltaXRzLmRpc2NhcmRfZ3JhbnVsYXJpdHkgPj4gOSwgMVUpOwo+ICAJYWxpZ25tZW50ID0gKGJk
ZXZfZGlzY2FyZF9hbGlnbm1lbnQoYmRldikgPj4gOSkgJSBncmFudWxhcml0eTsKPiAgCj4gLQlt
YXhfZGlzY2FyZF9zZWN0b3JzID0gbWluKHEtPmxpbWl0cy5tYXhfZGlzY2FyZF9zZWN0b3JzLCAo
MVUgPDwgMjIpKTsKPiArCW1heF9kaXNjYXJkX3NlY3RvcnMgPSBtaW4oYmRldl9tYXhfZGlzY2Fy
ZF9zZWN0b3JzKGJkZXYpLCAoMVUgPDwgMjIpKTsKPiAgCW1heF9kaXNjYXJkX3NlY3RvcnMgLT0g
bWF4X2Rpc2NhcmRfc2VjdG9ycyAlIGdyYW51bGFyaXR5Owo+ICAJaWYgKHVubGlrZWx5KCFtYXhf
ZGlzY2FyZF9zZWN0b3JzKSkKPiAgCQlnb3RvIHplcm9fb3V0Owo+IEBAIC0xNTc1LDExICsxNTc1
LDEwIEBAIGludCBkcmJkX2lzc3VlX2Rpc2NhcmRfb3JfemVyb19vdXQoc3RydWN0IGRyYmRfZGV2
aWNlICpkZXZpY2UsIHNlY3Rvcl90IHN0YXJ0LCB1Cj4gIAo+ICBzdGF0aWMgYm9vbCBjYW5fZG9f
cmVsaWFibGVfZGlzY2FyZHMoc3RydWN0IGRyYmRfZGV2aWNlICpkZXZpY2UpCj4gIHsKPiAtCXN0
cnVjdCByZXF1ZXN0X3F1ZXVlICpxID0gYmRldl9nZXRfcXVldWUoZGV2aWNlLT5sZGV2LT5iYWNr
aW5nX2JkZXYpOwo+ICAJc3RydWN0IGRpc2tfY29uZiAqZGM7Cj4gIAlib29sIGNhbl9kbzsKPiAg
Cj4gLQlpZiAoIWJsa19xdWV1ZV9kaXNjYXJkKHEpKQo+ICsJaWYgKCFiZGV2X21heF9kaXNjYXJk
X3NlY3RvcnMoZGV2aWNlLT5sZGV2LT5iYWNraW5nX2JkZXYpKQo+ICAJCXJldHVybiBmYWxzZTsK
PiAgCj4gIAlyY3VfcmVhZF9sb2NrKCk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvYmxvY2svbG9v
cC5jIGIvZHJpdmVycy9ibG9jay9sb29wLmMKPiBpbmRleCA4ZDgwMGQ0NmU0OTg1Li40YjkxOWI3
NTIwNWE3IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvYmxvY2svbG9vcC5jCj4gKysrIGIvZHJpdmVy
cy9ibG9jay9sb29wLmMKPiBAQCAtMzE0LDE1ICszMTQsMTIgQEAgc3RhdGljIGludCBsb19mYWxs
b2NhdGUoc3RydWN0IGxvb3BfZGV2aWNlICpsbywgc3RydWN0IHJlcXVlc3QgKnJxLCBsb2ZmX3Qg
cG9zLAo+ICAKPiAgCW1vZGUgfD0gRkFMTE9DX0ZMX0tFRVBfU0laRTsKPiAgCj4gLQlpZiAoIWJs
a19xdWV1ZV9kaXNjYXJkKGxvLT5sb19xdWV1ZSkpIHsKPiAtCQlyZXQgPSAtRU9QTk9UU1VQUDsK
PiAtCQlnb3RvIG91dDsKPiAtCX0KPiArCWlmICghYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKGxv
LT5sb19kZXZpY2UpKQo+ICsJCXJldHVybiAtRU9QTk9UU1VQUDsKPiAgCj4gIAlyZXQgPSBmaWxl
LT5mX29wLT5mYWxsb2NhdGUoZmlsZSwgbW9kZSwgcG9zLCBibGtfcnFfYnl0ZXMocnEpKTsKPiAg
CWlmICh1bmxpa2VseShyZXQgJiYgcmV0ICE9IC1FSU5WQUwgJiYgcmV0ICE9IC1FT1BOT1RTVVBQ
KSkKPiAtCQlyZXQgPSAtRUlPOwo+IC0gb3V0Ogo+ICsJCXJldHVybiAtRUlPOwo+ICAJcmV0dXJu
IHJldDsKPiAgfQo+ICAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9ibG9jay9ybmJkL3JuYmQtc3J2
LWRldi5oIGIvZHJpdmVycy9ibG9jay9ybmJkL3JuYmQtc3J2LWRldi5oCj4gaW5kZXggMmMzZGYw
MmI1ZThlYy4uMWY3ZTFjOGZkNGQ5YiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2Jsb2NrL3JuYmQv
cm5iZC1zcnYtZGV2LmgKPiArKysgYi9kcml2ZXJzL2Jsb2NrL3JuYmQvcm5iZC1zcnYtZGV2LmgK
PiBAQCAtNDksMTEgKzQ5LDcgQEAgc3RhdGljIGlubGluZSBpbnQgcm5iZF9kZXZfZ2V0X3NlY3Vy
ZV9kaXNjYXJkKGNvbnN0IHN0cnVjdCBybmJkX2RldiAqZGV2KQo+ICAKPiAgc3RhdGljIGlubGlu
ZSBpbnQgcm5iZF9kZXZfZ2V0X21heF9kaXNjYXJkX3NlY3RzKGNvbnN0IHN0cnVjdCBybmJkX2Rl
diAqZGV2KQo+ICB7Cj4gLQlpZiAoIWJsa19xdWV1ZV9kaXNjYXJkKGJkZXZfZ2V0X3F1ZXVlKGRl
di0+YmRldikpKQo+IC0JCXJldHVybiAwOwo+IC0KPiAtCXJldHVybiBibGtfcXVldWVfZ2V0X21h
eF9zZWN0b3JzKGJkZXZfZ2V0X3F1ZXVlKGRldi0+YmRldiksCj4gLQkJCQkJIFJFUV9PUF9ESVND
QVJEKTsKPiArCXJldHVybiBiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoZGV2LT5iZGV2KTsKPiAg
fQo+ICAKPiAgc3RhdGljIGlubGluZSBpbnQgcm5iZF9kZXZfZ2V0X2Rpc2NhcmRfZ3JhbnVsYXJp
dHkoY29uc3Qgc3RydWN0IHJuYmRfZGV2ICpkZXYpCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvYmxv
Y2sveGVuLWJsa2JhY2sveGVuYnVzLmMgYi9kcml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL3hlbmJ1
cy5jCj4gaW5kZXggOGI2OTFmZTUwNDc1Zi4uODNjZDA4MDQxZTZiMyAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2Jsb2NrL3hlbi1ibGtiYWNrL3hlbmJ1cy5jCj4gKysrIGIvZHJpdmVycy9ibG9jay94
ZW4tYmxrYmFjay94ZW5idXMuYwo+IEBAIC01ODMsNyArNTgzLDcgQEAgc3RhdGljIHZvaWQgeGVu
X2Jsa2JrX2Rpc2NhcmQoc3RydWN0IHhlbmJ1c190cmFuc2FjdGlvbiB4YnQsIHN0cnVjdCBiYWNr
ZW5kX2luZm8KPiAgCWlmICgheGVuYnVzX3JlYWRfdW5zaWduZWQoZGV2LT5ub2RlbmFtZSwgImRp
c2NhcmQtZW5hYmxlIiwgMSkpCj4gIAkJcmV0dXJuOwo+ICAKPiAtCWlmIChibGtfcXVldWVfZGlz
Y2FyZChxKSkgewo+ICsJaWYgKGJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhiZGV2KSkgewo+ICAJ
CWVyciA9IHhlbmJ1c19wcmludGYoeGJ0LCBkZXYtPm5vZGVuYW1lLAo+ICAJCQkiZGlzY2FyZC1n
cmFudWxhcml0eSIsICIldSIsCj4gIAkJCXEtPmxpbWl0cy5kaXNjYXJkX2dyYW51bGFyaXR5KTsK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZC9iY2FjaGUvcmVxdWVzdC5jIGIvZHJpdmVycy9tZC9i
Y2FjaGUvcmVxdWVzdC5jCj4gaW5kZXggZmRkMDE5NGY4NGRkMC4uZTI3ZjY3ZjA2YTQyOCAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL21kL2JjYWNoZS9yZXF1ZXN0LmMKPiArKysgYi9kcml2ZXJzL21k
L2JjYWNoZS9yZXF1ZXN0LmMKPiBAQCAtMTAwNSw3ICsxMDA1LDcgQEAgc3RhdGljIHZvaWQgY2Fj
aGVkX2Rldl93cml0ZShzdHJ1Y3QgY2FjaGVkX2RldiAqZGMsIHN0cnVjdCBzZWFyY2ggKnMpCj4g
IAkJYmlvX2dldChzLT5pb3AuYmlvKTsKPiAgCj4gIAkJaWYgKGJpb19vcChiaW8pID09IFJFUV9P
UF9ESVNDQVJEICYmCj4gLQkJICAgICFibGtfcXVldWVfZGlzY2FyZChiZGV2X2dldF9xdWV1ZShk
Yy0+YmRldikpKQo+ICsJCSAgICAhYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKGRjLT5iZGV2KSkK
PiAgCQkJZ290byBpbnNlcnRfZGF0YTsKPiAgCj4gIAkJLyogSS9PIHJlcXVlc3Qgc2VudCB0byBi
YWNraW5nIGRldmljZSAqLwo+IEBAIC0xMTE1LDcgKzExMTUsNyBAQCBzdGF0aWMgdm9pZCBkZXRh
Y2hlZF9kZXZfZG9fcmVxdWVzdChzdHJ1Y3QgYmNhY2hlX2RldmljZSAqZCwgc3RydWN0IGJpbyAq
YmlvLAo+ICAJYmlvLT5iaV9wcml2YXRlID0gZGRpcDsKPiAgCj4gIAlpZiAoKGJpb19vcChiaW8p
ID09IFJFUV9PUF9ESVNDQVJEKSAmJgo+IC0JICAgICFibGtfcXVldWVfZGlzY2FyZChiZGV2X2dl
dF9xdWV1ZShkYy0+YmRldikpKQo+ICsJICAgICFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoZGMt
PmJkZXYpKQo+ICAJCWJpby0+YmlfZW5kX2lvKGJpbyk7Cj4gIAllbHNlCj4gIAkJc3VibWl0X2Jp
b19ub2FjY3QoYmlvKTsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZC9iY2FjaGUvc3VwZXIuYyBi
L2RyaXZlcnMvbWQvYmNhY2hlL3N1cGVyLmMKPiBpbmRleCBiZjNkZTE0OWQzYzlmLi4yOTZmMjAw
YjJlMjA4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvbWQvYmNhY2hlL3N1cGVyLmMKPiArKysgYi9k
cml2ZXJzL21kL2JjYWNoZS9zdXBlci5jCj4gQEAgLTIzNTAsNyArMjM1MCw3IEBAIHN0YXRpYyBp
bnQgcmVnaXN0ZXJfY2FjaGUoc3RydWN0IGNhY2hlX3NiICpzYiwgc3RydWN0IGNhY2hlX3NiX2Rp
c2sgKnNiX2Rpc2ssCj4gIAljYS0+YmRldi0+YmRfaG9sZGVyID0gY2E7Cj4gIAljYS0+c2JfZGlz
ayA9IHNiX2Rpc2s7Cj4gIAo+IC0JaWYgKGJsa19xdWV1ZV9kaXNjYXJkKGJkZXZfZ2V0X3F1ZXVl
KGJkZXYpKSkKPiArCWlmIChiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoKGJkZXYpKSkKPiAgCQlj
YS0+ZGlzY2FyZCA9IENBQ0hFX0RJU0NBUkQoJmNhLT5zYik7Cj4gIAo+ICAJcmV0ID0gY2FjaGVf
YWxsb2MoY2EpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL21kL2JjYWNoZS9zeXNmcy5jIGIvZHJp
dmVycy9tZC9iY2FjaGUvc3lzZnMuYwo+IGluZGV4IGQxMDI5ZDcxZmYzYmMuLmM2ZjY3NzA1OTIx
NGQgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9tZC9iY2FjaGUvc3lzZnMuYwo+ICsrKyBiL2RyaXZl
cnMvbWQvYmNhY2hlL3N5c2ZzLmMKPiBAQCAtMTE1MSw3ICsxMTUxLDcgQEAgU1RPUkUoX19iY2hf
Y2FjaGUpCj4gIAlpZiAoYXR0ciA9PSAmc3lzZnNfZGlzY2FyZCkgewo+ICAJCWJvb2wgdiA9IHN0
cnRvdWxfb3JfcmV0dXJuKGJ1Zik7Cj4gIAo+IC0JCWlmIChibGtfcXVldWVfZGlzY2FyZChiZGV2
X2dldF9xdWV1ZShjYS0+YmRldikpKQo+ICsJCWlmIChiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMo
Y2EtPmJkZXYpKQo+ICAJCQljYS0+ZGlzY2FyZCA9IHY7Cj4gIAo+ICAJCWlmICh2ICE9IENBQ0hF
X0RJU0NBUkQoJmNhLT5zYikpIHsKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZC9kbS1jYWNoZS10
YXJnZXQuYyBiL2RyaXZlcnMvbWQvZG0tY2FjaGUtdGFyZ2V0LmMKPiBpbmRleCA3ODBhNjFiYzZj
YzAzLi4yOGM1ZGU4ZWNhNGEwIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvbWQvZG0tY2FjaGUtdGFy
Z2V0LmMKPiArKysgYi9kcml2ZXJzL21kL2RtLWNhY2hlLXRhcmdldC5jCj4gQEAgLTMzMjksMTMg
KzMzMjksNiBAQCBzdGF0aWMgaW50IGNhY2hlX2l0ZXJhdGVfZGV2aWNlcyhzdHJ1Y3QgZG1fdGFy
Z2V0ICp0aSwKPiAgCXJldHVybiByOwo+ICB9Cj4gIAo+IC1zdGF0aWMgYm9vbCBvcmlnaW5fZGV2
X3N1cHBvcnRzX2Rpc2NhcmQoc3RydWN0IGJsb2NrX2RldmljZSAqb3JpZ2luX2JkZXYpCj4gLXsK
PiAtCXN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxID0gYmRldl9nZXRfcXVldWUob3JpZ2luX2JkZXYp
Owo+IC0KPiAtCXJldHVybiBibGtfcXVldWVfZGlzY2FyZChxKTsKPiAtfQo+IC0KPiAgLyoKPiAg
ICogSWYgZGlzY2FyZF9wYXNzZG93biB3YXMgZW5hYmxlZCB2ZXJpZnkgdGhhdCB0aGUgb3JpZ2lu
IGRldmljZQo+ICAgKiBzdXBwb3J0cyBkaXNjYXJkcy4gIERpc2FibGUgZGlzY2FyZF9wYXNzZG93
biBpZiBub3QuCj4gQEAgLTMzNDksNyArMzM0Miw3IEBAIHN0YXRpYyB2b2lkIGRpc2FibGVfcGFz
c2Rvd25faWZfbm90X3N1cHBvcnRlZChzdHJ1Y3QgY2FjaGUgKmNhY2hlKQo+ICAJaWYgKCFjYWNo
ZS0+ZmVhdHVyZXMuZGlzY2FyZF9wYXNzZG93bikKPiAgCQlyZXR1cm47Cj4gIAo+IC0JaWYgKCFv
cmlnaW5fZGV2X3N1cHBvcnRzX2Rpc2NhcmQob3JpZ2luX2JkZXYpKQo+ICsJaWYgKCFiZGV2X21h
eF9kaXNjYXJkX3NlY3RvcnMob3JpZ2luX2JkZXYpKQo+ICAJCXJlYXNvbiA9ICJkaXNjYXJkIHVu
c3VwcG9ydGVkIjsKPiAgCj4gIAllbHNlIGlmIChvcmlnaW5fbGltaXRzLT5tYXhfZGlzY2FyZF9z
ZWN0b3JzIDwgY2FjaGUtPnNlY3RvcnNfcGVyX2Jsb2NrKQo+IGRpZmYgLS1naXQgYS9kcml2ZXJz
L21kL2RtLWNsb25lLXRhcmdldC5jIGIvZHJpdmVycy9tZC9kbS1jbG9uZS10YXJnZXQuYwo+IGlu
ZGV4IDEyODMxNmE3M2QwMTYuLjgxMWIwYTUzNzlkMDMgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9t
ZC9kbS1jbG9uZS10YXJnZXQuYwo+ICsrKyBiL2RyaXZlcnMvbWQvZG0tY2xvbmUtdGFyZ2V0LmMK
PiBAQCAtMjAxNiwxMyArMjAxNiw2IEBAIHN0YXRpYyB2b2lkIGNsb25lX3Jlc3VtZShzdHJ1Y3Qg
ZG1fdGFyZ2V0ICp0aSkKPiAgCWRvX3dha2VyKCZjbG9uZS0+d2FrZXIud29yayk7Cj4gIH0KPiAg
Cj4gLXN0YXRpYyBib29sIGJkZXZfc3VwcG9ydHNfZGlzY2FyZHMoc3RydWN0IGJsb2NrX2Rldmlj
ZSAqYmRldikKPiAtewo+IC0Jc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2X2dldF9xdWV1
ZShiZGV2KTsKPiAtCj4gLQlyZXR1cm4gKHEgJiYgYmxrX3F1ZXVlX2Rpc2NhcmQocSkpOwo+IC19
Cj4gLQo+ICAvKgo+ICAgKiBJZiBkaXNjYXJkX3Bhc3Nkb3duIHdhcyBlbmFibGVkIHZlcmlmeSB0
aGF0IHRoZSBkZXN0aW5hdGlvbiBkZXZpY2Ugc3VwcG9ydHMKPiAgICogZGlzY2FyZHMuIERpc2Fi
bGUgZGlzY2FyZF9wYXNzZG93biBpZiBub3QuCj4gQEAgLTIwMzYsNyArMjAyOSw3IEBAIHN0YXRp
YyB2b2lkIGRpc2FibGVfcGFzc2Rvd25faWZfbm90X3N1cHBvcnRlZChzdHJ1Y3QgY2xvbmUgKmNs
b25lKQo+ICAJaWYgKCF0ZXN0X2JpdChETV9DTE9ORV9ESVNDQVJEX1BBU1NET1dOLCAmY2xvbmUt
PmZsYWdzKSkKPiAgCQlyZXR1cm47Cj4gIAo+IC0JaWYgKCFiZGV2X3N1cHBvcnRzX2Rpc2NhcmRz
KGRlc3RfZGV2KSkKPiArCWlmICghYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKGRlc3RfZGV2KSkK
PiAgCQlyZWFzb24gPSAiZGlzY2FyZCB1bnN1cHBvcnRlZCI7Cj4gIAllbHNlIGlmIChkZXN0X2xp
bWl0cy0+bWF4X2Rpc2NhcmRfc2VjdG9ycyA8IGNsb25lLT5yZWdpb25fc2l6ZSkKPiAgCQlyZWFz
b24gPSAibWF4IGRpc2NhcmQgc2VjdG9ycyBzbWFsbGVyIHRoYW4gYSByZWdpb24iOwo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL21kL2RtLWlvLmMgYi9kcml2ZXJzL21kL2RtLWlvLmMKPiBpbmRleCA1
NzYyMzY2MzMzYTI3Li5lNGI5NWVhZWVjOGM3IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvbWQvZG0t
aW8uYwo+ICsrKyBiL2RyaXZlcnMvbWQvZG0taW8uYwo+IEBAIC0zMTEsNyArMzExLDcgQEAgc3Rh
dGljIHZvaWQgZG9fcmVnaW9uKGludCBvcCwgaW50IG9wX2ZsYWdzLCB1bnNpZ25lZCByZWdpb24s
Cj4gIAkgKiBSZWplY3QgdW5zdXBwb3J0ZWQgZGlzY2FyZCBhbmQgd3JpdGUgc2FtZSByZXF1ZXN0
cy4KPiAgCSAqLwo+ICAJaWYgKG9wID09IFJFUV9PUF9ESVNDQVJEKQo+IC0JCXNwZWNpYWxfY21k
X21heF9zZWN0b3JzID0gcS0+bGltaXRzLm1heF9kaXNjYXJkX3NlY3RvcnM7Cj4gKwkJc3BlY2lh
bF9jbWRfbWF4X3NlY3RvcnMgPSBiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMod2hlcmUtPmJkZXYp
Owo+ICAJZWxzZSBpZiAob3AgPT0gUkVRX09QX1dSSVRFX1pFUk9FUykKPiAgCQlzcGVjaWFsX2Nt
ZF9tYXhfc2VjdG9ycyA9IHEtPmxpbWl0cy5tYXhfd3JpdGVfemVyb2VzX3NlY3RvcnM7Cj4gIAlp
ZiAoKG9wID09IFJFUV9PUF9ESVNDQVJEIHx8IG9wID09IFJFUV9PUF9XUklURV9aRVJPRVMpICYm
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWQvZG0tbG9nLXdyaXRlcy5jIGIvZHJpdmVycy9tZC9k
bS1sb2ctd3JpdGVzLmMKPiBpbmRleCBjOWQwMzZkNmJiMmVlLi5lMTk0MjI2Yzg5ZTU0IDEwMDY0
NAo+IC0tLSBhL2RyaXZlcnMvbWQvZG0tbG9nLXdyaXRlcy5jCj4gKysrIGIvZHJpdmVycy9tZC9k
bS1sb2ctd3JpdGVzLmMKPiBAQCAtODY2LDkgKzg2Niw4IEBAIHN0YXRpYyBpbnQgbG9nX3dyaXRl
c19tZXNzYWdlKHN0cnVjdCBkbV90YXJnZXQgKnRpLCB1bnNpZ25lZCBhcmdjLCBjaGFyICoqYXJn
diwKPiAgc3RhdGljIHZvaWQgbG9nX3dyaXRlc19pb19oaW50cyhzdHJ1Y3QgZG1fdGFyZ2V0ICp0
aSwgc3RydWN0IHF1ZXVlX2xpbWl0cyAqbGltaXRzKQo+ICB7Cj4gIAlzdHJ1Y3QgbG9nX3dyaXRl
c19jICpsYyA9IHRpLT5wcml2YXRlOwo+IC0Jc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2
X2dldF9xdWV1ZShsYy0+ZGV2LT5iZGV2KTsKPiAgCj4gLQlpZiAoIXEgfHwgIWJsa19xdWV1ZV9k
aXNjYXJkKHEpKSB7Cj4gKwlpZiAoIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhsYy0+ZGV2LT5i
ZGV2KSkgewo+ICAJCWxjLT5kZXZpY2Vfc3VwcG9ydHNfZGlzY2FyZCA9IGZhbHNlOwo+ICAJCWxp
bWl0cy0+ZGlzY2FyZF9ncmFudWxhcml0eSA9IGxjLT5zZWN0b3JzaXplOwo+ICAJCWxpbWl0cy0+
bWF4X2Rpc2NhcmRfc2VjdG9ycyA9IChVSU5UX01BWCA+PiBTRUNUT1JfU0hJRlQpOwo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL21kL2RtLXJhaWQuYyBiL2RyaXZlcnMvbWQvZG0tcmFpZC5jCj4gaW5k
ZXggMmIyNjQzNWE2OTQ2ZS4uOTUyNmNjYmVkYWZiYSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL21k
L2RtLXJhaWQuYwo+ICsrKyBiL2RyaXZlcnMvbWQvZG0tcmFpZC5jCj4gQEAgLTI5NjMsMTMgKzI5
NjMsOCBAQCBzdGF0aWMgdm9pZCBjb25maWd1cmVfZGlzY2FyZF9zdXBwb3J0KHN0cnVjdCByYWlk
X3NldCAqcnMpCj4gIAlyYWlkNDU2ID0gcnNfaXNfcmFpZDQ1Nihycyk7Cj4gIAo+ICAJZm9yIChp
ID0gMDsgaSA8IHJzLT5yYWlkX2Rpc2tzOyBpKyspIHsKPiAtCQlzdHJ1Y3QgcmVxdWVzdF9xdWV1
ZSAqcTsKPiAtCj4gLQkJaWYgKCFycy0+ZGV2W2ldLnJkZXYuYmRldikKPiAtCQkJY29udGludWU7
Cj4gLQo+IC0JCXEgPSBiZGV2X2dldF9xdWV1ZShycy0+ZGV2W2ldLnJkZXYuYmRldik7Cj4gLQkJ
aWYgKCFxIHx8ICFibGtfcXVldWVfZGlzY2FyZChxKSkKPiArCQlpZiAoIXJzLT5kZXZbaV0ucmRl
di5iZGV2IHx8Cj4gKwkJICAgICFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMocnMtPmRldltpXS5y
ZGV2LmJkZXYpKQo+ICAJCQlyZXR1cm47Cj4gIAo+ICAJCWlmIChyYWlkNDU2KSB7Cj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWQvZG0tdGFibGUuYyBiL2RyaXZlcnMvbWQvZG0tdGFibGUuYwo+IGlu
ZGV4IGQ0NjgzOWZhYTBjYTUuLjQyOTdjMzgzMjhhOWIgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9t
ZC9kbS10YWJsZS5jCj4gKysrIGIvZHJpdmVycy9tZC9kbS10YWJsZS5jCj4gQEAgLTE4ODgsOSAr
MTg4OCw3IEBAIHN0YXRpYyBib29sIGRtX3RhYmxlX3N1cHBvcnRzX25vd2FpdChzdHJ1Y3QgZG1f
dGFibGUgKnQpCj4gIHN0YXRpYyBpbnQgZGV2aWNlX25vdF9kaXNjYXJkX2NhcGFibGUoc3RydWN0
IGRtX3RhcmdldCAqdGksIHN0cnVjdCBkbV9kZXYgKmRldiwKPiAgCQkJCSAgICAgIHNlY3Rvcl90
IHN0YXJ0LCBzZWN0b3JfdCBsZW4sIHZvaWQgKmRhdGEpCj4gIHsKPiAtCXN0cnVjdCByZXF1ZXN0
X3F1ZXVlICpxID0gYmRldl9nZXRfcXVldWUoZGV2LT5iZGV2KTsKPiAtCj4gLQlyZXR1cm4gIWJs
a19xdWV1ZV9kaXNjYXJkKHEpOwo+ICsJcmV0dXJuICFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMo
ZGV2LT5iZGV2KTsKPiAgfQo+ICAKPiAgc3RhdGljIGJvb2wgZG1fdGFibGVfc3VwcG9ydHNfZGlz
Y2FyZHMoc3RydWN0IGRtX3RhYmxlICp0KQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL21kL2RtLXRo
aW4uYyBiL2RyaXZlcnMvbWQvZG0tdGhpbi5jCj4gaW5kZXggNGQyNWQwZTI3MDMxMy4uY2QzMzNh
M2U0YzMzYiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL21kL2RtLXRoaW4uYwo+ICsrKyBiL2RyaXZl
cnMvbWQvZG0tdGhpbi5jCj4gQEAgLTI4MDIsMTMgKzI4MDIsNiBAQCBzdGF0aWMgdm9pZCByZXF1
ZXVlX2Jpb3Moc3RydWN0IHBvb2wgKnBvb2wpCj4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQo+ICAgKiBCaW5kaW5nIG9m
IGNvbnRyb2wgdGFyZ2V0cyB0byBhIHBvb2wgb2JqZWN0Cj4gICAqLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qLwo+IC1zdGF0aWMg
Ym9vbCBkYXRhX2Rldl9zdXBwb3J0c19kaXNjYXJkKHN0cnVjdCBwb29sX2MgKnB0KQo+IC17Cj4g
LQlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSA9IGJkZXZfZ2V0X3F1ZXVlKHB0LT5kYXRhX2Rldi0+
YmRldik7Cj4gLQo+IC0JcmV0dXJuIGJsa19xdWV1ZV9kaXNjYXJkKHEpOwo+IC19Cj4gLQo+ICBz
dGF0aWMgYm9vbCBpc19mYWN0b3Ioc2VjdG9yX3QgYmxvY2tfc2l6ZSwgdWludDMyX3QgbikKPiAg
ewo+ICAJcmV0dXJuICFzZWN0b3JfZGl2KGJsb2NrX3NpemUsIG4pOwo+IEBAIC0yODI4LDcgKzI4
MjEsNyBAQCBzdGF0aWMgdm9pZCBkaXNhYmxlX3Bhc3Nkb3duX2lmX25vdF9zdXBwb3J0ZWQoc3Ry
dWN0IHBvb2xfYyAqcHQpCj4gIAlpZiAoIXB0LT5hZGp1c3RlZF9wZi5kaXNjYXJkX3Bhc3Nkb3du
KQo+ICAJCXJldHVybjsKPiAgCj4gLQlpZiAoIWRhdGFfZGV2X3N1cHBvcnRzX2Rpc2NhcmQocHQp
KQo+ICsJaWYgKCFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMocHQtPmRhdGFfZGV2LT5iZGV2KSkK
PiAgCQlyZWFzb24gPSAiZGlzY2FyZCB1bnN1cHBvcnRlZCI7Cj4gIAo+ICAJZWxzZSBpZiAoZGF0
YV9saW1pdHMtPm1heF9kaXNjYXJkX3NlY3RvcnMgPCBwb29sLT5zZWN0b3JzX3Blcl9ibG9jaykK
PiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZC9kbS5jIGIvZHJpdmVycy9tZC9kbS5jCj4gaW5kZXgg
M2M1ZmFkN2M0ZWU2OC4uYmE3NTkzM2NjMjJjYSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL21kL2Rt
LmMKPiArKysgYi9kcml2ZXJzL21kL2RtLmMKPiBAQCAtOTgyLDcgKzk4Miw3IEBAIHN0YXRpYyB2
b2lkIGNsb25lX2VuZGlvKHN0cnVjdCBiaW8gKmJpbykKPiAgCj4gIAlpZiAodW5saWtlbHkoZXJy
b3IgPT0gQkxLX1NUU19UQVJHRVQpKSB7Cj4gIAkJaWYgKGJpb19vcChiaW8pID09IFJFUV9PUF9E
SVNDQVJEICYmCj4gLQkJICAgICFxLT5saW1pdHMubWF4X2Rpc2NhcmRfc2VjdG9ycykKPiArCQkg
ICAgIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhiaW8tPmJpX2JkZXYpKQo+ICAJCQlkaXNhYmxl
X2Rpc2NhcmQobWQpOwo+ICAJCWVsc2UgaWYgKGJpb19vcChiaW8pID09IFJFUV9PUF9XUklURV9a
RVJPRVMgJiYKPiAgCQkJICFxLT5saW1pdHMubWF4X3dyaXRlX3plcm9lc19zZWN0b3JzKQo+IGRp
ZmYgLS1naXQgYS9kcml2ZXJzL21kL21kLWxpbmVhci5jIGIvZHJpdmVycy9tZC9tZC1saW5lYXIu
Ywo+IGluZGV4IDBmNTViMDc5MzcxYjEuLjRkZDVhZmZmNzI4NDQgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9tZC9tZC1saW5lYXIuYwo+ICsrKyBiL2RyaXZlcnMvbWQvbWQtbGluZWFyLmMKPiBAQCAt
OTcsNyArOTcsNyBAQCBzdGF0aWMgc3RydWN0IGxpbmVhcl9jb25mICpsaW5lYXJfY29uZihzdHJ1
Y3QgbWRkZXYgKm1kZGV2LCBpbnQgcmFpZF9kaXNrcykKPiAgCQljb25mLT5hcnJheV9zZWN0b3Jz
ICs9IHJkZXYtPnNlY3RvcnM7Cj4gIAkJY250Kys7Cj4gIAo+IC0JCWlmIChibGtfcXVldWVfZGlz
Y2FyZChiZGV2X2dldF9xdWV1ZShyZGV2LT5iZGV2KSkpCj4gKwkJaWYgKGJkZXZfbWF4X2Rpc2Nh
cmRfc2VjdG9ycyhyZGV2LT5iZGV2KSkKPiAgCQkJZGlzY2FyZF9zdXBwb3J0ZWQgPSB0cnVlOwo+
ICAJfQo+ICAJaWYgKGNudCAhPSByYWlkX2Rpc2tzKSB7Cj4gQEAgLTI1Miw3ICsyNTIsNyBAQCBz
dGF0aWMgYm9vbCBsaW5lYXJfbWFrZV9yZXF1ZXN0KHN0cnVjdCBtZGRldiAqbWRkZXYsIHN0cnVj
dCBiaW8gKmJpbykKPiAgCQlzdGFydF9zZWN0b3IgKyBkYXRhX29mZnNldDsKPiAgCj4gIAlpZiAo
dW5saWtlbHkoKGJpb19vcChiaW8pID09IFJFUV9PUF9ESVNDQVJEKSAmJgo+IC0JCSAgICAgIWJs
a19xdWV1ZV9kaXNjYXJkKGJpby0+YmlfYmRldi0+YmRfZGlzay0+cXVldWUpKSkgewo+ICsJCSAg
ICAgIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhiaW8tPmJpX2JkZXYpKSkgewo+ICAJCS8qIEp1
c3QgaWdub3JlIGl0ICovCj4gIAkJYmlvX2VuZGlvKGJpbyk7Cj4gIAl9IGVsc2Ugewo+IGRpZmYg
LS1naXQgYS9kcml2ZXJzL21kL3JhaWQwLmMgYi9kcml2ZXJzL21kL3JhaWQwLmMKPiBpbmRleCBi
MjFlMTAxMTgzZjQ0Li4wMmFjM2FiMjEzYzcyIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvbWQvcmFp
ZDAuYwo+ICsrKyBiL2RyaXZlcnMvbWQvcmFpZDAuYwo+IEBAIC00MTIsNyArNDEyLDcgQEAgc3Rh
dGljIGludCByYWlkMF9ydW4oc3RydWN0IG1kZGV2ICptZGRldikKPiAgCQlyZGV2X2Zvcl9lYWNo
KHJkZXYsIG1kZGV2KSB7Cj4gIAkJCWRpc2tfc3RhY2tfbGltaXRzKG1kZGV2LT5nZW5kaXNrLCBy
ZGV2LT5iZGV2LAo+ICAJCQkJCSAgcmRldi0+ZGF0YV9vZmZzZXQgPDwgOSk7Cj4gLQkJCWlmIChi
bGtfcXVldWVfZGlzY2FyZChiZGV2X2dldF9xdWV1ZShyZGV2LT5iZGV2KSkpCj4gKwkJCWlmIChi
ZGV2X21heF9kaXNjYXJkX3NlY3RvcnMocmRldi0+YmRldikpCj4gIAkJCQlkaXNjYXJkX3N1cHBv
cnRlZCA9IHRydWU7Cj4gIAkJfQo+ICAJCWlmICghZGlzY2FyZF9zdXBwb3J0ZWQpCj4gZGlmZiAt
LWdpdCBhL2RyaXZlcnMvbWQvcmFpZDEuYyBiL2RyaXZlcnMvbWQvcmFpZDEuYwo+IGluZGV4IGQ4
MWI4OTY4NTVmOWYuLjM5YjljYjRkNTRlZTAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9tZC9yYWlk
MS5jCj4gKysrIGIvZHJpdmVycy9tZC9yYWlkMS5jCj4gQEAgLTgwMiw3ICs4MDIsNyBAQCBzdGF0
aWMgdm9pZCBmbHVzaF9iaW9fbGlzdChzdHJ1Y3QgcjFjb25mICpjb25mLCBzdHJ1Y3QgYmlvICpi
aW8pCj4gIAkJaWYgKHRlc3RfYml0KEZhdWx0eSwgJnJkZXYtPmZsYWdzKSkgewo+ICAJCQliaW9f
aW9fZXJyb3IoYmlvKTsKPiAgCQl9IGVsc2UgaWYgKHVubGlrZWx5KChiaW9fb3AoYmlvKSA9PSBS
RVFfT1BfRElTQ0FSRCkgJiYKPiAtCQkJCSAgICAhYmxrX3F1ZXVlX2Rpc2NhcmQoYmlvLT5iaV9i
ZGV2LT5iZF9kaXNrLT5xdWV1ZSkpKQo+ICsJCQkJICAgICFiZGV2X21heF9kaXNjYXJkX3NlY3Rv
cnMoYmlvLT5iaV9iZGV2KSkpCj4gIAkJCS8qIEp1c3QgaWdub3JlIGl0ICovCj4gIAkJCWJpb19l
bmRpbyhiaW8pOwo+ICAJCWVsc2UKPiBAQCAtMTgyNiw3ICsxODI2LDcgQEAgc3RhdGljIGludCBy
YWlkMV9hZGRfZGlzayhzdHJ1Y3QgbWRkZXYgKm1kZGV2LCBzdHJ1Y3QgbWRfcmRldiAqcmRldikK
PiAgCQkJYnJlYWs7Cj4gIAkJfQo+ICAJfQo+IC0JaWYgKG1kZGV2LT5xdWV1ZSAmJiBibGtfcXVl
dWVfZGlzY2FyZChiZGV2X2dldF9xdWV1ZShyZGV2LT5iZGV2KSkpCj4gKwlpZiAobWRkZXYtPnF1
ZXVlICYmIGJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhyZGV2LT5iZGV2KSkKPiAgCQlibGtfcXVl
dWVfZmxhZ19zZXQoUVVFVUVfRkxBR19ESVNDQVJELCBtZGRldi0+cXVldWUpOwo+ICAJcHJpbnRf
Y29uZihjb25mKTsKPiAgCXJldHVybiBlcnI7Cj4gQEAgLTMxNDEsNyArMzE0MSw3IEBAIHN0YXRp
YyBpbnQgcmFpZDFfcnVuKHN0cnVjdCBtZGRldiAqbWRkZXYpCj4gIAkJCWNvbnRpbnVlOwo+ICAJ
CWRpc2tfc3RhY2tfbGltaXRzKG1kZGV2LT5nZW5kaXNrLCByZGV2LT5iZGV2LAo+ICAJCQkJICBy
ZGV2LT5kYXRhX29mZnNldCA8PCA5KTsKPiAtCQlpZiAoYmxrX3F1ZXVlX2Rpc2NhcmQoYmRldl9n
ZXRfcXVldWUocmRldi0+YmRldikpKQo+ICsJCWlmIChiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMo
cmRldi0+YmRldikpCj4gIAkJCWRpc2NhcmRfc3VwcG9ydGVkID0gdHJ1ZTsKPiAgCX0KPiAgCj4g
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWQvcmFpZDEwLmMgYi9kcml2ZXJzL21kL3JhaWQxMC5jCj4g
aW5kZXggNzgxNmM4YjJlODA4Ny4uZWFhODZjNmEzNWE1NSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJz
L21kL3JhaWQxMC5jCj4gKysrIGIvZHJpdmVycy9tZC9yYWlkMTAuYwo+IEBAIC04ODgsNyArODg4
LDcgQEAgc3RhdGljIHZvaWQgZmx1c2hfcGVuZGluZ193cml0ZXMoc3RydWN0IHIxMGNvbmYgKmNv
bmYpCj4gIAkJCWlmICh0ZXN0X2JpdChGYXVsdHksICZyZGV2LT5mbGFncykpIHsKPiAgCQkJCWJp
b19pb19lcnJvcihiaW8pOwo+ICAJCQl9IGVsc2UgaWYgKHVubGlrZWx5KChiaW9fb3AoYmlvKSA9
PSAgUkVRX09QX0RJU0NBUkQpICYmCj4gLQkJCQkJICAgICFibGtfcXVldWVfZGlzY2FyZChiaW8t
PmJpX2JkZXYtPmJkX2Rpc2stPnF1ZXVlKSkpCj4gKwkJCQkJICAgICFiZGV2X21heF9kaXNjYXJk
X3NlY3RvcnMoYmlvLT5iaV9iZGV2KSkpCj4gIAkJCQkvKiBKdXN0IGlnbm9yZSBpdCAqLwo+ICAJ
CQkJYmlvX2VuZGlvKGJpbyk7Cj4gIAkJCWVsc2UKPiBAQCAtMTA4Myw3ICsxMDgzLDcgQEAgc3Rh
dGljIHZvaWQgcmFpZDEwX3VucGx1ZyhzdHJ1Y3QgYmxrX3BsdWdfY2IgKmNiLCBib29sIGZyb21f
c2NoZWR1bGUpCj4gIAkJaWYgKHRlc3RfYml0KEZhdWx0eSwgJnJkZXYtPmZsYWdzKSkgewo+ICAJ
CQliaW9faW9fZXJyb3IoYmlvKTsKPiAgCQl9IGVsc2UgaWYgKHVubGlrZWx5KChiaW9fb3AoYmlv
KSA9PSAgUkVRX09QX0RJU0NBUkQpICYmCj4gLQkJCQkgICAgIWJsa19xdWV1ZV9kaXNjYXJkKGJp
by0+YmlfYmRldi0+YmRfZGlzay0+cXVldWUpKSkKPiArCQkJCSAgICAhYmRldl9tYXhfZGlzY2Fy
ZF9zZWN0b3JzKGJpby0+YmlfYmRldikpKQo+ICAJCQkvKiBKdXN0IGlnbm9yZSBpdCAqLwo+ICAJ
CQliaW9fZW5kaW8oYmlvKTsKPiAgCQllbHNlCj4gQEAgLTIxNDQsNyArMjE0NCw3IEBAIHN0YXRp
YyBpbnQgcmFpZDEwX2FkZF9kaXNrKHN0cnVjdCBtZGRldiAqbWRkZXYsIHN0cnVjdCBtZF9yZGV2
ICpyZGV2KQo+ICAJCXJjdV9hc3NpZ25fcG9pbnRlcihwLT5yZGV2LCByZGV2KTsKPiAgCQlicmVh
azsKPiAgCX0KPiAtCWlmIChtZGRldi0+cXVldWUgJiYgYmxrX3F1ZXVlX2Rpc2NhcmQoYmRldl9n
ZXRfcXVldWUocmRldi0+YmRldikpKQo+ICsJaWYgKG1kZGV2LT5xdWV1ZSAmJiBiZGV2X21heF9k
aXNjYXJkX3NlY3RvcnMocmRldi0+YmRldikpCj4gIAkJYmxrX3F1ZXVlX2ZsYWdfc2V0KFFVRVVF
X0ZMQUdfRElTQ0FSRCwgbWRkZXYtPnF1ZXVlKTsKPiAgCj4gIAlwcmludF9jb25mKGNvbmYpOwo+
IEBAIC00MTQxLDcgKzQxNDEsNyBAQCBzdGF0aWMgaW50IHJhaWQxMF9ydW4oc3RydWN0IG1kZGV2
ICptZGRldikKPiAgCj4gIAkJZGlzay0+aGVhZF9wb3NpdGlvbiA9IDA7Cj4gIAo+IC0JCWlmIChi
bGtfcXVldWVfZGlzY2FyZChiZGV2X2dldF9xdWV1ZShyZGV2LT5iZGV2KSkpCj4gKwkJaWYgKGJk
ZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhyZGV2LT5iZGV2KSkKPiAgCQkJZGlzY2FyZF9zdXBwb3J0
ZWQgPSB0cnVlOwo+ICAJCWZpcnN0ID0gMDsKPiAgCX0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9t
ZC9yYWlkNS1jYWNoZS5jIGIvZHJpdmVycy9tZC9yYWlkNS1jYWNoZS5jCj4gaW5kZXggYTdkNTBm
ZjkwMjBhOC4uYzNjYmY5YTU3NGEzOSAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL21kL3JhaWQ1LWNh
Y2hlLmMKPiArKysgYi9kcml2ZXJzL21kL3JhaWQ1LWNhY2hlLmMKPiBAQCAtMTMxOCw3ICsxMzE4
LDcgQEAgc3RhdGljIHZvaWQgcjVsX3dyaXRlX3N1cGVyX2FuZF9kaXNjYXJkX3NwYWNlKHN0cnVj
dCByNWxfbG9nICpsb2csCj4gIAo+ICAJcjVsX3dyaXRlX3N1cGVyKGxvZywgZW5kKTsKPiAgCj4g
LQlpZiAoIWJsa19xdWV1ZV9kaXNjYXJkKGJkZXZfZ2V0X3F1ZXVlKGJkZXYpKSkKPiArCWlmICgh
YmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKGJkZXYpKQo+ICAJCXJldHVybjsKPiAgCj4gIAltZGRl
diA9IGxvZy0+cmRldi0+bWRkZXY7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdGFyZ2V0L3Rhcmdl
dF9jb3JlX2RldmljZS5jIGIvZHJpdmVycy90YXJnZXQvdGFyZ2V0X2NvcmVfZGV2aWNlLmMKPiBp
bmRleCAxNmU3NzViY2Y0YTdjLi43ZDUxMGU0MjMxNzEzIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMv
dGFyZ2V0L3RhcmdldF9jb3JlX2RldmljZS5jCj4gKysrIGIvZHJpdmVycy90YXJnZXQvdGFyZ2V0
X2NvcmVfZGV2aWNlLmMKPiBAQCAtODI5LDkgKzgyOSw3IEBAIHN0cnVjdCBzZV9kZXZpY2UgKnRh
cmdldF9hbGxvY19kZXZpY2Uoc3RydWN0IHNlX2hiYSAqaGJhLCBjb25zdCBjaGFyICpuYW1lKQo+
ICB9Cj4gIAo+ICAvKgo+IC0gKiBDaGVjayBpZiB0aGUgdW5kZXJseWluZyBzdHJ1Y3QgYmxvY2tf
ZGV2aWNlIHJlcXVlc3RfcXVldWUgc3VwcG9ydHMKPiAtICogdGhlIFFVRVVFX0ZMQUdfRElTQ0FS
RCBiaXQgZm9yIFVOTUFQL1dSSVRFX1NBTUUgaW4gU0NTSSArIFRSSU0KPiAtICogaW4gQVRBIGFu
ZCB3ZSBuZWVkIHRvIHNldCBUUEU9MQo+ICsgKiBDaGVjayBpZiB0aGUgdW5kZXJseWluZyBzdHJ1
Y3QgYmxvY2tfZGV2aWNlIHJlcXVlc3RfcXVldWUgc3VwcG9ydHMgZGlzYXJkLgo+ICAgKi8KPiAg
Ym9vbCB0YXJnZXRfY29uZmlndXJlX3VubWFwX2Zyb21fcXVldWUoc3RydWN0IHNlX2Rldl9hdHRy
aWIgKmF0dHJpYiwKPiAgCQkJCSAgICAgICBzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2KQo+IEBA
IC04MzksMTEgKzgzNywxMSBAQCBib29sIHRhcmdldF9jb25maWd1cmVfdW5tYXBfZnJvbV9xdWV1
ZShzdHJ1Y3Qgc2VfZGV2X2F0dHJpYiAqYXR0cmliLAo+ICAJc3RydWN0IHJlcXVlc3RfcXVldWUg
KnEgPSBiZGV2X2dldF9xdWV1ZShiZGV2KTsKPiAgCWludCBibG9ja19zaXplID0gYmRldl9sb2dp
Y2FsX2Jsb2NrX3NpemUoYmRldik7Cj4gIAo+IC0JaWYgKCFibGtfcXVldWVfZGlzY2FyZChxKSkK
PiArCWlmICghYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKGJkZXYpKQo+ICAJCXJldHVybiBmYWxz
ZTsKPiAgCj4gIAlhdHRyaWItPm1heF91bm1hcF9sYmFfY291bnQgPQo+IC0JCXEtPmxpbWl0cy5t
YXhfZGlzY2FyZF9zZWN0b3JzID4+IChpbG9nMihibG9ja19zaXplKSAtIDkpOwo+ICsJCWJkZXZf
bWF4X2Rpc2NhcmRfc2VjdG9ycyhiZGV2KSA+PiAoaWxvZzIoYmxvY2tfc2l6ZSkgLSA5KTsKPiAg
CS8qCj4gIAkgKiBDdXJyZW50bHkgaGFyZGNvZGVkIHRvIDEgaW4gTGludXgvU0NTSSBjb2RlLi4K
PiAgCSAqLwo+IGRpZmYgLS1naXQgYS9mcy9idHJmcy9leHRlbnQtdHJlZS5jIGIvZnMvYnRyZnMv
ZXh0ZW50LXRyZWUuYwo+IGluZGV4IGY0NzcwMzVhMmFjMjMuLmVmZDhkZWIzYWI3ZTggMTAwNjQ0
Cj4gLS0tIGEvZnMvYnRyZnMvZXh0ZW50LXRyZWUuYwo+ICsrKyBiL2ZzL2J0cmZzL2V4dGVudC10
cmVlLmMKPiBAQCAtMTI5MSw3ICsxMjkxLDcgQEAgc3RhdGljIGludCBkb19kaXNjYXJkX2V4dGVu
dChzdHJ1Y3QgYnRyZnNfaW9fc3RyaXBlICpzdHJpcGUsIHU2NCAqYnl0ZXMpCj4gIAkJcmV0ID0g
YnRyZnNfcmVzZXRfZGV2aWNlX3pvbmUoZGV2X3JlcGxhY2UtPnRndGRldiwgcGh5cywgbGVuLAo+
ICAJCQkJCSAgICAgICZkaXNjYXJkZWQpOwo+ICAJCWRpc2NhcmRlZCArPSBzcmNfZGlzYzsKPiAt
CX0gZWxzZSBpZiAoYmxrX3F1ZXVlX2Rpc2NhcmQoYmRldl9nZXRfcXVldWUoc3RyaXBlLT5kZXYt
PmJkZXYpKSkgewo+ICsJfSBlbHNlIGlmIChiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoc3RyaXBl
LT5kZXYtPmJkZXYpKSB7Cj4gIAkJcmV0ID0gYnRyZnNfaXNzdWVfZGlzY2FyZChkZXYtPmJkZXYs
IHBoeXMsIGxlbiwgJmRpc2NhcmRlZCk7Cj4gIAl9IGVsc2Ugewo+ICAJCXJldCA9IDA7Cj4gQEAg
LTU5ODcsNyArNTk4Nyw3IEBAIHN0YXRpYyBpbnQgYnRyZnNfdHJpbV9mcmVlX2V4dGVudHMoc3Ry
dWN0IGJ0cmZzX2RldmljZSAqZGV2aWNlLCB1NjQgKnRyaW1tZWQpCj4gIAkqdHJpbW1lZCA9IDA7
Cj4gIAo+ICAJLyogRGlzY2FyZCBub3Qgc3VwcG9ydGVkID0gbm90aGluZyB0byBkby4gKi8KPiAt
CWlmICghYmxrX3F1ZXVlX2Rpc2NhcmQoYmRldl9nZXRfcXVldWUoZGV2aWNlLT5iZGV2KSkpCj4g
KwlpZiAoIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhkZXZpY2UtPmJkZXYpKQo+ICAJCXJldHVy
biAwOwo+ICAKPiAgCS8qIE5vdCB3cml0YWJsZSA9IG5vdGhpbmcgdG8gZG8uICovCj4gZGlmZiAt
LWdpdCBhL2ZzL2J0cmZzL2lvY3RsLmMgYi9mcy9idHJmcy9pb2N0bC5jCj4gaW5kZXggMjM4Y2Vl
NWI1MjU0ZC4uZmM3OTUzNzU1ZmQ4YiAxMDA2NDQKPiAtLS0gYS9mcy9idHJmcy9pb2N0bC5jCj4g
KysrIGIvZnMvYnRyZnMvaW9jdGwuYwo+IEBAIC01MDEsNyArNTAxLDcgQEAgc3RhdGljIG5vaW5s
aW5lIGludCBidHJmc19pb2N0bF9maXRyaW0oc3RydWN0IGJ0cmZzX2ZzX2luZm8gKmZzX2luZm8s
Cj4gIAkJaWYgKCFkZXZpY2UtPmJkZXYpCj4gIAkJCWNvbnRpbnVlOwo+ICAJCXEgPSBiZGV2X2dl
dF9xdWV1ZShkZXZpY2UtPmJkZXYpOwo+IC0JCWlmIChibGtfcXVldWVfZGlzY2FyZChxKSkgewo+
ICsJCWlmIChiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoZGV2aWNlLT5iZGV2KSkgewo+ICAJCQlu
dW1fZGV2aWNlcysrOwo+ICAJCQltaW5sZW4gPSBtaW5fdCh1NjQsIHEtPmxpbWl0cy5kaXNjYXJk
X2dyYW51bGFyaXR5LAo+ICAJCQkJICAgICBtaW5sZW4pOwo+IGRpZmYgLS1naXQgYS9mcy9leGZh
dC9maWxlLmMgYi9mcy9leGZhdC9maWxlLmMKPiBpbmRleCAyZjUxMzAwNTkyMzY2Li43NjVlNGY2
M2RkMThkIDEwMDY0NAo+IC0tLSBhL2ZzL2V4ZmF0L2ZpbGUuYwo+ICsrKyBiL2ZzL2V4ZmF0L2Zp
bGUuYwo+IEBAIC0zNTgsNyArMzU4LDcgQEAgc3RhdGljIGludCBleGZhdF9pb2N0bF9maXRyaW0o
c3RydWN0IGlub2RlICppbm9kZSwgdW5zaWduZWQgbG9uZyBhcmcpCj4gIAlpZiAoIWNhcGFibGUo
Q0FQX1NZU19BRE1JTikpCj4gIAkJcmV0dXJuIC1FUEVSTTsKPiAgCj4gLQlpZiAoIWJsa19xdWV1
ZV9kaXNjYXJkKHEpKQo+ICsJaWYgKCFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoaW5vZGUtPmlf
c2ItPnNfYmRldikpCj4gIAkJcmV0dXJuIC1FT1BOT1RTVVBQOwo+ICAKPiAgCWlmIChjb3B5X2Zy
b21fdXNlcigmcmFuZ2UsIChzdHJ1Y3QgZnN0cmltX3JhbmdlIF9fdXNlciAqKWFyZywgc2l6ZW9m
KHJhbmdlKSkpCj4gZGlmZiAtLWdpdCBhL2ZzL2V4ZmF0L3N1cGVyLmMgYi9mcy9leGZhdC9zdXBl
ci5jCj4gaW5kZXggOGNhMjFlNzkxN2QxNi4uYmUwNzg4ZWNhZjIwZSAxMDA2NDQKPiAtLS0gYS9m
cy9leGZhdC9zdXBlci5jCj4gKysrIGIvZnMvZXhmYXQvc3VwZXIuYwo+IEBAIC02MjcsMTMgKzYy
Nyw5IEBAIHN0YXRpYyBpbnQgZXhmYXRfZmlsbF9zdXBlcihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
LCBzdHJ1Y3QgZnNfY29udGV4dCAqZmMpCj4gIAlpZiAob3B0cy0+YWxsb3dfdXRpbWUgPT0gKHVu
c2lnbmVkIHNob3J0KS0xKQo+ICAJCW9wdHMtPmFsbG93X3V0aW1lID0gfm9wdHMtPmZzX2RtYXNr
ICYgMDAyMjsKPiAgCj4gLQlpZiAob3B0cy0+ZGlzY2FyZCkgewo+IC0JCXN0cnVjdCByZXF1ZXN0
X3F1ZXVlICpxID0gYmRldl9nZXRfcXVldWUoc2ItPnNfYmRldik7Cj4gLQo+IC0JCWlmICghYmxr
X3F1ZXVlX2Rpc2NhcmQocSkpIHsKPiAtCQkJZXhmYXRfd2FybihzYiwgIm1vdW50aW5nIHdpdGgg
XCJkaXNjYXJkXCIgb3B0aW9uLCBidXQgdGhlIGRldmljZSBkb2VzIG5vdCBzdXBwb3J0IGRpc2Nh
cmQiKTsKPiAtCQkJb3B0cy0+ZGlzY2FyZCA9IDA7Cj4gLQkJfQo+ICsJaWYgKG9wdHMtPmRpc2Nh
cmQgJiYgIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhzYi0+c19iZGV2KSkgewo+ICsJCWV4ZmF0
X3dhcm4oc2IsICJtb3VudGluZyB3aXRoIFwiZGlzY2FyZFwiIG9wdGlvbiwgYnV0IHRoZSBkZXZp
Y2UgZG9lcyBub3Qgc3VwcG9ydCBkaXNjYXJkIik7Cj4gKwkJb3B0cy0+ZGlzY2FyZCA9IDA7Cj4g
IAl9Cj4gIAo+ICAJc2ItPnNfZmxhZ3MgfD0gU0JfTk9ESVJBVElNRTsKPiBkaWZmIC0tZ2l0IGEv
ZnMvZXh0NC9pb2N0bC5jIGIvZnMvZXh0NC9pb2N0bC5jCj4gaW5kZXggOTkyMjI5Y2EyZDgzMC4u
NmUzYjllZWExMjZmNCAxMDA2NDQKPiAtLS0gYS9mcy9leHQ0L2lvY3RsLmMKPiArKysgYi9mcy9l
eHQ0L2lvY3RsLmMKPiBAQCAtMTA0NCw3ICsxMDQ0LDYgQEAgc3RhdGljIGludCBleHQ0X2lvY3Rs
X2NoZWNrcG9pbnQoc3RydWN0IGZpbGUgKmZpbHAsIHVuc2lnbmVkIGxvbmcgYXJnKQo+ICAJX191
MzIgZmxhZ3MgPSAwOwo+ICAJdW5zaWduZWQgaW50IGZsdXNoX2ZsYWdzID0gMDsKPiAgCXN0cnVj
dCBzdXBlcl9ibG9jayAqc2IgPSBmaWxlX2lub2RlKGZpbHApLT5pX3NiOwo+IC0Jc3RydWN0IHJl
cXVlc3RfcXVldWUgKnE7Cj4gIAo+ICAJaWYgKGNvcHlfZnJvbV91c2VyKCZmbGFncywgKF9fdTMy
IF9fdXNlciAqKWFyZywKPiAgCQkJCXNpemVvZihfX3UzMikpKQo+IEBAIC0xMDY1LDEwICsxMDY0
LDggQEAgc3RhdGljIGludCBleHQ0X2lvY3RsX2NoZWNrcG9pbnQoc3RydWN0IGZpbGUgKmZpbHAs
IHVuc2lnbmVkIGxvbmcgYXJnKQo+ICAJaWYgKGZsYWdzICYgfkVYVDRfSU9DX0NIRUNLUE9JTlRf
RkxBR19WQUxJRCkKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiAgCj4gLQlxID0gYmRldl9nZXRfcXVl
dWUoRVhUNF9TQihzYiktPnNfam91cm5hbC0+al9kZXYpOwo+IC0JaWYgKCFxKQo+IC0JCXJldHVy
biAtRU5YSU87Cj4gLQlpZiAoKGZsYWdzICYgSkJEMl9KT1VSTkFMX0ZMVVNIX0RJU0NBUkQpICYm
ICFibGtfcXVldWVfZGlzY2FyZChxKSkKPiArCWlmICgoZmxhZ3MgJiBKQkQyX0pPVVJOQUxfRkxV
U0hfRElTQ0FSRCkgJiYKPiArCSAgICAhYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKEVYVDRfU0Io
c2IpLT5zX2pvdXJuYWwtPmpfZGV2KSkKPiAgCQlyZXR1cm4gLUVPUE5PVFNVUFA7Cj4gIAo+ICAJ
aWYgKGZsYWdzICYgRVhUNF9JT0NfQ0hFQ0tQT0lOVF9GTEFHX0RSWV9SVU4pCj4gQEAgLTEzOTMs
MTQgKzEzOTAsMTMgQEAgc3RhdGljIGxvbmcgX19leHQ0X2lvY3RsKHN0cnVjdCBmaWxlICpmaWxw
LCB1bnNpZ25lZCBpbnQgY21kLCB1bnNpZ25lZCBsb25nIGFyZykKPiAgCj4gIAljYXNlIEZJVFJJ
TToKPiAgCXsKPiAtCQlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSA9IGJkZXZfZ2V0X3F1ZXVlKHNi
LT5zX2JkZXYpOwo+ICAJCXN0cnVjdCBmc3RyaW1fcmFuZ2UgcmFuZ2U7Cj4gIAkJaW50IHJldCA9
IDA7Cj4gIAo+ICAJCWlmICghY2FwYWJsZShDQVBfU1lTX0FETUlOKSkKPiAgCQkJcmV0dXJuIC1F
UEVSTTsKPiAgCj4gLQkJaWYgKCFibGtfcXVldWVfZGlzY2FyZChxKSkKPiArCQlpZiAoIWJkZXZf
bWF4X2Rpc2NhcmRfc2VjdG9ycyhzYi0+c19iZGV2KSkKPiAgCQkJcmV0dXJuIC1FT1BOT1RTVVBQ
Owo+ICAKPiAgCQkvKgo+IGRpZmYgLS1naXQgYS9mcy9leHQ0L3N1cGVyLmMgYi9mcy9leHQ0L3N1
cGVyLmMKPiBpbmRleCA4MTc0OWVhZGRmNGMxLi45M2Y0ZTRlOWUyNjMxIDEwMDY0NAo+IC0tLSBh
L2ZzL2V4dDQvc3VwZXIuYwo+ICsrKyBiL2ZzL2V4dDQvc3VwZXIuYwo+IEBAIC01NDU4LDEzICs1
NDU4LDkgQEAgc3RhdGljIGludCBfX2V4dDRfZmlsbF9zdXBlcihzdHJ1Y3QgZnNfY29udGV4dCAq
ZmMsIHN0cnVjdCBzdXBlcl9ibG9jayAqc2IpCj4gIAkJCWdvdG8gZmFpbGVkX21vdW50OTsKPiAg
CX0KPiAgCj4gLQlpZiAodGVzdF9vcHQoc2IsIERJU0NBUkQpKSB7Cj4gLQkJc3RydWN0IHJlcXVl
c3RfcXVldWUgKnEgPSBiZGV2X2dldF9xdWV1ZShzYi0+c19iZGV2KTsKPiAtCQlpZiAoIWJsa19x
dWV1ZV9kaXNjYXJkKHEpKQo+IC0JCQlleHQ0X21zZyhzYiwgS0VSTl9XQVJOSU5HLAo+IC0JCQkJ
ICJtb3VudGluZyB3aXRoIFwiZGlzY2FyZFwiIG9wdGlvbiwgYnV0ICIKPiAtCQkJCSAidGhlIGRl
dmljZSBkb2VzIG5vdCBzdXBwb3J0IGRpc2NhcmQiKTsKPiAtCX0KPiArCWlmICh0ZXN0X29wdChz
YiwgRElTQ0FSRCkgJiYgIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhzYi0+c19iZGV2KSkKPiAr
CQlleHQ0X21zZyhzYiwgS0VSTl9XQVJOSU5HLAo+ICsJCQkgIm1vdW50aW5nIHdpdGggXCJkaXNj
YXJkXCIgb3B0aW9uLCBidXQgdGhlIGRldmljZSBkb2VzIG5vdCBzdXBwb3J0IGRpc2NhcmQiKTsK
PiAgCj4gIAlpZiAoZXMtPnNfZXJyb3JfY291bnQpCj4gIAkJbW9kX3RpbWVyKCZzYmktPnNfZXJy
X3JlcG9ydCwgamlmZmllcyArIDMwMCpIWik7IC8qIDUgbWludXRlcyAqLwo+IGRpZmYgLS1naXQg
YS9mcy9mMmZzL2YyZnMuaCBiL2ZzL2YyZnMvZjJmcy5oCj4gaW5kZXggY2QxZTY1YmNmMGIwNC4u
MGVhOWE1ZmE3YzFkZCAxMDA2NDQKPiAtLS0gYS9mcy9mMmZzL2YyZnMuaAo+ICsrKyBiL2ZzL2Yy
ZnMvZjJmcy5oCj4gQEAgLTQzODEsOCArNDM4MSw3IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBmMmZz
X2h3X3Nob3VsZF9kaXNjYXJkKHN0cnVjdCBmMmZzX3NiX2luZm8gKnNiaSkKPiAgCj4gIHN0YXRp
YyBpbmxpbmUgYm9vbCBmMmZzX2JkZXZfc3VwcG9ydF9kaXNjYXJkKHN0cnVjdCBibG9ja19kZXZp
Y2UgKmJkZXYpCj4gIHsKPiAtCXJldHVybiBibGtfcXVldWVfZGlzY2FyZChiZGV2X2dldF9xdWV1
ZShiZGV2KSkgfHwKPiAtCSAgICAgICBiZGV2X2lzX3pvbmVkKGJkZXYpOwo+ICsJcmV0dXJuIGJk
ZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhiZGV2KSB8fCBiZGV2X2lzX3pvbmVkKGJkZXYpOwo+ICB9
Cj4gIAo+ICBzdGF0aWMgaW5saW5lIGJvb2wgZjJmc19od19zdXBwb3J0X2Rpc2NhcmQoc3RydWN0
IGYyZnNfc2JfaW5mbyAqc2JpKQo+IGRpZmYgLS1naXQgYS9mcy9mMmZzL3NlZ21lbnQuYyBiL2Zz
L2YyZnMvc2VnbWVudC5jCj4gaW5kZXggMjJkZmViOTkxNTI5MC4uNzFmMDlhZGJjYmE4NiAxMDA2
NDQKPiAtLS0gYS9mcy9mMmZzL3NlZ21lbnQuYwo+ICsrKyBiL2ZzL2YyZnMvc2VnbWVudC5jCj4g
QEAgLTExOTYsOSArMTE5Niw4IEBAIHN0YXRpYyBpbnQgX19zdWJtaXRfZGlzY2FyZF9jbWQoc3Ry
dWN0IGYyZnNfc2JfaW5mbyAqc2JpLAo+ICAJCQkJCQl1bnNpZ25lZCBpbnQgKmlzc3VlZCkKPiAg
ewo+ICAJc3RydWN0IGJsb2NrX2RldmljZSAqYmRldiA9IGRjLT5iZGV2Owo+IC0Jc3RydWN0IHJl
cXVlc3RfcXVldWUgKnEgPSBiZGV2X2dldF9xdWV1ZShiZGV2KTsKPiAgCXVuc2lnbmVkIGludCBt
YXhfZGlzY2FyZF9ibG9ja3MgPQo+IC0JCQlTRUNUT1JfVE9fQkxPQ0socS0+bGltaXRzLm1heF9k
aXNjYXJkX3NlY3RvcnMpOwo+ICsJCQlTRUNUT1JfVE9fQkxPQ0soYmRldl9tYXhfZGlzY2FyZF9z
ZWN0b3JzKGJkZXYpKTsKPiAgCXN0cnVjdCBkaXNjYXJkX2NtZF9jb250cm9sICpkY2MgPSBTTV9J
KHNiaSktPmRjY19pbmZvOwo+ICAJc3RydWN0IGxpc3RfaGVhZCAqd2FpdF9saXN0ID0gKGRwb2xp
Y3ktPnR5cGUgPT0gRFBPTElDWV9GU1RSSU0pID8KPiAgCQkJCQkmKGRjYy0+ZnN0cmltX2xpc3Qp
IDogJihkY2MtPndhaXRfbGlzdCk7Cj4gQEAgLTEzNzUsOSArMTM3NCw4IEBAIHN0YXRpYyB2b2lk
IF9fdXBkYXRlX2Rpc2NhcmRfdHJlZV9yYW5nZShzdHJ1Y3QgZjJmc19zYl9pbmZvICpzYmksCj4g
IAlzdHJ1Y3QgZGlzY2FyZF9jbWQgKmRjOwo+ICAJc3RydWN0IGRpc2NhcmRfaW5mbyBkaSA9IHsw
fTsKPiAgCXN0cnVjdCByYl9ub2RlICoqaW5zZXJ0X3AgPSBOVUxMLCAqaW5zZXJ0X3BhcmVudCA9
IE5VTEw7Cj4gLQlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSA9IGJkZXZfZ2V0X3F1ZXVlKGJkZXYp
Owo+ICAJdW5zaWduZWQgaW50IG1heF9kaXNjYXJkX2Jsb2NrcyA9Cj4gLQkJCVNFQ1RPUl9UT19C
TE9DSyhxLT5saW1pdHMubWF4X2Rpc2NhcmRfc2VjdG9ycyk7Cj4gKwkJCVNFQ1RPUl9UT19CTE9D
SyhiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoYmRldikpOwo+ICAJYmxvY2tfdCBlbmQgPSBsc3Rh
cnQgKyBsZW47Cj4gIAo+ICAJZGMgPSAoc3RydWN0IGRpc2NhcmRfY21kICopZjJmc19sb29rdXBf
cmJfdHJlZV9yZXQoJmRjYy0+cm9vdCwKPiBkaWZmIC0tZ2l0IGEvZnMvZmF0L2ZpbGUuYyBiL2Zz
L2ZhdC9maWxlLmMKPiBpbmRleCBhNWEzMDlmY2M3ZmFmLi5lNGM3ZDEwZTgwMTI5IDEwMDY0NAo+
IC0tLSBhL2ZzL2ZhdC9maWxlLmMKPiArKysgYi9mcy9mYXQvZmlsZS5jCj4gQEAgLTEzMyw3ICsx
MzMsNyBAQCBzdGF0aWMgaW50IGZhdF9pb2N0bF9maXRyaW0oc3RydWN0IGlub2RlICppbm9kZSwg
dW5zaWduZWQgbG9uZyBhcmcpCj4gIAlpZiAoIWNhcGFibGUoQ0FQX1NZU19BRE1JTikpCj4gIAkJ
cmV0dXJuIC1FUEVSTTsKPiAgCj4gLQlpZiAoIWJsa19xdWV1ZV9kaXNjYXJkKHEpKQo+ICsJaWYg
KCFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoc2ItPnNfYmRldikpCj4gIAkJcmV0dXJuIC1FT1BO
T1RTVVBQOwo+ICAKPiAgCXVzZXJfcmFuZ2UgPSAoc3RydWN0IGZzdHJpbV9yYW5nZSBfX3VzZXIg
Kilhcmc7Cj4gZGlmZiAtLWdpdCBhL2ZzL2ZhdC9pbm9kZS5jIGIvZnMvZmF0L2lub2RlLmMKPiBp
bmRleCBiZjYwNTFiZGYxZDFkLi4zZDFhZmI5NWE5MjVhIDEwMDY0NAo+IC0tLSBhL2ZzL2ZhdC9p
bm9kZS5jCj4gKysrIGIvZnMvZmF0L2lub2RlLmMKPiBAQCAtMTg3MiwxMyArMTg3Miw5IEBAIGlu
dCBmYXRfZmlsbF9zdXBlcihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCB2b2lkICpkYXRhLCBpbnQg
c2lsZW50LCBpbnQgaXN2ZmF0LAo+ICAJCWdvdG8gb3V0X2ZhaWw7Cj4gIAl9Cj4gIAo+IC0JaWYg
KHNiaS0+b3B0aW9ucy5kaXNjYXJkKSB7Cj4gLQkJc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBi
ZGV2X2dldF9xdWV1ZShzYi0+c19iZGV2KTsKPiAtCQlpZiAoIWJsa19xdWV1ZV9kaXNjYXJkKHEp
KQo+IC0JCQlmYXRfbXNnKHNiLCBLRVJOX1dBUk5JTkcsCj4gLQkJCQkJIm1vdW50aW5nIHdpdGgg
XCJkaXNjYXJkXCIgb3B0aW9uLCBidXQgIgo+IC0JCQkJCSJ0aGUgZGV2aWNlIGRvZXMgbm90IHN1
cHBvcnQgZGlzY2FyZCIpOwo+IC0JfQo+ICsJaWYgKHNiaS0+b3B0aW9ucy5kaXNjYXJkICYmICFi
ZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoc2ItPnNfYmRldikpCj4gKwkJZmF0X21zZyhzYiwgS0VS
Tl9XQVJOSU5HLAo+ICsJCQkibW91bnRpbmcgd2l0aCBcImRpc2NhcmRcIiBvcHRpb24sIGJ1dCB0
aGUgZGV2aWNlIGRvZXMgbm90IHN1cHBvcnQgZGlzY2FyZCIpOwo+ICAKPiAgCWZhdF9zZXRfc3Rh
dGUoc2IsIDEsIDApOwo+ICAJcmV0dXJuIDA7Cj4gZGlmZiAtLWdpdCBhL2ZzL2dmczIvcmdycC5j
IGIvZnMvZ2ZzMi9yZ3JwLmMKPiBpbmRleCA4MDFhZDlmNGYyYmVmLi43ZjIwYWM5MTMzYmM2IDEw
MDY0NAo+IC0tLSBhL2ZzL2dmczIvcmdycC5jCj4gKysrIGIvZnMvZ2ZzMi9yZ3JwLmMKPiBAQCAt
MTQwNSw3ICsxNDA1LDcgQEAgaW50IGdmczJfZml0cmltKHN0cnVjdCBmaWxlICpmaWxwLCB2b2lk
IF9fdXNlciAqYXJncCkKPiAgCWlmICghdGVzdF9iaXQoU0RGX0pPVVJOQUxfTElWRSwgJnNkcC0+
c2RfZmxhZ3MpKQo+ICAJCXJldHVybiAtRVJPRlM7Cj4gIAo+IC0JaWYgKCFibGtfcXVldWVfZGlz
Y2FyZChxKSkKPiArCWlmICghYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKHNkcC0+c2RfdmZzLT5z
X2JkZXYpKQo+ICAJCXJldHVybiAtRU9QTk9UU1VQUDsKPiAgCj4gIAlpZiAoY29weV9mcm9tX3Vz
ZXIoJnIsIGFyZ3AsIHNpemVvZihyKSkpCj4gZGlmZiAtLWdpdCBhL2ZzL2piZDIvam91cm5hbC5j
IGIvZnMvamJkMi9qb3VybmFsLmMKPiBpbmRleCBmY2FjYWZhNDUxMGQxLi4xOWQyMjZjZDRmZjRk
IDEwMDY0NAo+IC0tLSBhL2ZzL2piZDIvam91cm5hbC5jCj4gKysrIGIvZnMvamJkMi9qb3VybmFs
LmMKPiBAQCAtMTc2Miw3ICsxNzYyLDYgQEAgc3RhdGljIGludCBfX2piZDJfam91cm5hbF9lcmFz
ZShqb3VybmFsX3QgKmpvdXJuYWwsIHVuc2lnbmVkIGludCBmbGFncykKPiAgCXVuc2lnbmVkIGxv
bmcgYmxvY2ssIGxvZ19vZmZzZXQ7IC8qIGxvZ2ljYWwgKi8KPiAgCXVuc2lnbmVkIGxvbmcgbG9u
ZyBwaHlzX2Jsb2NrLCBibG9ja19zdGFydCwgYmxvY2tfc3RvcDsgLyogcGh5c2ljYWwgKi8KPiAg
CWxvZmZfdCBieXRlX3N0YXJ0LCBieXRlX3N0b3AsIGJ5dGVfY291bnQ7Cj4gLQlzdHJ1Y3QgcmVx
dWVzdF9xdWV1ZSAqcSA9IGJkZXZfZ2V0X3F1ZXVlKGpvdXJuYWwtPmpfZGV2KTsKPiAgCj4gIAkv
KiBmbGFncyBtdXN0IGJlIHNldCB0byBlaXRoZXIgZGlzY2FyZCBvciB6ZXJvb3V0ICovCj4gIAlp
ZiAoKGZsYWdzICYgfkpCRDJfSk9VUk5BTF9GTFVTSF9WQUxJRCkgfHwgIWZsYWdzIHx8Cj4gQEAg
LTE3NzAsMTAgKzE3NjksOCBAQCBzdGF0aWMgaW50IF9famJkMl9qb3VybmFsX2VyYXNlKGpvdXJu
YWxfdCAqam91cm5hbCwgdW5zaWduZWQgaW50IGZsYWdzKQo+ICAJCQkoZmxhZ3MgJiBKQkQyX0pP
VVJOQUxfRkxVU0hfWkVST09VVCkpKQo+ICAJCXJldHVybiAtRUlOVkFMOwo+ICAKPiAtCWlmICgh
cSkKPiAtCQlyZXR1cm4gLUVOWElPOwo+IC0KPiAtCWlmICgoZmxhZ3MgJiBKQkQyX0pPVVJOQUxf
RkxVU0hfRElTQ0FSRCkgJiYgIWJsa19xdWV1ZV9kaXNjYXJkKHEpKQo+ICsJaWYgKChmbGFncyAm
IEpCRDJfSk9VUk5BTF9GTFVTSF9ESVNDQVJEKSAmJgo+ICsJICAgICFiZGV2X21heF9kaXNjYXJk
X3NlY3RvcnMoam91cm5hbC0+al9kZXYpKQo+ICAJCXJldHVybiAtRU9QTk9UU1VQUDsKPiAgCj4g
IAkvKgo+IGRpZmYgLS1naXQgYS9mcy9qZnMvaW9jdGwuYyBiL2ZzL2pmcy9pb2N0bC5jCj4gaW5k
ZXggMDNhODQ1YWI0ZjAwOS4uMzU3YWU2ZTVjMzZlYyAxMDA2NDQKPiAtLS0gYS9mcy9qZnMvaW9j
dGwuYwo+ICsrKyBiL2ZzL2pmcy9pb2N0bC5jCj4gQEAgLTExNyw3ICsxMTcsNyBAQCBsb25nIGpm
c19pb2N0bChzdHJ1Y3QgZmlsZSAqZmlscCwgdW5zaWduZWQgaW50IGNtZCwgdW5zaWduZWQgbG9u
ZyBhcmcpCj4gIAkJaWYgKCFjYXBhYmxlKENBUF9TWVNfQURNSU4pKQo+ICAJCQlyZXR1cm4gLUVQ
RVJNOwo+ICAKPiAtCQlpZiAoIWJsa19xdWV1ZV9kaXNjYXJkKHEpKSB7Cj4gKwkJaWYgKCFiZGV2
X21heF9kaXNjYXJkX3NlY3RvcnMoc2ItPnNfYmRldikpIHsKPiAgCQkJamZzX3dhcm4oIkZJVFJJ
TSBub3Qgc3VwcG9ydGVkIG9uIGRldmljZSIpOwo+ICAJCQlyZXR1cm4gLUVPUE5PVFNVUFA7Cj4g
IAkJfQo+IGRpZmYgLS1naXQgYS9mcy9qZnMvc3VwZXIuYyBiL2ZzL2pmcy9zdXBlci5jCj4gaW5k
ZXggZjFhMTNhNzRjZGRmMy4uODVkNGY0NGYyYWM0ZCAxMDA2NDQKPiAtLS0gYS9mcy9qZnMvc3Vw
ZXIuYwo+ICsrKyBiL2ZzL2pmcy9zdXBlci5jCj4gQEAgLTM3MiwxOSArMzcyLDE2IEBAIHN0YXRp
YyBpbnQgcGFyc2Vfb3B0aW9ucyhjaGFyICpvcHRpb25zLCBzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNi
LCBzNjQgKm5ld0xWU2l6ZSwKPiAgCQl9Cj4gIAo+ICAJCWNhc2UgT3B0X2Rpc2NhcmQ6Cj4gLQkJ
ewo+IC0JCQlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSA9IGJkZXZfZ2V0X3F1ZXVlKHNiLT5zX2Jk
ZXYpOwo+ICAJCQkvKiBpZiBzZXQgdG8gMSwgZXZlbiBjb3B5aW5nIGZpbGVzIHdpbGwgY2F1c2UK
PiAgCQkJICogdHJpbW1pbmcgOk8KPiAgCQkJICogLT4gdXNlciBoYXMgbW9yZSBjb250cm9sIG92
ZXIgdGhlIG9ubGluZSB0cmltbWluZwo+ICAJCQkgKi8KPiAgCQkJc2JpLT5taW5ibGtzX3RyaW0g
PSA2NDsKPiAtCQkJaWYgKGJsa19xdWV1ZV9kaXNjYXJkKHEpKQo+ICsJCQlpZiAoYmRldl9tYXhf
ZGlzY2FyZF9zZWN0b3JzKHNiLT5zX2JkZXYpKQo+ICAJCQkJKmZsYWcgfD0gSkZTX0RJU0NBUkQ7
Cj4gIAkJCWVsc2UKPiAgCQkJCXByX2VycigiSkZTOiBkaXNjYXJkIG9wdGlvbiBub3Qgc3VwcG9y
dGVkIG9uIGRldmljZVxuIik7Cj4gIAkJCWJyZWFrOwo+IC0JCX0KPiAgCj4gIAkJY2FzZSBPcHRf
bm9kaXNjYXJkOgo+ICAJCQkqZmxhZyAmPSB+SkZTX0RJU0NBUkQ7Cj4gQEAgLTM5MiwxMCArMzg5
LDkgQEAgc3RhdGljIGludCBwYXJzZV9vcHRpb25zKGNoYXIgKm9wdGlvbnMsIHN0cnVjdCBzdXBl
cl9ibG9jayAqc2IsIHM2NCAqbmV3TFZTaXplLAo+ICAKPiAgCQljYXNlIE9wdF9kaXNjYXJkX21p
bmJsazoKPiAgCQl7Cj4gLQkJCXN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxID0gYmRldl9nZXRfcXVl
dWUoc2ItPnNfYmRldik7Cj4gIAkJCWNoYXIgKm1pbmJsa3NfdHJpbSA9IGFyZ3NbMF0uZnJvbTsK
PiAgCQkJaW50IHJjOwo+IC0JCQlpZiAoYmxrX3F1ZXVlX2Rpc2NhcmQocSkpIHsKPiArCQkJaWYg
KGJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhzYi0+c19iZGV2KSkgewo+ICAJCQkJKmZsYWcgfD0g
SkZTX0RJU0NBUkQ7Cj4gIAkJCQlyYyA9IGtzdHJ0b3VpbnQobWluYmxrc190cmltLCAwLAo+ICAJ
CQkJCQkmc2JpLT5taW5ibGtzX3RyaW0pOwo+IGRpZmYgLS1naXQgYS9mcy9uaWxmczIvaW9jdGwu
YyBiL2ZzL25pbGZzMi9pb2N0bC5jCj4gaW5kZXggZmVjMTk0YTY2NmY0Yi4uNTJiNzNmNTU4ZmNi
MSAxMDA2NDQKPiAtLS0gYS9mcy9uaWxmczIvaW9jdGwuYwo+ICsrKyBiL2ZzL25pbGZzMi9pb2N0
bC5jCj4gQEAgLTEwNTksNyArMTA1OSw3IEBAIHN0YXRpYyBpbnQgbmlsZnNfaW9jdGxfdHJpbV9m
cyhzdHJ1Y3QgaW5vZGUgKmlub2RlLCB2b2lkIF9fdXNlciAqYXJncCkKPiAgCWlmICghY2FwYWJs
ZShDQVBfU1lTX0FETUlOKSkKPiAgCQlyZXR1cm4gLUVQRVJNOwo+ICAKPiAtCWlmICghYmxrX3F1
ZXVlX2Rpc2NhcmQocSkpCj4gKwlpZiAoIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhuaWxmcy0+
bnNfYmRldikpCj4gIAkJcmV0dXJuIC1FT1BOT1RTVVBQOwo+ICAKPiAgCWlmIChjb3B5X2Zyb21f
dXNlcigmcmFuZ2UsIGFyZ3AsIHNpemVvZihyYW5nZSkpKQo+IGRpZmYgLS1naXQgYS9mcy9udGZz
My9maWxlLmMgYi9mcy9udGZzMy9maWxlLmMKPiBpbmRleCA3ODdiNTNiOTg0ZWUxLi5lNzYzMjM2
MTY5MzMxIDEwMDY0NAo+IC0tLSBhL2ZzL250ZnMzL2ZpbGUuYwo+ICsrKyBiL2ZzL250ZnMzL2Zp
bGUuYwo+IEBAIC0yOCw3ICsyOCw3IEBAIHN0YXRpYyBpbnQgbnRmc19pb2N0bF9maXRyaW0oc3Ry
dWN0IG50ZnNfc2JfaW5mbyAqc2JpLCB1bnNpZ25lZCBsb25nIGFyZykKPiAgCWlmICghY2FwYWJs
ZShDQVBfU1lTX0FETUlOKSkKPiAgCQlyZXR1cm4gLUVQRVJNOwo+ICAKPiAtCWlmICghYmxrX3F1
ZXVlX2Rpc2NhcmQocSkpCj4gKwlpZiAoIWJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhzYmktPnNi
LT5zX2JkZXYpKQo+ICAJCXJldHVybiAtRU9QTk9UU1VQUDsKPiAgCj4gIAl1c2VyX3JhbmdlID0g
KHN0cnVjdCBmc3RyaW1fcmFuZ2UgX191c2VyICopYXJnOwo+IGRpZmYgLS1naXQgYS9mcy9udGZz
My9zdXBlci5jIGIvZnMvbnRmczMvc3VwZXIuYwo+IGluZGV4IGNkMzBlODFhYmJjZTAuLmM3MzQw
ODViY2NlNGEgMTAwNjQ0Cj4gLS0tIGEvZnMvbnRmczMvc3VwZXIuYwo+ICsrKyBiL2ZzL250ZnMz
L3N1cGVyLmMKPiBAQCAtOTEzLDcgKzkxMyw3IEBAIHN0YXRpYyBpbnQgbnRmc19maWxsX3N1cGVy
KHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0cnVjdCBmc19jb250ZXh0ICpmYykKPiAgCX0KPiAg
Cj4gIAlycSA9IGJkZXZfZ2V0X3F1ZXVlKGJkZXYpOwo+IC0JaWYgKGJsa19xdWV1ZV9kaXNjYXJk
KHJxKSAmJiBycS0+bGltaXRzLmRpc2NhcmRfZ3JhbnVsYXJpdHkpIHsKPiArCWlmIChiZGV2X21h
eF9kaXNjYXJkX3NlY3RvcnMoYmRldikgJiYgcnEtPmxpbWl0cy5kaXNjYXJkX2dyYW51bGFyaXR5
KSB7Cj4gIAkJc2JpLT5kaXNjYXJkX2dyYW51bGFyaXR5ID0gcnEtPmxpbWl0cy5kaXNjYXJkX2dy
YW51bGFyaXR5Owo+ICAJCXNiaS0+ZGlzY2FyZF9ncmFudWxhcml0eV9tYXNrX2ludiA9Cj4gIAkJ
CX4odTY0KShzYmktPmRpc2NhcmRfZ3JhbnVsYXJpdHkgLSAxKTsKPiBkaWZmIC0tZ2l0IGEvZnMv
b2NmczIvaW9jdGwuYyBiL2ZzL29jZnMyL2lvY3RsLmMKPiBpbmRleCBmNTk0NjFkODVkYTQ1Li45
Yjc4ZWYxMDNhZGE2IDEwMDY0NAo+IC0tLSBhL2ZzL29jZnMyL2lvY3RsLmMKPiArKysgYi9mcy9v
Y2ZzMi9pb2N0bC5jCj4gQEAgLTkxMCw3ICs5MTAsNyBAQCBsb25nIG9jZnMyX2lvY3RsKHN0cnVj
dCBmaWxlICpmaWxwLCB1bnNpZ25lZCBpbnQgY21kLCB1bnNpZ25lZCBsb25nIGFyZykKPiAgCQlp
ZiAoIWNhcGFibGUoQ0FQX1NZU19BRE1JTikpCj4gIAkJCXJldHVybiAtRVBFUk07Cj4gIAo+IC0J
CWlmICghYmxrX3F1ZXVlX2Rpc2NhcmQocSkpCj4gKwkJaWYgKCFiZGV2X21heF9kaXNjYXJkX3Nl
Y3RvcnMoc2ItPnNfYmRldikpCj4gIAkJCXJldHVybiAtRU9QTk9UU1VQUDsKPiAgCj4gIAkJaWYg
KGNvcHlfZnJvbV91c2VyKCZyYW5nZSwgYXJncCwgc2l6ZW9mKHJhbmdlKSkpCj4gZGlmZiAtLWdp
dCBhL2ZzL3hmcy94ZnNfZGlzY2FyZC5jIGIvZnMveGZzL3hmc19kaXNjYXJkLmMKPiBpbmRleCAw
MTkxZGU4Y2U5Y2VkLi5hNGU2NjA5ZDYxNmI3IDEwMDY0NAo+IC0tLSBhL2ZzL3hmcy94ZnNfZGlz
Y2FyZC5jCj4gKysrIGIvZnMveGZzL3hmc19kaXNjYXJkLmMKPiBAQCAtMTYyLDcgKzE2Miw3IEBA
IHhmc19pb2NfdHJpbSgKPiAgCj4gIAlpZiAoIWNhcGFibGUoQ0FQX1NZU19BRE1JTikpCj4gIAkJ
cmV0dXJuIC1FUEVSTTsKPiAtCWlmICghYmxrX3F1ZXVlX2Rpc2NhcmQocSkpCj4gKwlpZiAoIWJk
ZXZfbWF4X2Rpc2NhcmRfc2VjdG9ycyhtcC0+bV9kZGV2X3RhcmdwLT5idF9iZGV2KSkKPiAgCQly
ZXR1cm4gLUVPUE5PVFNVUFA7Cj4gIAo+ICAJLyoKPiBkaWZmIC0tZ2l0IGEvZnMveGZzL3hmc19z
dXBlci5jIGIvZnMveGZzL3hmc19zdXBlci5jCj4gaW5kZXggNTRiZTlkNjQwOTNlZC4uYTI3NmI4
MTExZjYzNiAxMDA2NDQKPiAtLS0gYS9mcy94ZnMveGZzX3N1cGVyLmMKPiArKysgYi9mcy94ZnMv
eGZzX3N1cGVyLmMKPiBAQCAtMTYwOCwxNCArMTYwOCwxMCBAQCB4ZnNfZnNfZmlsbF9zdXBlcigK
PiAgCQkJZ290byBvdXRfZmlsZXN0cmVhbV91bm1vdW50Owo+ICAJfQo+ICAKPiAtCWlmICh4ZnNf
aGFzX2Rpc2NhcmQobXApKSB7Cj4gLQkJc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2X2dl
dF9xdWV1ZShzYi0+c19iZGV2KTsKPiAtCj4gLQkJaWYgKCFibGtfcXVldWVfZGlzY2FyZChxKSkg
ewo+IC0JCQl4ZnNfd2FybihtcCwgIm1vdW50aW5nIHdpdGggXCJkaXNjYXJkXCIgb3B0aW9uLCBi
dXQgIgo+IC0JCQkJCSJ0aGUgZGV2aWNlIGRvZXMgbm90IHN1cHBvcnQgZGlzY2FyZCIpOwo+IC0J
CQltcC0+bV9mZWF0dXJlcyAmPSB+WEZTX0ZFQVRfRElTQ0FSRDsKPiAtCQl9Cj4gKwlpZiAoeGZz
X2hhc19kaXNjYXJkKG1wKSAmJiAhYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKHNiLT5zX2JkZXYp
KSB7Cj4gKwkJeGZzX3dhcm4obXAsCj4gKwkibW91bnRpbmcgd2l0aCBcImRpc2NhcmRcIiBvcHRp
b24sIGJ1dCB0aGUgZGV2aWNlIGRvZXMgbm90IHN1cHBvcnQgZGlzY2FyZCIpOwo+ICsJCW1wLT5t
X2ZlYXR1cmVzICY9IH5YRlNfRkVBVF9ESVNDQVJEOwo+ICAJfQo+ICAKPiAgCWlmICh4ZnNfaGFz
X3JlZmxpbmsobXApKSB7Cj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvYmxrZGV2LmggYi9p
bmNsdWRlL2xpbnV4L2Jsa2Rldi5oCj4gaW5kZXggMzRiMWNmZDA2NzQyMS4uY2UxNjI0N2QzYWZh
YiAxMDA2NDQKPiAtLS0gYS9pbmNsdWRlL2xpbnV4L2Jsa2Rldi5oCj4gKysrIGIvaW5jbHVkZS9s
aW51eC9ibGtkZXYuaAo+IEBAIC0xMjU0LDYgKzEyNTQsMTEgQEAgYmRldl96b25lX3dyaXRlX2dy
YW51bGFyaXR5KHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYpCj4gIGludCBiZGV2X2FsaWdubWVu
dF9vZmZzZXQoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldik7Cj4gIHVuc2lnbmVkIGludCBiZGV2
X2Rpc2NhcmRfYWxpZ25tZW50KHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYpOwo+ICAKPiArc3Rh
dGljIGlubGluZSB1bnNpZ25lZCBpbnQgYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKHN0cnVjdCBi
bG9ja19kZXZpY2UgKmJkZXYpCj4gK3sKPiArCXJldHVybiBiZGV2X2dldF9xdWV1ZShiZGV2KS0+
bGltaXRzLm1heF9kaXNjYXJkX3NlY3RvcnM7Cj4gK30KPiArCj4gIHN0YXRpYyBpbmxpbmUgdW5z
aWduZWQgaW50IGJkZXZfd3JpdGVfemVyb2VzX3NlY3RvcnMoc3RydWN0IGJsb2NrX2RldmljZSAq
YmRldikKPiAgewo+ICAJc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2X2dldF9xdWV1ZShi
ZGV2KTsKPiBkaWZmIC0tZ2l0IGEvbW0vc3dhcGZpbGUuYyBiL21tL3N3YXBmaWxlLmMKPiBpbmRl
eCA0MDY5ZjE3YTgyYzhlLi41ZDljZWRmOWU3Yjg0IDEwMDY0NAo+IC0tLSBhL21tL3N3YXBmaWxl
LmMKPiArKysgYi9tbS9zd2FwZmlsZS5jCj4gQEAgLTI5NTcsMjAgKzI5NTcsNiBAQCBzdGF0aWMg
aW50IHNldHVwX3N3YXBfbWFwX2FuZF9leHRlbnRzKHN0cnVjdCBzd2FwX2luZm9fc3RydWN0ICpw
LAo+ICAJcmV0dXJuIG5yX2V4dGVudHM7Cj4gIH0KPiAgCj4gLS8qCj4gLSAqIEhlbHBlciB0byBz
eXNfc3dhcG9uIGRldGVybWluaW5nIGlmIGEgZ2l2ZW4gc3dhcAo+IC0gKiBiYWNraW5nIGRldmlj
ZSBxdWV1ZSBzdXBwb3J0cyBESVNDQVJEIG9wZXJhdGlvbnMuCj4gLSAqLwo+IC1zdGF0aWMgYm9v
bCBzd2FwX2Rpc2NhcmRhYmxlKHN0cnVjdCBzd2FwX2luZm9fc3RydWN0ICpzaSkKPiAtewo+IC0J
c3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2X2dldF9xdWV1ZShzaS0+YmRldik7Cj4gLQo+
IC0JaWYgKCFibGtfcXVldWVfZGlzY2FyZChxKSkKPiAtCQlyZXR1cm4gZmFsc2U7Cj4gLQo+IC0J
cmV0dXJuIHRydWU7Cj4gLX0KPiAtCj4gIFNZU0NBTExfREVGSU5FMihzd2Fwb24sIGNvbnN0IGNo
YXIgX191c2VyICosIHNwZWNpYWxmaWxlLCBpbnQsIHN3YXBfZmxhZ3MpCj4gIHsKPiAgCXN0cnVj
dCBzd2FwX2luZm9fc3RydWN0ICpwOwo+IEBAIC0zMTMyLDcgKzMxMTgsOCBAQCBTWVNDQUxMX0RF
RklORTIoc3dhcG9uLCBjb25zdCBjaGFyIF9fdXNlciAqLCBzcGVjaWFsZmlsZSwgaW50LCBzd2Fw
X2ZsYWdzKQo+ICAJCQkJCSBzaXplb2YobG9uZyksCj4gIAkJCQkJIEdGUF9LRVJORUwpOwo+ICAK
PiAtCWlmIChwLT5iZGV2ICYmIChzd2FwX2ZsYWdzICYgU1dBUF9GTEFHX0RJU0NBUkQpICYmIHN3
YXBfZGlzY2FyZGFibGUocCkpIHsKPiArCWlmICgoc3dhcF9mbGFncyAmIFNXQVBfRkxBR19ESVND
QVJEKSAmJgo+ICsJICAgIHAtPmJkZXYgJiYgYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKHAtPmJk
ZXYpKSB7Cj4gIAkJLyoKPiAgCQkgKiBXaGVuIGRpc2NhcmQgaXMgZW5hYmxlZCBmb3Igc3dhcCB3
aXRoIG5vIHBhcnRpY3VsYXIKPiAgCQkgKiBwb2xpY3kgZmxhZ2dlZCwgd2Ugc2V0IGFsbCBzd2Fw
IGRpc2NhcmQgZmxhZ3MgaGVyZSBpbgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fXwpkcmJkLWRldiBtYWlsaW5nIGxpc3QKZHJiZC1kZXZAbGlzdHMubGluYml0
LmNvbQpodHRwczovL2xpc3RzLmxpbmJpdC5jb20vbWFpbG1hbi9saXN0aW5mby9kcmJkLWRldgo=
