Return-Path: <drbd-dev-bounces@lists.linbit.com>
X-Original-To: lists+drbd-dev@lfdr.de
Delivered-To: lists+drbd-dev@lfdr.de
Received: from mail19.linbit.com (mail19.linbit.com [159.69.154.96])
	by mail.lfdr.de (Postfix) with ESMTPS id 8F2D046FACE
	for <lists+drbd-dev@lfdr.de>; Fri, 10 Dec 2021 07:51:35 +0100 (CET)
Received: from mail19.linbit.com (localhost [127.0.0.1])
	by mail19.linbit.com (LINBIT Mail Daemon) with ESMTP id 5A273420950;
	Fri, 10 Dec 2021 07:51:34 +0100 (CET)
X-Original-To: drbd-dev@lists.linbit.com
Delivered-To: drbd-dev@lists.linbit.com
X-Greylist: delayed 339 seconds by postgrey-1.31 at mail19;
	Fri, 10 Dec 2021 07:51:32 CET
Received: from smtp-out1.suse.de (smtp-out1.suse.de [195.135.220.28])
	by mail19.linbit.com (LINBIT Mail Daemon) with ESMTP id 74DF54202E8
	for <drbd-dev@lists.linbit.com>; Fri, 10 Dec 2021 07:51:32 +0100 (CET)
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
	(using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
	key-exchange X25519 server-signature ECDSA (P-521) server-digest
	SHA512) (No client certificate requested)
	by smtp-out1.suse.de (Postfix) with ESMTPS id A927B210FE;
	Fri, 10 Dec 2021 06:45:52 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
	t=1639118752;
	h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
	mime-version:mime-version:content-type:content-type:
	content-transfer-encoding:content-transfer-encoding:
	in-reply-to:in-reply-to:references:references;
	bh=vzMyr3hZXMhFii0NdlyR51oUhrIHzizEfZxSIlIaIOo=;
	b=ZnQINEf8VIOOmSFIhi4UXAQy294MvueGBu8St0E2ulu1HaiMjazbTWvSCMi9SCdY8EpbDk
	FDnShXqF7YdV8pffpVKMGMey4i4wV+DtJweqM6EvHkt+WVjvLaoSOaazmgJ3IcpUV+n+Qq
	DPMX/I+h1n2SsccHkJFfDRJLktsSugc=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
	s=susede2_ed25519; t=1639118752;
	h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
	mime-version:mime-version:content-type:content-type:
	content-transfer-encoding:content-transfer-encoding:
	in-reply-to:in-reply-to:references:references;
	bh=vzMyr3hZXMhFii0NdlyR51oUhrIHzizEfZxSIlIaIOo=;
	b=JKBaGDNy/pjyYeUYFFebaEh987eZdLpxTPiX/4MxQ+smu5VTjkgzOyVO1d7HYu10YN0MZO
	qVJm9SyRMM6SXlBA==
Received: from imap2.suse-dmz.suse.de (imap2.suse-dmz.suse.de [192.168.254.74])
	(using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
	key-exchange X25519 server-signature ECDSA (P-521) server-digest
	SHA512) (No client certificate requested)
	by imap2.suse-dmz.suse.de (Postfix) with ESMTPS id 5E26913DD7;
	Fri, 10 Dec 2021 06:45:52 +0000 (UTC)
Received: from dovecot-director2.suse.de ([192.168.254.65])
	by imap2.suse-dmz.suse.de with ESMTPSA id 4l00FaD3smFDcwAAMHmgww
	(envelope-from <hare@suse.de>); Fri, 10 Dec 2021 06:45:52 +0000
To: Li Jinlin <lijinlin3@huawei.com>, song@kernel.org,
	philipp.reisner@linbit.com, lars.ellenberg@linbit.com, axboe@kernel.dk, 
	jack@suse.cz, ming.lei@redhat.com, tj@kernel.org, mcgrof@kernel.org,
	mcroce@microsoft.com
References: <20211210051707.2202646-1-lijinlin3@huawei.com>
	<20211210051707.2202646-2-lijinlin3@huawei.com>
From: Hannes Reinecke <hare@suse.de>
Message-ID: <e9b03c2a-b1f6-e083-3a2b-bf1478628f31@suse.de>
Date: Fri, 10 Dec 2021 07:45:52 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101
	Thunderbird/78.12.0
MIME-Version: 1.0
In-Reply-To: <20211210051707.2202646-2-lijinlin3@huawei.com>
Content-Language: en-US
Cc: linux-raid@vger.kernel.org, linux-block@vger.kernel.org,
	linfeilong@huawei.com, linux-kernel@vger.kernel.org,
	drbd-dev@lists.linbit.com
Subject: Re: [Drbd-dev] [PATCH v2 1/3] md: Fix undefined behaviour in
	is_mddev_idle
X-BeenThere: drbd-dev@lists.linbit.com
X-Mailman-Version: 2.1.11
Precedence: list
List-Id: "*Coordination* of development, patches,
	contributions -- *Questions* \(even to developers\) go to drbd-user,
	please." <drbd-dev.lists.linbit.com>
List-Unsubscribe: <https://lists.linbit.com/mailman/options/drbd-dev>,
	<mailto:drbd-dev-request@lists.linbit.com?subject=unsubscribe>
List-Archive: <http://lists.linbit.com/pipermail/drbd-dev>
List-Post: <mailto:drbd-dev@lists.linbit.com>
List-Help: <mailto:drbd-dev-request@lists.linbit.com?subject=help>
List-Subscribe: <https://lists.linbit.com/mailman/listinfo/drbd-dev>,
	<mailto:drbd-dev-request@lists.linbit.com?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Sender: drbd-dev-bounces@lists.linbit.com
Errors-To: drbd-dev-bounces@lists.linbit.com

T24gMTIvMTAvMjEgNjoxNyBBTSwgTGkgSmlubGluIHdyb3RlOgo+IFVCU0FOIHJlcG9ydHMgdGhp
cyBwcm9ibGVtOgo+IAo+IFsgNTk4NC4yODEzODVdIFVCU0FOOiBVbmRlZmluZWQgYmVoYXZpb3Vy
IGluIGRyaXZlcnMvbWQvbWQuYzo4MTc1OjE1Cj4gWyA1OTg0LjI4MTM5MF0gc2lnbmVkIGludGVn
ZXIgb3ZlcmZsb3c6Cj4gWyA1OTg0LjI4MTM5M10gLTIxNDc0ODMyOTEgLSAyMDcyMDMzMTUyIGNh
bm5vdCBiZSByZXByZXNlbnRlZCBpbiB0eXBlICdpbnQnCj4gWyA1OTg0LjI4MTQwMF0gQ1BVOiAy
NSBQSUQ6IDE4NTQgQ29tbTogbWQxMDFfcmVzeW5jIEtkdW1wOiBsb2FkZWQgTm90IHRhaW50ZWQg
NC4xOS45MAo+IFsgNTk4NC4yODE0MDRdIEhhcmR3YXJlIG5hbWU6IEh1YXdlaSBUYWlTaGFuIDIw
MCAoTW9kZWwgNTI4MCkvQkM4MkFNRERBCj4gWyA1OTg0LjI4MTQwNl0gQ2FsbCB0cmFjZToKPiBb
IDU5ODQuMjgxNDE1XSAgZHVtcF9iYWNrdHJhY2UrMHgwLzB4MzEwCj4gWyA1OTg0LjI4MTQxOF0g
IHNob3dfc3RhY2srMHgyOC8weDM4Cj4gWyA1OTg0LjI4MTQyNV0gIGR1bXBfc3RhY2srMHhlYy8w
eDE1Ywo+IFsgNTk4NC4yODE0MzBdICB1YnNhbl9lcGlsb2d1ZSsweDE4LzB4ODQKPiBbIDU5ODQu
MjgxNDM0XSAgaGFuZGxlX292ZXJmbG93KzB4MTRjLzB4MTljCj4gWyA1OTg0LjI4MTQzOV0gIF9f
dWJzYW5faGFuZGxlX3N1Yl9vdmVyZmxvdysweDM0LzB4NDQKPiBbIDU5ODQuMjgxNDQ1XSAgaXNf
bWRkZXZfaWRsZSsweDMzOC8weDNkOAo+IFsgNTk4NC4yODE0NDldICBtZF9kb19zeW5jKzB4MWJi
OC8weDFjZjgKPiBbIDU5ODQuMjgxNDUyXSAgbWRfdGhyZWFkKzB4MjIwLzB4Mjg4Cj4gWyA1OTg0
LjI4MTQ1N10gIGt0aHJlYWQrMHgxZDgvMHgxZTAKPiBbIDU5ODQuMjgxNDYxXSAgcmV0X2Zyb21f
Zm9yaysweDEwLzB4MTgKPiAKPiBXaGVuIHRoZSBzdGF0IGFhY3VtIG9mIHRoZSBkaXNrIGlzIGdy
ZWF0ZXIgdGhhbiBJTlRfTUFYLCBpdHMKPiB2YWx1ZSBiZWNvbWVzIG5lZ2F0aXZlIGFmdGVyIGNh
c3RpbmcgdG8gJ2ludCcsIHdoaWNoIG1heSBsZWFkCj4gdG8gb3ZlcmZsb3cgYWZ0ZXIgc3VidHJh
Y3RpbmcgYSBwb3NpdGl2ZSBudW1iZXIuIEluIHRoZSBzYW1lCj4gd2F5LCB3aGVuIHRoZSB2YWx1
ZSBvZiBzeW5jX2lvIGlzIGdyZWF0ZXIgdGhhbiBJTlRfTUFYLAo+IG92ZXJmbG93IG1heSBhbHNv
IG9jY3VyLiBUaGVzZSBzaXR1YXRpb25zIHdpbGwgbGVhZCB0bwo+IHVuZGVmaW5lZCBiZWhhdmlv
ci4KPiAKPiBPdGhlcndpc2UsIGlmIHRoZSBzdGF0IGFjY3VtIG9mIHRoZSBkaXNrIGlzIGNsb3Nl
IHRvIElOVF9NQVgKPiB3aGVuIGNyZWF0aW5nIHJhaWQgYXJyYXlzLCB0aGUgaW5pdGlhbCB2YWx1
ZSBvZiBsYXN0X2V2ZW50cwo+IHdvdWxkIGJlIHNldCBjbG9zZSB0byBJTlRfTUFYIHdoZW4gbWRk
ZXYgaW5pdGlhbGl6ZXMgSU8KPiBldmVudCBjb3VudGVycy4gJ2N1cnJfZXZlbnRzIC0gcmRldi0+
bGFzdF9ldmVudHMgPiA2NCcgd2lsbAo+IGFsd2F5cyBmYWxzZSBkdXJpbmcgc3luY2hyb25pemF0
aW9uLiBJZiBhbGwgdGhlIGRpc2tzIG9mIG1kZGV2Cj4gYXJlIGluIHRoaXMgY2FzZSwgaXNfbWRk
ZXZfaWRsZSgpIHdpbGwgYWx3YXlzIHJldHVybiAxLCB3aGljaAo+IG1heSBjYXVzZSBub24tc3lu
YyBJTyBpcyB2ZXJ5IHNsb3cuCj4gCj4gVG8gYWRkcmVzcyB0aGVzZSBwcm9ibGVtcywgbmVlZCB0
byB1c2UgNjRiaXQgc2lnbmVkIGludGVnZXIKPiB0eXBlIGZvciBzeW5jX2lvLCBsYXN0X2V2ZW50
cywgYW5kIGN1cnJfZXZlbnRzLgo+IAo+IEluIGFsbCB0aGUgZHJpdmVycyB0aGF0IGNvbWUgd2l0
aCB0aGUga2VybmVsLCB0aGUgc3luY19pbwo+IHZhcmlhYmxlIGluIHN0cnVjdCBnZW5kaXNrIGlz
IG9ubHkgdXNlZCBmb3IgdGhlIG1kIGRyaXZlcgo+IGN1cnJlbnRseS4gSXQgc2hvdWxkIGJlIG1v
cmUgc3VpdGFibGUgaW4gc3RydWN0IG1kX3JkZXYsIHNvCj4gYWRkIHRoZSBzeW5jX2lvIHZhcmlh
YmxlIGluIHN0cnVjdCBtZF9yZGV2LCBhbmQgdXNlIGl0IHRvCj4gcmVwbGFjZS4gV2UgbW9kaWZ5
IG1kX3N5bmNfYWNjdCgpIGFuZCBtZF9zeW5jX2FjY3RfYmlvKCkKPiB0byBmaXQgZm9yIHRoaXMg
Y2hhbmdlIGFzIHdlbGwuIG1kX3N5bmNfYWNjdF9iaW8oKSBuZWVkCj4gYWNjZXNzIHRvIHRoZSBy
ZGV2LCBzbyB3ZSBzZXQgYmlvLT5iaV9iZGV2IHRvIHJkZXYgYmVmb3JlCj4gY2FsbGluZyBpdCwg
YW5kIHJlc2V0IGJpby0+YmlfYmRldiB0byBiZGV2IGluIHRoaXMgZnVuY3Rpb24uCj4gClBsZWFz
ZSBtYWtlIHRoYXQgdHdvIHBhdGNoZXMsIG9uZSBmb3IgbW92aW5nIHN5bmNfaW8gYW5kIG9uZSBm
b3IKZml4aW5nIHRoZSB1bmRlZmluZWQgYmVoYXZpb3VyLgoKPiBTaWduZWQtb2ZmLWJ5OiBMaSBK
aW5saW4gPGxpamlubGluM0BodWF3ZWkuY29tPgo+IC0tLQo+ICAgZHJpdmVycy9tZC9tZC5jICAg
ICAgIHwgIDYgKysrLS0tCj4gICBkcml2ZXJzL21kL21kLmggICAgICAgfCAxMyArKysrKysrKyst
LS0tCj4gICBkcml2ZXJzL21kL3JhaWQxLmMgICAgfCAgNCArKy0tCj4gICBkcml2ZXJzL21kL3Jh
aWQxMC5jICAgfCAyNCArKysrKysrKysrKystLS0tLS0tLS0tLS0KPiAgIGRyaXZlcnMvbWQvcmFp
ZDUuYyAgICB8ICA0ICsrLS0KPiAgIGluY2x1ZGUvbGludXgvZ2VuaGQuaCB8ICAxIC0KPiAgIDYg
ZmlsZXMgY2hhbmdlZCwgMjggaW5zZXJ0aW9ucygrKSwgMjQgZGVsZXRpb25zKC0pCj4gCj4gZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvbWQvbWQuYyBiL2RyaXZlcnMvbWQvbWQuYwo+IGluZGV4IDUxMTFl
ZDk2Njk0Ny4uZjFiNzFhOTI4MDFlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvbWQvbWQuYwo+ICsr
KyBiL2RyaXZlcnMvbWQvbWQuYwo+IEBAIC04NDI5LDE0ICs4NDI5LDE0IEBAIHN0YXRpYyBpbnQg
aXNfbWRkZXZfaWRsZShzdHJ1Y3QgbWRkZXYgKm1kZGV2LCBpbnQgaW5pdCkKPiAgIHsKPiAgIAlz
dHJ1Y3QgbWRfcmRldiAqcmRldjsKPiAgIAlpbnQgaWRsZTsKPiAtCWludCBjdXJyX2V2ZW50czsK
PiArCXM2NCBjdXJyX2V2ZW50czsKPiAgIAo+ICAgCWlkbGUgPSAxOwo+ICAgCXJjdV9yZWFkX2xv
Y2soKTsKPiAgIAlyZGV2X2Zvcl9lYWNoX3JjdShyZGV2LCBtZGRldikgewo+ICAgCQlzdHJ1Y3Qg
Z2VuZGlzayAqZGlzayA9IHJkZXYtPmJkZXYtPmJkX2Rpc2s7Cj4gLQkJY3Vycl9ldmVudHMgPSAo
aW50KXBhcnRfc3RhdF9yZWFkX2FjY3VtKGRpc2stPnBhcnQwLCBzZWN0b3JzKSAtCj4gLQkJCSAg
ICAgIGF0b21pY19yZWFkKCZkaXNrLT5zeW5jX2lvKTsKPiArCQljdXJyX2V2ZW50cyA9IChzNjQp
cGFydF9zdGF0X3JlYWRfYWNjdW0oZGlzay0+cGFydDAsIHNlY3RvcnMpIC0KPiArCQkJICAgICAg
YXRvbWljNjRfcmVhZCgmcmRldi0+c3luY19pbyk7CgpTbyB5b3UgYXJlIHJlcGxhY2luZyBhICdz
aWduZWQgaW50ZWdlcicgKGllIDMyYml0KSBjYWxjdWxhdGlvbiB3aXRoIGEgCidzaWduZWQgNjQt
Yml0IGludGVnZXInIGNhbGN1bGF0aW9uLgpJRSB5b3UganVzdCBzaGlmdGVkIHRoZSBvdmVyZmxv
dyBmcm9tIElOVF9NQVggdG8gTE9OR19NQVgsIHdpdGhvdXQgCmFjdHVhbGx5IGZpeGluZyBpdCwg
b3I/Cgo+ICAgCQkvKiBzeW5jIElPIHdpbGwgY2F1c2Ugc3luY19pbyB0byBpbmNyZWFzZSBiZWZv
cmUgdGhlIGRpc2tfc3RhdHMKPiAgIAkJICogYXMgc3luY19pbyBpcyBjb3VudGVkIHdoZW4gYSBy
ZXF1ZXN0IHN0YXJ0cywgYW5kCj4gICAJCSAqIGRpc2tfc3RhdHMgaXMgY291bnRlZCB3aGVuIGl0
IGNvbXBsZXRlcy4KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZC9tZC5oIGIvZHJpdmVycy9tZC9t
ZC5oCj4gaW5kZXggNTNlYTdhNjk2MWRlLi41ODRlMzU3ZTA5NDAgMTAwNjQ0Cj4gLS0tIGEvZHJp
dmVycy9tZC9tZC5oCj4gKysrIGIvZHJpdmVycy9tZC9tZC5oCj4gQEAgLTUwLDcgKzUwLDcgQEAg
c3RydWN0IG1kX3JkZXYgewo+ICAgCj4gICAJc2VjdG9yX3Qgc2VjdG9yczsJCS8qIERldmljZSBz
aXplIChpbiA1MTJieXRlcyBzZWN0b3JzKSAqLwo+ICAgCXN0cnVjdCBtZGRldiAqbWRkZXY7CQkv
KiBSQUlEIGFycmF5IGlmIHJ1bm5pbmcgKi8KPiAtCWludCBsYXN0X2V2ZW50czsJCS8qIElPIGV2
ZW50IHRpbWVzdGFtcCAqLwo+ICsJczY0IGxhc3RfZXZlbnRzOwkJLyogSU8gZXZlbnQgdGltZXN0
YW1wICovCj4gICAKPiAgIAkvKgo+ICAgCSAqIElmIG1ldGFfYmRldiBpcyBub24tTlVMTCwgaXQg
bWVhbnMgdGhhdCBhIHNlcGFyYXRlIGRldmljZSBpcwo+IEBAIC0xMzgsNiArMTM4LDggQEAgc3Ry
dWN0IG1kX3JkZXYgewo+ICAgCQl1bnNpZ25lZCBpbnQgc2l6ZTsJLyogU2l6ZSBpbiBzZWN0b3Jz
IG9mIHRoZSBQUEwgc3BhY2UgKi8KPiAgIAkJc2VjdG9yX3Qgc2VjdG9yOwkvKiBGaXJzdCBzZWN0
b3Igb2YgdGhlIFBQTCBzcGFjZSAqLwo+ICAgCX0gcHBsOwo+ICsKPiArCWF0b21pYzY0X3Qgc3lu
Y19pbzsJCS8qIGNvdW50ZXIgb2Ygc3luYyBJTyAodW5pdCBzZWN0b3JzKSAqLwo+ICAgfTsKPiAg
IGVudW0gZmxhZ19iaXRzIHsKPiAgIAlGYXVsdHksCQkJLyogZGV2aWNlIGlzIGtub3duIHRvIGhh
dmUgYSBmYXVsdCAqLwo+IEBAIC01NDksMTQgKzU1MSwxNyBAQCBzdGF0aWMgaW5saW5lIGludCBt
ZGRldl90cnlsb2NrKHN0cnVjdCBtZGRldiAqbWRkZXYpCj4gICB9Cj4gICBleHRlcm4gdm9pZCBt
ZGRldl91bmxvY2soc3RydWN0IG1kZGV2ICptZGRldik7Cj4gICAKPiAtc3RhdGljIGlubGluZSB2
b2lkIG1kX3N5bmNfYWNjdChzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2LCB1bnNpZ25lZCBsb25n
IG5yX3NlY3RvcnMpCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCBtZF9zeW5jX2FjY3Qoc3RydWN0IG1k
X3JkZXYgKnJkZXYsIHVuc2lnbmVkIGxvbmcgbnJfc2VjdG9ycykKPiAgIHsKPiAtCWF0b21pY19h
ZGQobnJfc2VjdG9ycywgJmJkZXYtPmJkX2Rpc2stPnN5bmNfaW8pOwo+ICsJYXRvbWljNjRfYWRk
KG5yX3NlY3RvcnMsICZyZGV2LT5zeW5jX2lvKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIGlubGlu
ZSB2b2lkIG1kX3N5bmNfYWNjdF9iaW8oc3RydWN0IGJpbyAqYmlvLCB1bnNpZ25lZCBsb25nIG5y
X3NlY3RvcnMpCj4gICB7Cj4gLQltZF9zeW5jX2FjY3QoYmlvLT5iaV9iZGV2LCBucl9zZWN0b3Jz
KTsKPiArCXN0cnVjdCBtZF9yZGV2ICpyZGV2ID0gKHZvaWQgKiliaW8tPmJpX2JkZXY7CgpUaGF0
IGxvb2sgd2VpcmQuIGJpby0+YmlfYmRldiBzaG91bGQgYmUgYSAnc3RydWN0IGdlbmRpc2snLCBu
b3QgYSBNRCAKaW50ZXJuYWwgZGF0YSBzdHJ1Y3R1cmUuCgo+ICsKPiArCWJpb19zZXRfZGV2KGJp
bywgcmRldi0+YmRldik7Cj4gKwltZF9zeW5jX2FjY3QocmRldiwgbnJfc2VjdG9ycyk7Cj4gICB9
Cj4gICAKPiAgIHN0cnVjdCBtZF9wZXJzb25hbGl0eQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL21k
L3JhaWQxLmMgYi9kcml2ZXJzL21kL3JhaWQxLmMKPiBpbmRleCA3ZGM4MDI2Y2Y2ZWUuLjc0YzQy
ZGFiZTU3YyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL21kL3JhaWQxLmMKPiArKysgYi9kcml2ZXJz
L21kL3JhaWQxLmMKPiBAQCAtMjIzMiw3ICsyMjMyLDcgQEAgc3RhdGljIHZvaWQgc3luY19yZXF1
ZXN0X3dyaXRlKHN0cnVjdCBtZGRldiAqbWRkZXYsIHN0cnVjdCByMWJpbyAqcjFfYmlvKQo+ICAg
Cj4gICAJCXdiaW8tPmJpX2VuZF9pbyA9IGVuZF9zeW5jX3dyaXRlOwo+ICAgCQlhdG9taWNfaW5j
KCZyMV9iaW8tPnJlbWFpbmluZyk7Cj4gLQkJbWRfc3luY19hY2N0KGNvbmYtPm1pcnJvcnNbaV0u
cmRldi0+YmRldiwgYmlvX3NlY3RvcnMod2JpbykpOwo+ICsJCW1kX3N5bmNfYWNjdChjb25mLT5t
aXJyb3JzW2ldLnJkZXYsIGJpb19zZWN0b3JzKHdiaW8pKTsKPiAgIAo+ICAgCQlzdWJtaXRfYmlv
X25vYWNjdCh3YmlvKTsKPiAgIAl9Cj4gQEAgLTI3OTEsNyArMjc5MSw3IEBAIHN0YXRpYyBzZWN0
b3JfdCByYWlkMV9zeW5jX3JlcXVlc3Qoc3RydWN0IG1kZGV2ICptZGRldiwgc2VjdG9yX3Qgc2Vj
dG9yX25yLAo+ICAgCQlpZiAocmRldiAmJiBiaW8tPmJpX2VuZF9pbykgewo+ICAgCQkJYXRvbWlj
X2luYygmcmRldi0+bnJfcGVuZGluZyk7Cj4gICAJCQliaW8tPmJpX2l0ZXIuYmlfc2VjdG9yID0g
c2VjdG9yX25yICsgcmRldi0+ZGF0YV9vZmZzZXQ7Cj4gLQkJCWJpb19zZXRfZGV2KGJpbywgcmRl
di0+YmRldik7Cj4gKwkJCWJpby0+YmlfYmRldiA9ICh2b2lkICopcmRldjsKPiAgIAkJCWlmICh0
ZXN0X2JpdChGYWlsRmFzdCwgJnJkZXYtPmZsYWdzKSkKPiAgIAkJCQliaW8tPmJpX29wZiB8PSBN
RF9GQUlMRkFTVDsKPiAgIAkJfQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL21kL3JhaWQxMC5jIGIv
ZHJpdmVycy9tZC9yYWlkMTAuYwo+IGluZGV4IGRkZTk4ZjY1YmQwNC4uZmMxZTZjMDk5NmRlIDEw
MDY0NAo+IC0tLSBhL2RyaXZlcnMvbWQvcmFpZDEwLmMKPiArKysgYi9kcml2ZXJzL21kL3JhaWQx
MC5jCj4gQEAgLTI0MDcsNyArMjQwNyw3IEBAIHN0YXRpYyB2b2lkIHN5bmNfcmVxdWVzdF93cml0
ZShzdHJ1Y3QgbWRkZXYgKm1kZGV2LCBzdHJ1Y3QgcjEwYmlvICpyMTBfYmlvKQo+ICAgCj4gICAJ
CWF0b21pY19pbmMoJmNvbmYtPm1pcnJvcnNbZF0ucmRldi0+bnJfcGVuZGluZyk7Cj4gICAJCWF0
b21pY19pbmMoJnIxMF9iaW8tPnJlbWFpbmluZyk7Cj4gLQkJbWRfc3luY19hY2N0KGNvbmYtPm1p
cnJvcnNbZF0ucmRldi0+YmRldiwgYmlvX3NlY3RvcnModGJpbykpOwo+ICsJCW1kX3N5bmNfYWNj
dChjb25mLT5taXJyb3JzW2RdLnJkZXYsIGJpb19zZWN0b3JzKHRiaW8pKTsKPiAgIAo+ICAgCQlp
ZiAodGVzdF9iaXQoRmFpbEZhc3QsICZjb25mLT5taXJyb3JzW2RdLnJkZXYtPmZsYWdzKSkKPiAg
IAkJCXRiaW8tPmJpX29wZiB8PSBNRF9GQUlMRkFTVDsKPiBAQCAtMjQzMCw3ICsyNDMwLDcgQEAg
c3RhdGljIHZvaWQgc3luY19yZXF1ZXN0X3dyaXRlKHN0cnVjdCBtZGRldiAqbWRkZXYsIHN0cnVj
dCByMTBiaW8gKnIxMF9iaW8pCj4gICAJCQliaW9fY29weV9kYXRhKHRiaW8sIGZiaW8pOwo+ICAg
CQlkID0gcjEwX2Jpby0+ZGV2c1tpXS5kZXZudW07Cj4gICAJCWF0b21pY19pbmMoJnIxMF9iaW8t
PnJlbWFpbmluZyk7Cj4gLQkJbWRfc3luY19hY2N0KGNvbmYtPm1pcnJvcnNbZF0ucmVwbGFjZW1l
bnQtPmJkZXYsCj4gKwkJbWRfc3luY19hY2N0KGNvbmYtPm1pcnJvcnNbZF0ucmVwbGFjZW1lbnQs
Cj4gICAJCQkgICAgIGJpb19zZWN0b3JzKHRiaW8pKTsKPiAgIAkJc3VibWl0X2Jpb19ub2FjY3Qo
dGJpbyk7Cj4gICAJfQo+IEBAIC0yNTYyLDEyICsyNTYyLDEyIEBAIHN0YXRpYyB2b2lkIHJlY292
ZXJ5X3JlcXVlc3Rfd3JpdGUoc3RydWN0IG1kZGV2ICptZGRldiwgc3RydWN0IHIxMGJpbyAqcjEw
X2JpbykKPiAgIAkJd2JpbzIgPSBOVUxMOwo+ICAgCWlmICh3YmlvLT5iaV9lbmRfaW8pIHsKPiAg
IAkJYXRvbWljX2luYygmY29uZi0+bWlycm9yc1tkXS5yZGV2LT5ucl9wZW5kaW5nKTsKPiAtCQlt
ZF9zeW5jX2FjY3QoY29uZi0+bWlycm9yc1tkXS5yZGV2LT5iZGV2LCBiaW9fc2VjdG9ycyh3Ymlv
KSk7Cj4gKwkJbWRfc3luY19hY2N0KGNvbmYtPm1pcnJvcnNbZF0ucmRldiwgYmlvX3NlY3RvcnMo
d2JpbykpOwo+ICAgCQlzdWJtaXRfYmlvX25vYWNjdCh3YmlvKTsKPiAgIAl9Cj4gICAJaWYgKHdi
aW8yKSB7Cj4gICAJCWF0b21pY19pbmMoJmNvbmYtPm1pcnJvcnNbZF0ucmVwbGFjZW1lbnQtPm5y
X3BlbmRpbmcpOwo+IC0JCW1kX3N5bmNfYWNjdChjb25mLT5taXJyb3JzW2RdLnJlcGxhY2VtZW50
LT5iZGV2LAo+ICsJCW1kX3N5bmNfYWNjdChjb25mLT5taXJyb3JzW2RdLnJlcGxhY2VtZW50LAo+
ICAgCQkJICAgICBiaW9fc2VjdG9ycyh3YmlvMikpOwo+ICAgCQlzdWJtaXRfYmlvX25vYWNjdCh3
YmlvMik7Cj4gICAJfQo+IEBAIC0zNDg2LDcgKzM0ODYsNyBAQCBzdGF0aWMgc2VjdG9yX3QgcmFp
ZDEwX3N5bmNfcmVxdWVzdChzdHJ1Y3QgbWRkZXYgKm1kZGV2LCBzZWN0b3JfdCBzZWN0b3JfbnIs
Cj4gICAJCQkJZnJvbV9hZGRyID0gcjEwX2Jpby0+ZGV2c1tqXS5hZGRyOwo+ICAgCQkJCWJpby0+
YmlfaXRlci5iaV9zZWN0b3IgPSBmcm9tX2FkZHIgKwo+ICAgCQkJCQlyZGV2LT5kYXRhX29mZnNl
dDsKPiAtCQkJCWJpb19zZXRfZGV2KGJpbywgcmRldi0+YmRldik7Cj4gKwkJCQliaW8tPmJpX2Jk
ZXYgPSAodm9pZCAqKXJkZXY7Cj4gICAJCQkJYXRvbWljX2luYygmcmRldi0+bnJfcGVuZGluZyk7
Cj4gICAJCQkJLyogYW5kIHdlIHdyaXRlIHRvICdpJyAoaWYgbm90IGluX3N5bmMpICovCj4gICAK
PiBAQCAtMzUwOCw3ICszNTA4LDcgQEAgc3RhdGljIHNlY3Rvcl90IHJhaWQxMF9zeW5jX3JlcXVl
c3Qoc3RydWN0IG1kZGV2ICptZGRldiwgc2VjdG9yX3Qgc2VjdG9yX25yLAo+ICAgCQkJCQliaW9f
c2V0X29wX2F0dHJzKGJpbywgUkVRX09QX1dSSVRFLCAwKTsKPiAgIAkJCQkJYmlvLT5iaV9pdGVy
LmJpX3NlY3RvciA9IHRvX2FkZHIKPiAgIAkJCQkJCSsgbXJkZXYtPmRhdGFfb2Zmc2V0Owo+IC0J
CQkJCWJpb19zZXRfZGV2KGJpbywgbXJkZXYtPmJkZXYpOwo+ICsJCQkJCWJpby0+YmlfYmRldiA9
ICh2b2lkICopbXJkZXY7Cj4gICAJCQkJCWF0b21pY19pbmMoJnIxMF9iaW8tPnJlbWFpbmluZyk7
Cj4gICAJCQkJfSBlbHNlCj4gICAJCQkJCXIxMF9iaW8tPmRldnNbMV0uYmlvLT5iaV9lbmRfaW8g
PSBOVUxMOwo+IEBAIC0zNTI5LDcgKzM1MjksNyBAQCBzdGF0aWMgc2VjdG9yX3QgcmFpZDEwX3N5
bmNfcmVxdWVzdChzdHJ1Y3QgbWRkZXYgKm1kZGV2LCBzZWN0b3JfdCBzZWN0b3JfbnIsCj4gICAJ
CQkJYmlvX3NldF9vcF9hdHRycyhiaW8sIFJFUV9PUF9XUklURSwgMCk7Cj4gICAJCQkJYmlvLT5i
aV9pdGVyLmJpX3NlY3RvciA9IHRvX2FkZHIgKwo+ICAgCQkJCQltcmVwbGFjZS0+ZGF0YV9vZmZz
ZXQ7Cj4gLQkJCQliaW9fc2V0X2RldihiaW8sIG1yZXBsYWNlLT5iZGV2KTsKPiArCQkJCWJpby0+
YmlfYmRldiA9ICh2b2lkICopbXJlcGxhY2U7Cj4gICAJCQkJYXRvbWljX2luYygmcjEwX2Jpby0+
cmVtYWluaW5nKTsKPiAgIAkJCQlicmVhazsKPiAgIAkJCX0KPiBAQCAtMzY4NCw3ICszNjg0LDcg
QEAgc3RhdGljIHNlY3Rvcl90IHJhaWQxMF9zeW5jX3JlcXVlc3Qoc3RydWN0IG1kZGV2ICptZGRl
diwgc2VjdG9yX3Qgc2VjdG9yX25yLAo+ICAgCQkJaWYgKHRlc3RfYml0KEZhaWxGYXN0LCAmcmRl
di0+ZmxhZ3MpKQo+ICAgCQkJCWJpby0+Ymlfb3BmIHw9IE1EX0ZBSUxGQVNUOwo+ICAgCQkJYmlv
LT5iaV9pdGVyLmJpX3NlY3RvciA9IHNlY3RvciArIHJkZXYtPmRhdGFfb2Zmc2V0Owo+IC0JCQli
aW9fc2V0X2RldihiaW8sIHJkZXYtPmJkZXYpOwo+ICsJCQliaW8tPmJpX2JkZXYgPSAodm9pZCAq
KXJkZXY7Cj4gICAJCQljb3VudCsrOwo+ICAgCj4gICAJCQlyZGV2ID0gcmN1X2RlcmVmZXJlbmNl
KGNvbmYtPm1pcnJvcnNbZF0ucmVwbGFjZW1lbnQpOwo+IEBAIC0zNzA2LDcgKzM3MDYsNyBAQCBz
dGF0aWMgc2VjdG9yX3QgcmFpZDEwX3N5bmNfcmVxdWVzdChzdHJ1Y3QgbWRkZXYgKm1kZGV2LCBz
ZWN0b3JfdCBzZWN0b3JfbnIsCj4gICAJCQlpZiAodGVzdF9iaXQoRmFpbEZhc3QsICZyZGV2LT5m
bGFncykpCj4gICAJCQkJYmlvLT5iaV9vcGYgfD0gTURfRkFJTEZBU1Q7Cj4gICAJCQliaW8tPmJp
X2l0ZXIuYmlfc2VjdG9yID0gc2VjdG9yICsgcmRldi0+ZGF0YV9vZmZzZXQ7Cj4gLQkJCWJpb19z
ZXRfZGV2KGJpbywgcmRldi0+YmRldik7Cj4gKwkJCWJpby0+YmlfYmRldiA9ICh2b2lkICopcmRl
djsKPiAgIAkJCWNvdW50Kys7Cj4gICAJCQlyY3VfcmVhZF91bmxvY2soKTsKPiAgIAkJfQo+IEBA
IC00ODY1LDcgKzQ4NjUsNyBAQCBzdGF0aWMgc2VjdG9yX3QgcmVzaGFwZV9yZXF1ZXN0KHN0cnVj
dCBtZGRldiAqbWRkZXYsIHNlY3Rvcl90IHNlY3Rvcl9uciwKPiAgIAo+ICAgCXJlYWRfYmlvID0g
YmlvX2FsbG9jX2Jpb3NldChHRlBfS0VSTkVMLCBSRVNZTkNfUEFHRVMsICZtZGRldi0+YmlvX3Nl
dCk7Cj4gICAKPiAtCWJpb19zZXRfZGV2KHJlYWRfYmlvLCByZGV2LT5iZGV2KTsKPiArCXJlYWRf
YmlvLT5iaV9iZGV2ID0gKHZvaWQgKilyZGV2Owo+ICAgCXJlYWRfYmlvLT5iaV9pdGVyLmJpX3Nl
Y3RvciA9IChyMTBfYmlvLT5kZXZzW3IxMF9iaW8tPnJlYWRfc2xvdF0uYWRkcgo+ICAgCQkJICAg
ICAgICsgcmRldi0+ZGF0YV9vZmZzZXQpOwo+ICAgCXJlYWRfYmlvLT5iaV9wcml2YXRlID0gcjEw
X2JpbzsKPiBAQCAtNDkyMSw3ICs0OTIxLDcgQEAgc3RhdGljIHNlY3Rvcl90IHJlc2hhcGVfcmVx
dWVzdChzdHJ1Y3QgbWRkZXYgKm1kZGV2LCBzZWN0b3JfdCBzZWN0b3JfbnIsCj4gICAJCWlmICgh
cmRldjIgfHwgdGVzdF9iaXQoRmF1bHR5LCAmcmRldjItPmZsYWdzKSkKPiAgIAkJCWNvbnRpbnVl
Owo+ICAgCj4gLQkJYmlvX3NldF9kZXYoYiwgcmRldjItPmJkZXYpOwo+ICsJCWItPmJpX2JkZXYg
PSAodm9pZCAqKXJkZXYyOwo+ICAgCQliLT5iaV9pdGVyLmJpX3NlY3RvciA9IHIxMF9iaW8tPmRl
dnNbcy8yXS5hZGRyICsKPiAgIAkJCXJkZXYyLT5uZXdfZGF0YV9vZmZzZXQ7Cj4gICAJCWItPmJp
X2VuZF9pbyA9IGVuZF9yZXNoYXBlX3dyaXRlOwo+IEBAIC01MDE2LDcgKzUwMTYsNyBAQCBzdGF0
aWMgdm9pZCByZXNoYXBlX3JlcXVlc3Rfd3JpdGUoc3RydWN0IG1kZGV2ICptZGRldiwgc3RydWN0
IHIxMGJpbyAqcjEwX2JpbykKPiAgIAkJfQo+ICAgCQlhdG9taWNfaW5jKCZyZGV2LT5ucl9wZW5k
aW5nKTsKPiAgIAkJcmN1X3JlYWRfdW5sb2NrKCk7Cj4gLQkJbWRfc3luY19hY2N0X2JpbyhiLCBy
MTBfYmlvLT5zZWN0b3JzKTsKPiArCQltZF9zeW5jX2FjY3QocmRldiwgcjEwX2Jpby0+c2VjdG9y
cyk7Cj4gICAJCWF0b21pY19pbmMoJnIxMF9iaW8tPnJlbWFpbmluZyk7Cj4gICAJCWItPmJpX25l
eHQgPSBOVUxMOwo+ICAgCQlzdWJtaXRfYmlvX25vYWNjdChiKTsKPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy9tZC9yYWlkNS5jIGIvZHJpdmVycy9tZC9yYWlkNS5jCj4gaW5kZXggOWMxYTU4NzdjZjlm
Li5iOTMyMjgyZmY1MGEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9tZC9yYWlkNS5jCj4gKysrIGIv
ZHJpdmVycy9tZC9yYWlkNS5jCj4gQEAgLTExNjcsNyArMTE2Nyw3IEBAIHN0YXRpYyB2b2lkIG9w
c19ydW5faW8oc3RydWN0IHN0cmlwZV9oZWFkICpzaCwgc3RydWN0IHN0cmlwZV9oZWFkX3N0YXRl
ICpzKQo+ICAgCQlpZiAocmRldikgewo+ICAgCQkJaWYgKHMtPnN5bmNpbmcgfHwgcy0+ZXhwYW5k
aW5nIHx8IHMtPmV4cGFuZGVkCj4gICAJCQkgICAgfHwgcy0+cmVwbGFjaW5nKQo+IC0JCQkJbWRf
c3luY19hY2N0KHJkZXYtPmJkZXYsIFJBSUQ1X1NUUklQRV9TRUNUT1JTKGNvbmYpKTsKPiArCQkJ
CW1kX3N5bmNfYWNjdChyZGV2LCBSQUlENV9TVFJJUEVfU0VDVE9SUyhjb25mKSk7Cj4gICAKPiAg
IAkJCXNldF9iaXQoU1RSSVBFX0lPX1NUQVJURUQsICZzaC0+c3RhdGUpOwo+ICAgCj4gQEAgLTEy
MzQsNyArMTIzNCw3IEBAIHN0YXRpYyB2b2lkIG9wc19ydW5faW8oc3RydWN0IHN0cmlwZV9oZWFk
ICpzaCwgc3RydWN0IHN0cmlwZV9oZWFkX3N0YXRlICpzKQo+ICAgCQlpZiAocnJkZXYpIHsKPiAg
IAkJCWlmIChzLT5zeW5jaW5nIHx8IHMtPmV4cGFuZGluZyB8fCBzLT5leHBhbmRlZAo+ICAgCQkJ
ICAgIHx8IHMtPnJlcGxhY2luZykKPiAtCQkJCW1kX3N5bmNfYWNjdChycmRldi0+YmRldiwgUkFJ
RDVfU1RSSVBFX1NFQ1RPUlMoY29uZikpOwo+ICsJCQkJbWRfc3luY19hY2N0KHJyZGV2LCBSQUlE
NV9TVFJJUEVfU0VDVE9SUyhjb25mKSk7Cj4gICAKPiAgIAkJCXNldF9iaXQoU1RSSVBFX0lPX1NU
QVJURUQsICZzaC0+c3RhdGUpOwo+ICAgCj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvZ2Vu
aGQuaCBiL2luY2x1ZGUvbGludXgvZ2VuaGQuaAo+IGluZGV4IDc0YzQxMDI2MzExMy4uNmI4NDQ0
NDExMWU0IDEwMDY0NAo+IC0tLSBhL2luY2x1ZGUvbGludXgvZ2VuaGQuaAo+ICsrKyBiL2luY2x1
ZGUvbGludXgvZ2VuaGQuaAo+IEBAIC0xNTAsNyArMTUwLDYgQEAgc3RydWN0IGdlbmRpc2sgewo+
ICAgCXN0cnVjdCBsaXN0X2hlYWQgc2xhdmVfYmRldnM7Cj4gICAjZW5kaWYKPiAgIAlzdHJ1Y3Qg
dGltZXJfcmFuZF9zdGF0ZSAqcmFuZG9tOwo+IC0JYXRvbWljX3Qgc3luY19pbzsJCS8qIFJBSUQg
Ki8KPiAgIAlzdHJ1Y3QgZGlza19ldmVudHMgKmV2Owo+ICAgI2lmZGVmICBDT05GSUdfQkxLX0RF
Vl9JTlRFR1JJVFkKPiAgIAlzdHJ1Y3Qga29iamVjdCBpbnRlZ3JpdHlfa29iajsKPiAKCkNoZWVy
cywKCkhhbm5lcwotLSAKRHIuIEhhbm5lcyBSZWluZWNrZSAgICAgICAgICAgICAgICBLZXJuZWwg
U3RvcmFnZSBBcmNoaXRlY3QKaGFyZUBzdXNlLmRlICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgKzQ5IDkxMSA3NDA1MyA2ODgKU1VTRSBTb2Z0d2FyZSBTb2x1dGlvbnMgR21iSCwgTWF4ZmVs
ZHN0ci4gNSwgOTA0MDkgTsO8cm5iZXJnCkhSQiAzNjgwOSAoQUcgTsO8cm5iZXJnKSwgR2VzY2jD
pGZ0c2bDvGhyZXI6IEZlbGl4IEltZW5kw7ZyZmZlcgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpkcmJkLWRldiBtYWlsaW5nIGxpc3QKZHJiZC1kZXZAbGlz
dHMubGluYml0LmNvbQpodHRwczovL2xpc3RzLmxpbmJpdC5jb20vbWFpbG1hbi9saXN0aW5mby9k
cmJkLWRldgo=
