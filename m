Return-Path: <drbd-dev-bounces@lists.linbit.com>
X-Original-To: lists+drbd-dev@lfdr.de
Delivered-To: lists+drbd-dev@lfdr.de
Received: from mail19.linbit.com (mail19.linbit.com [159.69.154.96])
	by mail.lfdr.de (Postfix) with ESMTPS id C58746980F6
	for <lists+drbd-dev@lfdr.de>; Wed, 15 Feb 2023 17:34:10 +0100 (CET)
Received: from mail19.linbit.com (localhost [127.0.0.1])
	by mail19.linbit.com (LINBIT Mail Daemon) with ESMTP id AF303422149;
	Wed, 15 Feb 2023 17:34:10 +0100 (CET)
X-Original-To: drbd-dev@lists.linbit.com
Delivered-To: drbd-dev@lists.linbit.com
Received: from mail-wr1-f47.google.com (mail-wr1-f47.google.com
	[209.85.221.47])
	by mail19.linbit.com (LINBIT Mail Daemon) with ESMTP id EBAFE422092
	for <drbd-dev@lists.linbit.com>; Wed, 15 Feb 2023 17:32:11 +0100 (CET)
Received: by mail-wr1-f47.google.com with SMTP id y1so19778254wru.2
	for <drbd-dev@lists.linbit.com>; Wed, 15 Feb 2023 08:32:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=linbit-com.20210112.gappssmtp.com; s=20210112;
	h=content-transfer-encoding:mime-version:references:in-reply-to
	:message-id:date:subject:cc:to:from:from:to:cc:subject:date
	:message-id:reply-to;
	bh=MfuueqXo6KJuWiRPOt3VVKLrd7ni9o9ZWdxoAzKHmB8=;
	b=I7FdSZktpCfMsHvyrAcsUZA31ZVE0ukxsrMHIWqQlSYfCR6snWSyzljTLVLN3k8Hj4
	9qbQW+RR9ROr93PyYgwJVTefWCHjWFU87vohjYb5dCGWl3SN2cq/P5OWHL7gng58vfiu
	utbNz5VB/9aXgGqykJ2ORgP/oW+/eHSQmcvEr4yaPowg7N2FHN6QiA0Rkue8JDCj5qcm
	NVAff0/FDdf6l5+6amxy6vmirFx3kjRO0Hgf+yLiOr+lwICYAnc8KprcXt5CQgdSJ8Z+
	lKS9cHJplKDzhmQ6zbiMLlhjPWTpCYgLBpZwWCKlxyGfQzNntEO9z/+Xaneq+bFsDSmw
	Dl0g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=1e100.net; s=20210112;
	h=content-transfer-encoding:mime-version:references:in-reply-to
	:message-id:date:subject:cc:to:from:x-gm-message-state:from:to:cc
	:subject:date:message-id:reply-to;
	bh=MfuueqXo6KJuWiRPOt3VVKLrd7ni9o9ZWdxoAzKHmB8=;
	b=4ohoIV2iTDb1B29P2SrTFbWCulOGtHNPVp7045yMF8FF1w6/U4F1gIAjq8lTkcFoWN
	Jet7FhpgUeFmbncewElTuxcWwPLXfoLkjSXDPUrtHKqONmO6qZXXDCbea23DslAC4Ftk
	DE8wwy18c0E9Kn/9+LRGfXoQDmcnZ3QC5q/3sGNxYKBW6Eg/VGfX0qLQXCNoJ5Ri5D5+
	LoRbIufOGonjiTYaSNDa9ERep8AtZzBrBxBIdLHJegtxQbdwiZl8aMuqCx56qubG92Fr
	ok9T2Z7zB4DcFjt1AkHBM4f7koWNqORiypMaDw3Y+YNRmJ2CkCiLT/ARDbp6873p37un
	1fmw==
X-Gm-Message-State: AO0yUKX4Qk0vbOGzDHxdMS0EK36tfhGfE7I71X0PkEWKqk5xtjTlu8/G
	VZNJ8jGS+o/hwTFkufK9gMnSRnBO
X-Google-Smtp-Source: AK7set+vA/ojSvJlZkdnLh/rvLe+XnnfOFf2xCBVlkRhCuxNj+j0FheIwfvsrPeR14v305Tctbk22A==
X-Received: by 2002:a5d:58c7:0:b0:2bf:ae11:c40c with SMTP id
	o7-20020a5d58c7000000b002bfae11c40cmr2089175wrf.32.1676478731196;
	Wed, 15 Feb 2023 08:32:11 -0800 (PST)
Received: from localhost.localdomain (h082218028181.host.wavenet.at.
	[82.218.28.181]) by smtp.gmail.com with ESMTPSA id
	n4-20020a5d67c4000000b002c56287bd2csm4865055wrw.114.2023.02.15.08.32.10
	(version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
	Wed, 15 Feb 2023 08:32:10 -0800 (PST)
From: =?UTF-8?q?Christoph=20B=C3=B6hmwalder?=
	<christoph.boehmwalder@linbit.com>
To: Jens Axboe <axboe@kernel.dk>
Date: Wed, 15 Feb 2023 17:32:02 +0100
Message-Id: <20230215163204.2856631-6-christoph.boehmwalder@linbit.com>
X-Mailer: git-send-email 2.39.1
In-Reply-To: <20230215163204.2856631-1-christoph.boehmwalder@linbit.com>
References: <20230215163204.2856631-1-christoph.boehmwalder@linbit.com>
MIME-Version: 1.0
Cc: Philipp Reisner <philipp.reisner@linbit.com>, linux-kernel@vger.kernel.org,
	linux-block@vger.kernel.org, Lars Ellenberg <lars.ellenberg@linbit.com>,
	drbd-dev@lists.linbit.com
Subject: [Drbd-dev] [PATCH 5/7] drbd: pass a peer_device to more bitmap
	functions
X-BeenThere: drbd-dev@lists.linbit.com
X-Mailman-Version: 2.1.11
Precedence: list
List-Id: "*Coordination* of development, patches,
	contributions -- *Questions* \(even to developers\) go to drbd-user,
	please." <drbd-dev.lists.linbit.com>
List-Unsubscribe: <https://lists.linbit.com/mailman/options/drbd-dev>,
	<mailto:drbd-dev-request@lists.linbit.com?subject=unsubscribe>
List-Archive: <http://lists.linbit.com/pipermail/drbd-dev>
List-Post: <mailto:drbd-dev@lists.linbit.com>
List-Help: <mailto:drbd-dev-request@lists.linbit.com?subject=help>
List-Subscribe: <https://lists.linbit.com/mailman/listinfo/drbd-dev>,
	<mailto:drbd-dev-request@lists.linbit.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: drbd-dev-bounces@lists.linbit.com
Errors-To: drbd-dev-bounces@lists.linbit.com

U2lnbmVkLW9mZi1ieTogQ2hyaXN0b3BoIELDtmhtd2FsZGVyIDxjaHJpc3RvcGguYm9laG13YWxk
ZXJAbGluYml0LmNvbT4KLS0tCiBkcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9iaXRtYXAuYyAgIHwg
IDYgKysrKy0tCiBkcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9pbnQuaCAgICAgIHwgMTUgKysrKysr
KysrKy0tLS0tCiBkcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9tYWluLmMgICAgIHwgIDQgKystLQog
ZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfbmwuYyAgICAgICB8ICA1ICsrKy0tCiBkcml2ZXJzL2Js
b2NrL2RyYmQvZHJiZF9yZWNlaXZlci5jIHwgIDIgKy0KIGRyaXZlcnMvYmxvY2svZHJiZC9kcmJk
X3N0YXRlLmMgICAgfCAxMiArKysrKysrLS0tLS0KIGRyaXZlcnMvYmxvY2svZHJiZC9kcmJkX3dv
cmtlci5jICAgfCAgMyArKy0KIDcgZmlsZXMgY2hhbmdlZCwgMjkgaW5zZXJ0aW9ucygrKSwgMTgg
ZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfYml0bWFw
LmMgYi9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9iaXRtYXAuYwppbmRleCA3ZDhlM2IwMmExZGEu
LjZhYzhjNTRiNDRjNyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfYml0bWFw
LmMKKysrIGIvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfYml0bWFwLmMKQEAgLTEyNDEsNyArMTI0
MSw4IEBAIGludCBkcmJkX2JtX3dyaXRlKHN0cnVjdCBkcmJkX2RldmljZSAqZGV2aWNlLAogICoK
ICAqIFdpbGwgd3JpdGUgYWxsIHBhZ2VzLgogICovCi1pbnQgZHJiZF9ibV93cml0ZV9hbGwoc3Ry
dWN0IGRyYmRfZGV2aWNlICpkZXZpY2UpIF9fbXVzdF9ob2xkKGxvY2FsKQoraW50IGRyYmRfYm1f
d3JpdGVfYWxsKHN0cnVjdCBkcmJkX2RldmljZSAqZGV2aWNlLAorCQlzdHJ1Y3QgZHJiZF9wZWVy
X2RldmljZSAqcGVlcl9kZXZpY2UpIF9fbXVzdF9ob2xkKGxvY2FsKQogewogCXJldHVybiBibV9y
dyhkZXZpY2UsIEJNX0FJT19XUklURV9BTExfUEFHRVMsIDApOwogfQpAQCAtMTI2Nyw3ICsxMjY4
LDggQEAgaW50IGRyYmRfYm1fd3JpdGVfbGF6eShzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwg
dW5zaWduZWQgdXBwZXJfaWR4KSBfX211c3RfaG8KICAqIHZlcmlmeSBpcyBhYm9ydGVkIGR1ZSB0
byBhIGZhaWxlZCBwZWVyIGRpc2ssIHdoaWxlIGxvY2FsIElPIGNvbnRpbnVlcywgb3IKICAqIHBl
bmRpbmcgcmVzeW5jIGFja3MgYXJlIHN0aWxsIGJlaW5nIHByb2Nlc3NlZC4KICAqLwotaW50IGRy
YmRfYm1fd3JpdGVfY29weV9wYWdlcyhzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSkgX19tdXN0
X2hvbGQobG9jYWwpCitpbnQgZHJiZF9ibV93cml0ZV9jb3B5X3BhZ2VzKHN0cnVjdCBkcmJkX2Rl
dmljZSAqZGV2aWNlLAorCQlzdHJ1Y3QgZHJiZF9wZWVyX2RldmljZSAqcGVlcl9kZXZpY2UpIF9f
bXVzdF9ob2xkKGxvY2FsKQogewogCXJldHVybiBibV9ydyhkZXZpY2UsIEJNX0FJT19DT1BZX1BB
R0VTLCAwKTsKIH0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX2ludC5oIGIv
ZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfaW50LmgKaW5kZXggOGI0ZDA2ZTEwMzY1Li4zNDVlOTZj
ZWI0N2MgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX2ludC5oCisrKyBiL2Ry
aXZlcnMvYmxvY2svZHJiZC9kcmJkX2ludC5oCkBAIC02Niw2ICs2Niw3IEBAIGV4dGVybiBpbnQg
ZHJiZF9wcm9jX2RldGFpbHM7CiAKIHN0cnVjdCBkcmJkX2RldmljZTsKIHN0cnVjdCBkcmJkX2Nv
bm5lY3Rpb247CitzdHJ1Y3QgZHJiZF9wZWVyX2RldmljZTsKIAogLyogRGVmaW5lcyB0byBjb250
cm9sIGZhdWx0IGluc2VydGlvbiAqLwogZW51bSB7CkBAIC0xMDY4LDEzICsxMDY5LDE1IEBAIGV4
dGVybiB2b2lkIGRyYmRfbWRfbWFya19kaXJ0eShzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSk7
CiBleHRlcm4gdm9pZCBkcmJkX3F1ZXVlX2JpdG1hcF9pbyhzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRl
dmljZSwKIAkJCQkgaW50ICgqaW9fZm4pKHN0cnVjdCBkcmJkX2RldmljZSAqLCBzdHJ1Y3QgZHJi
ZF9wZWVyX2RldmljZSAqKSwKIAkJCQkgdm9pZCAoKmRvbmUpKHN0cnVjdCBkcmJkX2RldmljZSAq
LCBpbnQpLAotCQkJCSBjaGFyICp3aHksIGVudW0gYm1fZmxhZyBmbGFncyk7CisJCQkJIGNoYXIg
KndoeSwgZW51bSBibV9mbGFnIGZsYWdzLAorCQkJCSBzdHJ1Y3QgZHJiZF9wZWVyX2RldmljZSAq
cGVlcl9kZXZpY2UpOwogZXh0ZXJuIGludCBkcmJkX2JpdG1hcF9pbyhzdHJ1Y3QgZHJiZF9kZXZp
Y2UgKmRldmljZSwKIAkJaW50ICgqaW9fZm4pKHN0cnVjdCBkcmJkX2RldmljZSAqLCBzdHJ1Y3Qg
ZHJiZF9wZWVyX2RldmljZSAqKSwKLQkJY2hhciAqd2h5LCBlbnVtIGJtX2ZsYWcgZmxhZ3MpOwor
CQljaGFyICp3aHksIGVudW0gYm1fZmxhZyBmbGFncywgc3RydWN0IGRyYmRfcGVlcl9kZXZpY2Ug
Kik7CiBleHRlcm4gaW50IGRyYmRfYml0bWFwX2lvX2Zyb21fd29ya2VyKHN0cnVjdCBkcmJkX2Rl
dmljZSAqZGV2aWNlLAogCQlpbnQgKCppb19mbikoc3RydWN0IGRyYmRfZGV2aWNlICosIHN0cnVj
dCBkcmJkX3BlZXJfZGV2aWNlICopLAotCQljaGFyICp3aHksIGVudW0gYm1fZmxhZyBmbGFncyk7
CisJCWNoYXIgKndoeSwgZW51bSBibV9mbGFnIGZsYWdzLAorCQlzdHJ1Y3QgZHJiZF9wZWVyX2Rl
dmljZSAqcGVlcl9kZXZpY2UpOwogZXh0ZXJuIGludCBkcmJkX2JtaW9fc2V0X25fd3JpdGUoc3Ry
dWN0IGRyYmRfZGV2aWNlICpkZXZpY2UsCiAJCXN0cnVjdCBkcmJkX3BlZXJfZGV2aWNlICpwZWVy
X2RldmljZSkgX19tdXN0X2hvbGQobG9jYWwpOwogZXh0ZXJuIGludCBkcmJkX2JtaW9fY2xlYXJf
bl93cml0ZShzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwKQEAgLTEyOTUsOCArMTI5OCwxMCBA
QCBleHRlcm4gaW50ICBkcmJkX2JtX3dyaXRlKHN0cnVjdCBkcmJkX2RldmljZSAqZGV2aWNlLAog
ZXh0ZXJuIHZvaWQgZHJiZF9ibV9yZXNldF9hbF9oaW50cyhzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRl
dmljZSkgX19tdXN0X2hvbGQobG9jYWwpOwogZXh0ZXJuIGludCAgZHJiZF9ibV93cml0ZV9oaW50
ZWQoc3RydWN0IGRyYmRfZGV2aWNlICpkZXZpY2UpIF9fbXVzdF9ob2xkKGxvY2FsKTsKIGV4dGVy
biBpbnQgIGRyYmRfYm1fd3JpdGVfbGF6eShzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwgdW5z
aWduZWQgdXBwZXJfaWR4KSBfX211c3RfaG9sZChsb2NhbCk7Ci1leHRlcm4gaW50IGRyYmRfYm1f
d3JpdGVfYWxsKHN0cnVjdCBkcmJkX2RldmljZSAqZGV2aWNlKSBfX211c3RfaG9sZChsb2NhbCk7
Ci1leHRlcm4gaW50ICBkcmJkX2JtX3dyaXRlX2NvcHlfcGFnZXMoc3RydWN0IGRyYmRfZGV2aWNl
ICpkZXZpY2UpIF9fbXVzdF9ob2xkKGxvY2FsKTsKK2V4dGVybiBpbnQgZHJiZF9ibV93cml0ZV9h
bGwoc3RydWN0IGRyYmRfZGV2aWNlICpkZXZpY2UsCisJCXN0cnVjdCBkcmJkX3BlZXJfZGV2aWNl
ICpwZWVyX2RldmljZSkgX19tdXN0X2hvbGQobG9jYWwpOworZXh0ZXJuIGludCAgZHJiZF9ibV93
cml0ZV9jb3B5X3BhZ2VzKHN0cnVjdCBkcmJkX2RldmljZSAqZGV2aWNlLAorCQlzdHJ1Y3QgZHJi
ZF9wZWVyX2RldmljZSAqcGVlcl9kZXZpY2UpIF9fbXVzdF9ob2xkKGxvY2FsKTsKIGV4dGVybiBz
aXplX3QJICAgICBkcmJkX2JtX3dvcmRzKHN0cnVjdCBkcmJkX2RldmljZSAqZGV2aWNlKTsKIGV4
dGVybiB1bnNpZ25lZCBsb25nIGRyYmRfYm1fYml0cyhzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmlj
ZSk7CiBleHRlcm4gc2VjdG9yX3QgICAgICBkcmJkX2JtX2NhcGFjaXR5KHN0cnVjdCBkcmJkX2Rl
dmljZSAqZGV2aWNlKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX21haW4u
YyBiL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX21haW4uYwppbmRleCA2ZjI5NTVmMmRjYzkuLjY2
NDdmODRmMzg3OSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfbWFpbi5jCisr
KyBiL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX21haW4uYwpAQCAtMTE5OCw3ICsxMTk4LDcgQEAg
c3RhdGljIGludCBmaWxsX2JpdG1hcF9ybGVfYml0cyhzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmlj
ZSwKICAqIGNvZGUgdXBvbiBmYWlsdXJlLgogICovCiBzdGF0aWMgaW50Ci1zZW5kX2JpdG1hcF9y
bGVfb3JfcGxhaW4oc3RydWN0IGRyYmRfcGVlcl9kZXZpY2UgKmRldmljZSwgc3RydWN0IGJtX3hm
ZXJfY3R4ICpjKQorc2VuZF9iaXRtYXBfcmxlX29yX3BsYWluKHN0cnVjdCBkcmJkX3BlZXJfZGV2
aWNlICpwZWVyX2RldmljZSwgc3RydWN0IGJtX3hmZXJfY3R4ICpjKQogewogCXN0cnVjdCBkcmJk
X2RldmljZSAqZGV2aWNlID0gcGVlcl9kZXZpY2UtPmRldmljZTsKIAlzdHJ1Y3QgZHJiZF9zb2Nr
ZXQgKnNvY2sgPSAmcGVlcl9kZXZpY2UtPmNvbm5lY3Rpb24tPmRhdGE7CkBAIC0xMjY5LDcgKzEy
NjksNyBAQCBzdGF0aWMgaW50IF9kcmJkX3NlbmRfYml0bWFwKHN0cnVjdCBkcmJkX2RldmljZSAq
ZGV2aWNlLAogCQlpZiAoZHJiZF9tZF90ZXN0X2ZsYWcoZGV2aWNlLT5sZGV2LCBNREZfRlVMTF9T
WU5DKSkgewogCQkJZHJiZF9pbmZvKGRldmljZSwgIldyaXRpbmcgdGhlIHdob2xlIGJpdG1hcCwg
TURGX0Z1bGxTeW5jIHdhcyBzZXQuXG4iKTsKIAkJCWRyYmRfYm1fc2V0X2FsbChkZXZpY2UpOwot
CQkJaWYgKGRyYmRfYm1fd3JpdGUoZGV2aWNlKSkgeworCQkJaWYgKGRyYmRfYm1fd3JpdGUoZGV2
aWNlLCBwZWVyX2RldmljZSkpIHsKIAkJCQkvKiB3cml0ZV9ibSBkaWQgZmFpbCEgTGVhdmUgZnVs
bCBzeW5jIGZsYWcgc2V0IGluIE1ldGEgUF9EQVRBCiAJCQkJICogYnV0IG90aGVyd2lzZSBwcm9j
ZXNzIGFzIHBlciBub3JtYWwgLSBuZWVkIHRvIHRlbGwgb3RoZXIKIAkJCQkgKiBzaWRlIHRoYXQg
YSBmdWxsIHJlc3luYyBpcyByZXF1aXJlZCEgKi8KZGlmZiAtLWdpdCBhL2RyaXZlcnMvYmxvY2sv
ZHJiZC9kcmJkX25sLmMgYi9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9ubC5jCmluZGV4IDA3YTUy
YzVhMjk4OS4uODk2NzI5ODk2OGYzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJi
ZF9ubC5jCisrKyBiL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX25sLmMKQEAgLTMwMDcsMTEgKzMw
MDcsMTIgQEAgc3RhdGljIGludCBkcmJkX2FkbV9zaW1wbGVfcmVxdWVzdF9zdGF0ZShzdHJ1Y3Qg
c2tfYnVmZiAqc2tiLCBzdHJ1Y3QgZ2VubF9pbmZvICoKIAlyZXR1cm4gMDsKIH0KIAotc3RhdGlj
IGludCBkcmJkX2JtaW9fc2V0X3N1c3BfYWwoc3RydWN0IGRyYmRfZGV2aWNlICpkZXZpY2UpIF9f
bXVzdF9ob2xkKGxvY2FsKQorc3RhdGljIGludCBkcmJkX2JtaW9fc2V0X3N1c3BfYWwoc3RydWN0
IGRyYmRfZGV2aWNlICpkZXZpY2UsCisJCXN0cnVjdCBkcmJkX3BlZXJfZGV2aWNlICpwZWVyX2Rl
dmljZSkgX19tdXN0X2hvbGQobG9jYWwpCiB7CiAJaW50IHJ2OwogCi0JcnYgPSBkcmJkX2JtaW9f
c2V0X25fd3JpdGUoZGV2aWNlKTsKKwlydiA9IGRyYmRfYm1pb19zZXRfbl93cml0ZShkZXZpY2Us
IHBlZXJfZGV2aWNlKTsKIAlkcmJkX3N1c3BlbmRfYWwoZGV2aWNlKTsKIAlyZXR1cm4gcnY7CiB9
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9yZWNlaXZlci5jIGIvZHJpdmVy
cy9ibG9jay9kcmJkL2RyYmRfcmVjZWl2ZXIuYwppbmRleCA4NjA1YjUxNTRhN2UuLmUzNTI4ODBj
NzBiNSAxMDA2NDQKLS0tIGEvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfcmVjZWl2ZXIuYworKysg
Yi9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9yZWNlaXZlci5jCkBAIC00ODc4LDcgKzQ4NzgsNyBA
QCBzdGF0aWMgaW50IHJlY2VpdmVfYml0bWFwKHN0cnVjdCBkcmJkX2Nvbm5lY3Rpb24gKmNvbm5l
Y3Rpb24sIHN0cnVjdCBwYWNrZXRfaW5mbwogCWlmIChkZXZpY2UtPnN0YXRlLmNvbm4gPT0gQ19X
Rl9CSVRNQVBfVCkgewogCQllbnVtIGRyYmRfc3RhdGVfcnYgcnY7CiAKLQkJZXJyID0gZHJiZF9z
ZW5kX2JpdG1hcChkZXZpY2UpOworCQllcnIgPSBkcmJkX3NlbmRfYml0bWFwKGRldmljZSwgcGVl
cl9kZXZpY2UpOwogCQlpZiAoZXJyKQogCQkJZ290byBvdXQ7CiAJCS8qIE9taXQgQ1NfT1JERVJF
RCB3aXRoIHRoaXMgc3RhdGUgdHJhbnNpdGlvbiB0byBhdm9pZCBkZWFkbG9ja3MuICovCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9zdGF0ZS5jIGIvZHJpdmVycy9ibG9jay9k
cmJkL2RyYmRfc3RhdGUuYwppbmRleCAwYjMzNWRkZDZkMTIuLmM5MmRjNjA5M2IwYSAxMDA2NDQK
LS0tIGEvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfc3RhdGUuYworKysgYi9kcml2ZXJzL2Jsb2Nr
L2RyYmQvZHJiZF9zdGF0ZS5jCkBAIC0xODEwLDcgKzE4MTAsNyBAQCBzdGF0aWMgdm9pZCBhZnRl
cl9zdGF0ZV9jaChzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwgdW5pb24gZHJiZF9zdGF0ZSBv
cywKIAkgICAgZGV2aWNlLT5zdGF0ZS5jb25uID09IENfV0ZfQklUTUFQX1MpCiAJCWRyYmRfcXVl
dWVfYml0bWFwX2lvKGRldmljZSwgJmRyYmRfc2VuZF9iaXRtYXAsIE5VTEwsCiAJCQkJInNlbmRf
Yml0bWFwIChXRkJpdE1hcFMpIiwKLQkJCQlCTV9MT0NLRURfVEVTVF9BTExPV0VEKTsKKwkJCQlC
TV9MT0NLRURfVEVTVF9BTExPV0VELCBwZWVyX2RldmljZSk7CiAKIAkvKiBMb3N0IGNvbnRhY3Qg
dG8gcGVlcidzIGNvcHkgb2YgdGhlIGRhdGEgKi8KIAlpZiAobG9zdF9jb250YWN0X3RvX3BlZXJf
ZGF0YShvcy5wZHNrLCBucy5wZHNrKSkgewpAQCAtMTg0MCw3ICsxODQwLDcgQEAgc3RhdGljIHZv
aWQgYWZ0ZXJfc3RhdGVfY2goc3RydWN0IGRyYmRfZGV2aWNlICpkZXZpY2UsIHVuaW9uIGRyYmRf
c3RhdGUgb3MsCiAJCQkgKiBObyBoYXJtIGRvbmUgaWYgdGhlIGJpdG1hcCBzdGlsbCBjaGFuZ2Vz
LAogCQkJICogcmVkaXJ0aWVkIHBhZ2VzIHdpbGwgZm9sbG93IGxhdGVyLiAqLwogCQkJZHJiZF9i
aXRtYXBfaW9fZnJvbV93b3JrZXIoZGV2aWNlLCAmZHJiZF9ibV93cml0ZSwKLQkJCQkiZGVtb3Rl
IGRpc2tsZXNzIHBlZXIiLCBCTV9MT0NLRURfU0VUX0FMTE9XRUQpOworCQkJCSJkZW1vdGUgZGlz
a2xlc3MgcGVlciIsIEJNX0xPQ0tFRF9TRVRfQUxMT1dFRCwgcGVlcl9kZXZpY2UpOwogCQlwdXRf
bGRldihkZXZpY2UpOwogCX0KIApAQCAtMTg1Miw3ICsxODUyLDcgQEAgc3RhdGljIHZvaWQgYWZ0
ZXJfc3RhdGVfY2goc3RydWN0IGRyYmRfZGV2aWNlICpkZXZpY2UsIHVuaW9uIGRyYmRfc3RhdGUg
b3MsCiAJCS8qIE5vIGNoYW5nZXMgdG8gdGhlIGJpdG1hcCBleHBlY3RlZCB0aGlzIHRpbWUsIHNv
IGFzc2VydCB0aGF0LAogCQkgKiBldmVuIHRob3VnaCBubyBoYXJtIHdhcyBkb25lIGlmIGl0IGRp
ZCBjaGFuZ2UuICovCiAJCWRyYmRfYml0bWFwX2lvX2Zyb21fd29ya2VyKGRldmljZSwgJmRyYmRf
Ym1fd3JpdGUsCi0JCQkJImRlbW90ZSIsIEJNX0xPQ0tFRF9URVNUX0FMTE9XRUQpOworCQkJCSJk
ZW1vdGUiLCBCTV9MT0NLRURfVEVTVF9BTExPV0VELCBwZWVyX2RldmljZSk7CiAJCXB1dF9sZGV2
KGRldmljZSk7CiAJfQogCkBAIC0xODg5LDcgKzE4ODksOCBAQCBzdGF0aWMgdm9pZCBhZnRlcl9z
dGF0ZV9jaChzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwgdW5pb24gZHJiZF9zdGF0ZSBvcywK
IAkJLyogbm8gb3RoZXIgYml0bWFwIGNoYW5nZXMgZXhwZWN0ZWQgZHVyaW5nIHRoaXMgcGhhc2Ug
Ki8KIAkJZHJiZF9xdWV1ZV9iaXRtYXBfaW8oZGV2aWNlLAogCQkJJmRyYmRfYm1pb19zZXRfbl93
cml0ZSwgJmFid19zdGFydF9zeW5jLAotCQkJInNldF9uX3dyaXRlIGZyb20gU3RhcnRpbmdTeW5j
IiwgQk1fTE9DS0VEX1RFU1RfQUxMT1dFRCk7CisJCQkic2V0X25fd3JpdGUgZnJvbSBTdGFydGlu
Z1N5bmMiLCBCTV9MT0NLRURfVEVTVF9BTExPV0VELAorCQkJcGVlcl9kZXZpY2UpOwogCiAJLyog
Zmlyc3QgaGFsZiBvZiBsb2NhbCBJTyBlcnJvciwgZmFpbHVyZSB0byBhdHRhY2gsCiAJICogb3Ig
YWRtaW5pc3RyYXRpdmUgZGV0YWNoICovCkBAIC0yMDEyLDcgKzIwMTMsOCBAQCBzdGF0aWMgdm9p
ZCBhZnRlcl9zdGF0ZV9jaChzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwgdW5pb24gZHJiZF9z
dGF0ZSBvcywKIAlpZiAoKG9zLmNvbm4gPiBDX0NPTk5FQ1RFRCAmJiBvcy5jb25uIDwgQ19BSEVB
RCkgJiYKIAkgICAgKG5zLmNvbm4gPT0gQ19DT05ORUNURUQgfHwgbnMuY29ubiA+PSBDX0FIRUFE
KSAmJiBnZXRfbGRldihkZXZpY2UpKSB7CiAJCWRyYmRfcXVldWVfYml0bWFwX2lvKGRldmljZSwg
JmRyYmRfYm1fd3JpdGVfY29weV9wYWdlcywgTlVMTCwKLQkJCSJ3cml0ZSBmcm9tIHJlc3luY19m
aW5pc2hlZCIsIEJNX0xPQ0tFRF9DSEFOR0VfQUxMT1dFRCk7CisJCQkid3JpdGUgZnJvbSByZXN5
bmNfZmluaXNoZWQiLCBCTV9MT0NLRURfQ0hBTkdFX0FMTE9XRUQsCisJCQlwZWVyX2RldmljZSk7
CiAJCXB1dF9sZGV2KGRldmljZSk7CiAJfQogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2Jsb2NrL2Ry
YmQvZHJiZF93b3JrZXIuYyBiL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX3dvcmtlci5jCmluZGV4
IGY0NjczODA0MGQ2Yi4uNjhkNWJhNGFmMTdkIDEwMDY0NAotLS0gYS9kcml2ZXJzL2Jsb2NrL2Ry
YmQvZHJiZF93b3JrZXIuYworKysgYi9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF93b3JrZXIuYwpA
QCAtMTk0NSw2ICsxOTQ1LDcgQEAgc3RhdGljIHZvaWQgZHJiZF9sZGV2X2Rlc3Ryb3koc3RydWN0
IGRyYmRfZGV2aWNlICpkZXZpY2UpCiAKIHN0YXRpYyB2b2lkIGdvX2Rpc2tsZXNzKHN0cnVjdCBk
cmJkX2RldmljZSAqZGV2aWNlKQogeworCXN0cnVjdCBkcmJkX3BlZXJfZGV2aWNlICpwZWVyX2Rl
dmljZSA9IGZpcnN0X3BlZXJfZGV2aWNlKGRldmljZSk7CiAJRF9BU1NFUlQoZGV2aWNlLCBkZXZp
Y2UtPnN0YXRlLmRpc2sgPT0gRF9GQUlMRUQpOwogCS8qIHdlIGNhbm5vdCBhc3NlcnQgbG9jYWxf
Y250ID09IDAgaGVyZSwgYXMgZ2V0X2xkZXZfaWZfc3RhdGUgd2lsbAogCSAqIGluYy9kZWMgaXQg
ZnJlcXVlbnRseS4gT25jZSB3ZSBhcmUgRF9ESVNLTEVTUywgbm8gb25lIHdpbGwgdG91Y2gKQEAg
LTE5NzAsNyArMTk3MSw3IEBAIHN0YXRpYyB2b2lkIGdvX2Rpc2tsZXNzKHN0cnVjdCBkcmJkX2Rl
dmljZSAqZGV2aWNlKQogCQkgKiBBbnkgbW9kaWZpY2F0aW9ucyB3b3VsZCBub3QgYmUgZXhwZWN0
ZWQgYW55bW9yZSwgdGhvdWdoLgogCQkgKi8KIAkJaWYgKGRyYmRfYml0bWFwX2lvX2Zyb21fd29y
a2VyKGRldmljZSwgZHJiZF9ibV93cml0ZSwKLQkJCQkJImRldGFjaCIsIEJNX0xPQ0tFRF9URVNU
X0FMTE9XRUQpKSB7CisJCQkJCSJkZXRhY2giLCBCTV9MT0NLRURfVEVTVF9BTExPV0VELCBwZWVy
X2RldmljZSkpIHsKIAkJCWlmICh0ZXN0X2JpdChXQVNfUkVBRF9FUlJPUiwgJmRldmljZS0+Zmxh
Z3MpKSB7CiAJCQkJZHJiZF9tZF9zZXRfZmxhZyhkZXZpY2UsIE1ERl9GVUxMX1NZTkMpOwogCQkJ
CWRyYmRfbWRfc3luYyhkZXZpY2UpOwotLSAKMi4zOS4xCgpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpkcmJkLWRldiBtYWlsaW5nIGxpc3QKZHJiZC1kZXZA
bGlzdHMubGluYml0LmNvbQpodHRwczovL2xpc3RzLmxpbmJpdC5jb20vbWFpbG1hbi9saXN0aW5m
by9kcmJkLWRldgo=
