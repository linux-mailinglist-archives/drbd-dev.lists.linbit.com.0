Return-Path: <drbd-dev-bounces@lists.linbit.com>
X-Original-To: lists+drbd-dev@lfdr.de
Delivered-To: lists+drbd-dev@lfdr.de
Received: from mail19.linbit.com (mail19.linbit.com [159.69.154.96])
	by mail.lfdr.de (Postfix) with ESMTPS id 6090F4F5A1B
	for <lists+drbd-dev@lfdr.de>; Wed,  6 Apr 2022 11:40:46 +0200 (CEST)
Received: from mail19.linbit.com (localhost [127.0.0.1])
	by mail19.linbit.com (LINBIT Mail Daemon) with ESMTP id 397AE420FCB;
	Wed,  6 Apr 2022 11:40:45 +0200 (CEST)
X-Original-To: drbd-dev@lists.linbit.com
Delivered-To: drbd-dev@lists.linbit.com
Received: from mail-ej1-f44.google.com (mail-ej1-f44.google.com
	[209.85.218.44])
	by mail19.linbit.com (LINBIT Mail Daemon) with ESMTP id F2E4C420FC7
	for <drbd-dev@lists.linbit.com>; Wed,  6 Apr 2022 11:40:43 +0200 (CEST)
Received: by mail-ej1-f44.google.com with SMTP id bh17so3027543ejb.8
	for <drbd-dev@lists.linbit.com>; Wed, 06 Apr 2022 02:40:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=linbit-com.20210112.gappssmtp.com; s=20210112;
	h=message-id:date:mime-version:user-agent:subject:content-language:to
	:references:cc:from:in-reply-to:content-transfer-encoding;
	bh=evDbYp3ISmHxUG+t42sOerYloPYWi7ia8PmHSfVDZEY=;
	b=Y7/SGWkY0mtWIyO8NrqiHh+1fNx8ZyEl+mQTLQfpMxsx4gRPCguNTGJGQFVpA4a7fs
	FT2NV6vTQDtN3nq85t6UldY/lDxjS5I74HqbzblUViaJAoiFkSgR1eRBdc+UoOlheAt/
	5HKDzJBgH2mEWuE85QWxBAI9kaRTgfqDceJKaO59K+7S8ixCJI6fpkyGmyMPacGq6zmj
	mfrZRSswRahOalEidW/0JfFU4IBdAAIz6Vf2fB8n932LIBEFD9QG3hs6OAUa3mdOMoGp
	xJvCDUuX9fX53NgWGY5MFQcKIx3cEwISwcbhz4mGFGjfPM+WK+wxAF+vWowaYBS5HzlQ
	Gb0g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
	d=1e100.net; s=20210112;
	h=x-gm-message-state:message-id:date:mime-version:user-agent:subject
	:content-language:to:references:cc:from:in-reply-to
	:content-transfer-encoding;
	bh=evDbYp3ISmHxUG+t42sOerYloPYWi7ia8PmHSfVDZEY=;
	b=2FrWkNAzbaz5kLv64ihm3EXobJnyjJIC7VwA3+tWks1C7CGsNkRrP8hftrI5NMzrPO
	ufTpILFp2iX6RbGUsPq3MiGQPxpdQrfeVH0tNZ918FSG1xeY1quxy3N/mkbnQbwNLP9x
	dUBXkz1vMMrowzZk4TB+o0/Itc+uSqCpV7A2MoU4ITjylAofJKjtkyTKRpnBkj97aBAM
	rbV3+1oshv9RLUjjU7ekjKeubEtApq5DHvT5RnD5PD0ZjXkYfccuNqEmxxVRPHWvmJSv
	O3pvJQDkTPSDgwvDc311F3jj7YIYtiyPYIDjRMhAFXu5t/EqSJU2bFcchHyWL+zA7cma
	tkfA==
X-Gm-Message-State: AOAM532zo3Mjv7oq8wXiwPITOJYDFwovubcL7rsJnDjYz9kt80+3x+kU
	hQDZk9SWuGQu14ezslwK1lgVDb+JtjFCCFCv3CI=
X-Google-Smtp-Source: ABdhPJyj//GpIP64pHvOlReVieuHGNvJJUVMMqTCH+DoQGATaiwxZiDMOxRlyGCMFGJ/0ep/20UV7g==
X-Received: by 2002:a17:907:6d29:b0:6e7:8e51:cbad with SMTP id
	sa41-20020a1709076d2900b006e78e51cbadmr7359931ejc.514.1649238043270;
	Wed, 06 Apr 2022 02:40:43 -0700 (PDT)
Received: from [192.168.178.55] (85-127-190-169.dsl.dynamic.surfer.at.
	[85.127.190.169]) by smtp.gmail.com with ESMTPSA id
	22-20020a17090600d600b006dfbc46efabsm6382893eji.126.2022.04.06.02.40.42
	(version=TLS1_3 cipher=TLS_AES_128_GCM_SHA256 bits=128/128);
	Wed, 06 Apr 2022 02:40:42 -0700 (PDT)
Message-ID: <659212cb-14db-808d-7ed3-1524ed9d42f8@linbit.com>
Date: Wed, 6 Apr 2022 11:40:41 +0200
MIME-Version: 1.0
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101
	Thunderbird/91.7.0
Content-Language: en-US
To: Christoph Hellwig <hch@lst.de>
References: <20220406060516.409838-1-hch@lst.de>
	<20220406060516.409838-25-hch@lst.de>
From: =?UTF-8?Q?Christoph_B=c3=b6hmwalder?= <christoph.boehmwalder@linbit.com>
In-Reply-To: <20220406060516.409838-25-hch@lst.de>
Cc: linux-block@vger.kernel.org, Jens Axboe <axboe@kernel.dk>,
	drbd-dev@lists.linbit.com
Subject: Re: [Drbd-dev] [PATCH 24/27] block: add a bdev_discard_granularity
 helper
X-BeenThere: drbd-dev@lists.linbit.com
X-Mailman-Version: 2.1.11
Precedence: list
List-Id: "*Coordination* of development, patches,
	contributions -- *Questions* \(even to developers\) go to drbd-user,
	please." <drbd-dev.lists.linbit.com>
List-Unsubscribe: <https://lists.linbit.com/mailman/options/drbd-dev>,
	<mailto:drbd-dev-request@lists.linbit.com?subject=unsubscribe>
List-Archive: <http://lists.linbit.com/pipermail/drbd-dev>
List-Post: <mailto:drbd-dev@lists.linbit.com>
List-Help: <mailto:drbd-dev-request@lists.linbit.com?subject=help>
List-Subscribe: <https://lists.linbit.com/mailman/listinfo/drbd-dev>,
	<mailto:drbd-dev-request@lists.linbit.com?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Sender: drbd-dev-bounces@lists.linbit.com
Errors-To: drbd-dev-bounces@lists.linbit.com

QW0gMDYuMDQuMjIgdW0gMDg6MDUgc2NocmllYiBDaHJpc3RvcGggSGVsbHdpZzoKPiBBYnN0cmFj
dCBhd2F5IGltcGxlbWVudGF0aW9uIGRldGFpbHMgZnJvbSBmaWxlIHN5c3RlbXMgYnkgcHJvdmlk
aW5nIGEKPiBibG9ja19kZXZpY2UgYmFzZWQgaGVscGVyIHRvIHJldHJlaXZlIHRoZSBkaXNjYXJk
IGdyYW51bGFyaXR5Lgo+IAo+IFNpZ25lZC1vZmYtYnk6IENocmlzdG9waCBIZWxsd2lnIDxoY2hA
bHN0LmRlPgo+IC0tLQo+ICBibG9jay9ibGstbGliLmMgICAgICAgICAgICAgICAgICAgICB8ICA1
ICsrLS0tCj4gIGRyaXZlcnMvYmxvY2svZHJiZC9kcmJkX25sLmMgICAgICAgIHwgIDkgKysrKyst
LS0tCj4gIGRyaXZlcnMvYmxvY2svZHJiZC9kcmJkX3JlY2VpdmVyLmMgIHwgIDMgKy0tCgpGb3Ig
dGhlIERSQkQgcGFydDoKCkFja2VkLWJ5OiBDaHJpc3RvcGggQsO2aG13YWxkZXIgPGNocmlzdG9w
aC5ib2VobXdhbGRlckBsaW5iaXQuY29tPgoKPiAgZHJpdmVycy9ibG9jay9sb29wLmMgICAgICAg
ICAgICAgICAgfCAgMiArLQo+ICBkcml2ZXJzL3RhcmdldC90YXJnZXRfY29yZV9kZXZpY2UuYyB8
ICAzICstLQo+ICBmcy9idHJmcy9pb2N0bC5jICAgICAgICAgICAgICAgICAgICB8IDEyICsrKyst
LS0tLS0tLQo+ICBmcy9leGZhdC9maWxlLmMgICAgICAgICAgICAgICAgICAgICB8ICAzICstLQo+
ICBmcy9leHQ0L21iYWxsb2MuYyAgICAgICAgICAgICAgICAgICB8ICA2ICsrKy0tLQo+ICBmcy9m
MmZzL2ZpbGUuYyAgICAgICAgICAgICAgICAgICAgICB8ICAzICstLQo+ICBmcy9mYXQvZmlsZS5j
ICAgICAgICAgICAgICAgICAgICAgICB8ICAzICstLQo+ICBmcy9nZnMyL3JncnAuYyAgICAgICAg
ICAgICAgICAgICAgICB8ICA3ICsrKy0tLS0KPiAgZnMvamZzL2lvY3RsLmMgICAgICAgICAgICAg
ICAgICAgICAgfCAgMyArLS0KPiAgZnMvbmlsZnMyL2lvY3RsLmMgICAgICAgICAgICAgICAgICAg
fCAgNCArKy0tCj4gIGZzL250ZnMzL2ZpbGUuYyAgICAgICAgICAgICAgICAgICAgIHwgIDQgKyst
LQo+ICBmcy9udGZzMy9zdXBlci5jICAgICAgICAgICAgICAgICAgICB8ICA2ICsrLS0tLQo+ICBm
cy9vY2ZzMi9pb2N0bC5jICAgICAgICAgICAgICAgICAgICB8ICAzICstLQo+ICBmcy94ZnMveGZz
X2Rpc2NhcmQuYyAgICAgICAgICAgICAgICB8ICA0ICsrLS0KPiAgaW5jbHVkZS9saW51eC9ibGtk
ZXYuaCAgICAgICAgICAgICAgfCAgNSArKysrKwo+ICAxOCBmaWxlcyBjaGFuZ2VkLCAzOCBpbnNl
cnRpb25zKCspLCA0NyBkZWxldGlvbnMoLSkKPiAKPiBkaWZmIC0tZ2l0IGEvYmxvY2svYmxrLWxp
Yi5jIGIvYmxvY2svYmxrLWxpYi5jCj4gaW5kZXggOGI0YjY2ZDNhOWJmYy4uNDNhYTRkN2ZlODU5
ZiAxMDA2NDQKPiAtLS0gYS9ibG9jay9ibGstbGliLmMKPiArKysgYi9ibG9jay9ibGstbGliLmMK
PiBAQCAtMTIsOCArMTIsNyBAQAo+ICAKPiAgc3RhdGljIHNlY3Rvcl90IGJpb19kaXNjYXJkX2xp
bWl0KHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYsIHNlY3Rvcl90IHNlY3RvcikKPiAgewo+IC0J
dW5zaWduZWQgaW50IGRpc2NhcmRfZ3JhbnVsYXJpdHkgPQo+IC0JCWJkZXZfZ2V0X3F1ZXVlKGJk
ZXYpLT5saW1pdHMuZGlzY2FyZF9ncmFudWxhcml0eTsKPiArCXVuc2lnbmVkIGludCBkaXNjYXJk
X2dyYW51bGFyaXR5ID0gYmRldl9kaXNjYXJkX2dyYW51bGFyaXR5KGJkZXYpOwo+ICAJc2VjdG9y
X3QgZ3JhbnVsYXJpdHlfYWxpZ25lZF9zZWN0b3I7Cj4gIAo+ICAJaWYgKGJkZXZfaXNfcGFydGl0
aW9uKGJkZXYpKQo+IEBAIC01OSw3ICs1OCw3IEBAIGludCBfX2Jsa2Rldl9pc3N1ZV9kaXNjYXJk
KHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYsIHNlY3Rvcl90IHNlY3RvciwKPiAgCX0KPiAgCj4g
IAkvKiBJbiBjYXNlIHRoZSBkaXNjYXJkIGdyYW51bGFyaXR5IGlzbid0IHNldCBieSBidWdneSBk
ZXZpY2UgZHJpdmVyICovCj4gLQlpZiAoV0FSTl9PTl9PTkNFKCFxLT5saW1pdHMuZGlzY2FyZF9n
cmFudWxhcml0eSkpIHsKPiArCWlmIChXQVJOX09OX09OQ0UoIWJkZXZfZGlzY2FyZF9ncmFudWxh
cml0eShiZGV2KSkpIHsKPiAgCQljaGFyIGRldl9uYW1lW0JERVZOQU1FX1NJWkVdOwo+ICAKPiAg
CQliZGV2bmFtZShiZGV2LCBkZXZfbmFtZSk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvYmxvY2sv
ZHJiZC9kcmJkX25sLmMgYi9kcml2ZXJzL2Jsb2NrL2RyYmQvZHJiZF9ubC5jCj4gaW5kZXggOGUy
OGUwYThlNWU0MS4uOTRhYzM3Mzc3MjNhOCAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2Jsb2NrL2Ry
YmQvZHJiZF9ubC5jCj4gKysrIGIvZHJpdmVycy9ibG9jay9kcmJkL2RyYmRfbmwuYwo+IEBAIC0x
NDQwLDcgKzE0NDAsNiBAQCBzdGF0aWMgdm9pZCBzYW5pdGl6ZV9kaXNrX2NvbmYoc3RydWN0IGRy
YmRfZGV2aWNlICpkZXZpY2UsIHN0cnVjdCBkaXNrX2NvbmYgKmRpcwo+ICAJCQkgICAgICAgc3Ry
dWN0IGRyYmRfYmFja2luZ19kZXYgKm5iYykKPiAgewo+ICAJc3RydWN0IGJsb2NrX2RldmljZSAq
YmRldiA9IG5iYy0+YmFja2luZ19iZGV2Owo+IC0Jc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBi
ZGV2LT5iZF9kaXNrLT5xdWV1ZTsKPiAgCj4gIAlpZiAoZGlza19jb25mLT5hbF9leHRlbnRzIDwg
RFJCRF9BTF9FWFRFTlRTX01JTikKPiAgCQlkaXNrX2NvbmYtPmFsX2V4dGVudHMgPSBEUkJEX0FM
X0VYVEVOVFNfTUlOOwo+IEBAIC0xNDU3LDEyICsxNDU2LDE0IEBAIHN0YXRpYyB2b2lkIHNhbml0
aXplX2Rpc2tfY29uZihzdHJ1Y3QgZHJiZF9kZXZpY2UgKmRldmljZSwgc3RydWN0IGRpc2tfY29u
ZiAqZGlzCj4gIAlpZiAoZGlza19jb25mLT5yc19kaXNjYXJkX2dyYW51bGFyaXR5KSB7Cj4gIAkJ
aW50IG9yaWdfdmFsdWUgPSBkaXNrX2NvbmYtPnJzX2Rpc2NhcmRfZ3JhbnVsYXJpdHk7Cj4gIAkJ
c2VjdG9yX3QgZGlzY2FyZF9zaXplID0gYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKGJkZXYpIDw8
IDk7Cj4gKwkJdW5zaWduZWQgaW50IGRpc2NhcmRfZ3JhbnVsYXJpdHkgPSBiZGV2X2Rpc2NhcmRf
Z3JhbnVsYXJpdHkoYmRldik7Cj4gIAkJaW50IHJlbWFpbmRlcjsKPiAgCj4gLQkJaWYgKHEtPmxp
bWl0cy5kaXNjYXJkX2dyYW51bGFyaXR5ID4gZGlza19jb25mLT5yc19kaXNjYXJkX2dyYW51bGFy
aXR5KQo+IC0JCQlkaXNrX2NvbmYtPnJzX2Rpc2NhcmRfZ3JhbnVsYXJpdHkgPSBxLT5saW1pdHMu
ZGlzY2FyZF9ncmFudWxhcml0eTsKPiArCQlpZiAoZGlzY2FyZF9ncmFudWxhcml0eSA+IGRpc2tf
Y29uZi0+cnNfZGlzY2FyZF9ncmFudWxhcml0eSkKPiArCQkJZGlza19jb25mLT5yc19kaXNjYXJk
X2dyYW51bGFyaXR5ID0gZGlzY2FyZF9ncmFudWxhcml0eTsKPiAgCj4gLQkJcmVtYWluZGVyID0g
ZGlza19jb25mLT5yc19kaXNjYXJkX2dyYW51bGFyaXR5ICUgcS0+bGltaXRzLmRpc2NhcmRfZ3Jh
bnVsYXJpdHk7Cj4gKwkJcmVtYWluZGVyID0gZGlza19jb25mLT5yc19kaXNjYXJkX2dyYW51bGFy
aXR5ICUKPiArCQkJCWRpc2NhcmRfZ3JhbnVsYXJpdHk7Cj4gIAkJZGlza19jb25mLT5yc19kaXNj
YXJkX2dyYW51bGFyaXR5ICs9IHJlbWFpbmRlcjsKPiAgCj4gIAkJaWYgKGRpc2tfY29uZi0+cnNf
ZGlzY2FyZF9ncmFudWxhcml0eSA+IGRpc2NhcmRfc2l6ZSkKPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ibG9jay9kcmJkL2RyYmRfcmVjZWl2ZXIuYyBiL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX3Jl
Y2VpdmVyLmMKPiBpbmRleCA4YTRhNDdkYTU2ZmU5Li4yNzVjNTNjN2I2MjllIDEwMDY0NAo+IC0t
LSBhL2RyaXZlcnMvYmxvY2svZHJiZC9kcmJkX3JlY2VpdmVyLmMKPiArKysgYi9kcml2ZXJzL2Js
b2NrL2RyYmQvZHJiZF9yZWNlaXZlci5jCj4gQEAgLTE1MTEsNyArMTUxMSw2IEBAIHZvaWQgZHJi
ZF9idW1wX3dyaXRlX29yZGVyaW5nKHN0cnVjdCBkcmJkX3Jlc291cmNlICpyZXNvdXJjZSwgc3Ry
dWN0IGRyYmRfYmFja2luCj4gIGludCBkcmJkX2lzc3VlX2Rpc2NhcmRfb3JfemVyb19vdXQoc3Ry
dWN0IGRyYmRfZGV2aWNlICpkZXZpY2UsIHNlY3Rvcl90IHN0YXJ0LCB1bnNpZ25lZCBpbnQgbnJf
c2VjdG9ycywgaW50IGZsYWdzKQo+ICB7Cj4gIAlzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2ID0g
ZGV2aWNlLT5sZGV2LT5iYWNraW5nX2JkZXY7Cj4gLQlzdHJ1Y3QgcmVxdWVzdF9xdWV1ZSAqcSA9
IGJkZXZfZ2V0X3F1ZXVlKGJkZXYpOwo+ICAJc2VjdG9yX3QgdG1wLCBucjsKPiAgCXVuc2lnbmVk
IGludCBtYXhfZGlzY2FyZF9zZWN0b3JzLCBncmFudWxhcml0eTsKPiAgCWludCBhbGlnbm1lbnQ7
Cj4gQEAgLTE1MjEsNyArMTUyMCw3IEBAIGludCBkcmJkX2lzc3VlX2Rpc2NhcmRfb3JfemVyb19v
dXQoc3RydWN0IGRyYmRfZGV2aWNlICpkZXZpY2UsIHNlY3Rvcl90IHN0YXJ0LCB1Cj4gIAkJZ290
byB6ZXJvX291dDsKPiAgCj4gIAkvKiBaZXJvLXNlY3RvciAodW5rbm93bikgYW5kIG9uZS1zZWN0
b3IgZ3JhbnVsYXJpdGllcyBhcmUgdGhlIHNhbWUuICAqLwo+IC0JZ3JhbnVsYXJpdHkgPSBtYXgo
cS0+bGltaXRzLmRpc2NhcmRfZ3JhbnVsYXJpdHkgPj4gOSwgMVUpOwo+ICsJZ3JhbnVsYXJpdHkg
PSBtYXgoYmRldl9kaXNjYXJkX2dyYW51bGFyaXR5KGJkZXYpID4+IDksIDFVKTsKPiAgCWFsaWdu
bWVudCA9IChiZGV2X2Rpc2NhcmRfYWxpZ25tZW50KGJkZXYpID4+IDkpICUgZ3JhbnVsYXJpdHk7
Cj4gIAo+ICAJbWF4X2Rpc2NhcmRfc2VjdG9ycyA9IG1pbihiZGV2X21heF9kaXNjYXJkX3NlY3Rv
cnMoYmRldiksICgxVSA8PCAyMikpOwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2Jsb2NrL2xvb3Au
YyBiL2RyaXZlcnMvYmxvY2svbG9vcC5jCj4gaW5kZXggNGI5MTliNzUyMDVhNy4uZDU0OTk3OTVh
MWZlYyAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2Jsb2NrL2xvb3AuYwo+ICsrKyBiL2RyaXZlcnMv
YmxvY2svbG9vcC5jCj4gQEAgLTc1OSw3ICs3NTksNyBAQCBzdGF0aWMgdm9pZCBsb29wX2NvbmZp
Z19kaXNjYXJkKHN0cnVjdCBsb29wX2RldmljZSAqbG8pCj4gIAkJc3RydWN0IHJlcXVlc3RfcXVl
dWUgKmJhY2tpbmdxID0gYmRldl9nZXRfcXVldWUoSV9CREVWKGlub2RlKSk7Cj4gIAo+ICAJCW1h
eF9kaXNjYXJkX3NlY3RvcnMgPSBiYWNraW5ncS0+bGltaXRzLm1heF93cml0ZV96ZXJvZXNfc2Vj
dG9yczsKPiAtCQlncmFudWxhcml0eSA9IGJhY2tpbmdxLT5saW1pdHMuZGlzY2FyZF9ncmFudWxh
cml0eSA/Ogo+ICsJCWdyYW51bGFyaXR5ID0gYmRldl9kaXNjYXJkX2dyYW51bGFyaXR5KElfQkRF
Vihpbm9kZSkpID86Cj4gIAkJCXF1ZXVlX3BoeXNpY2FsX2Jsb2NrX3NpemUoYmFja2luZ3EpOwo+
ICAKPiAgCS8qCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdGFyZ2V0L3RhcmdldF9jb3JlX2Rldmlj
ZS5jIGIvZHJpdmVycy90YXJnZXQvdGFyZ2V0X2NvcmVfZGV2aWNlLmMKPiBpbmRleCA3ZDUxMGU0
MjMxNzEzLi5lZTkzZjBjY2E0MjI4IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvdGFyZ2V0L3Rhcmdl
dF9jb3JlX2RldmljZS5jCj4gKysrIGIvZHJpdmVycy90YXJnZXQvdGFyZ2V0X2NvcmVfZGV2aWNl
LmMKPiBAQCAtODM0LDcgKzgzNCw2IEBAIHN0cnVjdCBzZV9kZXZpY2UgKnRhcmdldF9hbGxvY19k
ZXZpY2Uoc3RydWN0IHNlX2hiYSAqaGJhLCBjb25zdCBjaGFyICpuYW1lKQo+ICBib29sIHRhcmdl
dF9jb25maWd1cmVfdW5tYXBfZnJvbV9xdWV1ZShzdHJ1Y3Qgc2VfZGV2X2F0dHJpYiAqYXR0cmli
LAo+ICAJCQkJICAgICAgIHN0cnVjdCBibG9ja19kZXZpY2UgKmJkZXYpCj4gIHsKPiAtCXN0cnVj
dCByZXF1ZXN0X3F1ZXVlICpxID0gYmRldl9nZXRfcXVldWUoYmRldik7Cj4gIAlpbnQgYmxvY2tf
c2l6ZSA9IGJkZXZfbG9naWNhbF9ibG9ja19zaXplKGJkZXYpOwo+ICAKPiAgCWlmICghYmRldl9t
YXhfZGlzY2FyZF9zZWN0b3JzKGJkZXYpKQo+IEBAIC04NDYsNyArODQ1LDcgQEAgYm9vbCB0YXJn
ZXRfY29uZmlndXJlX3VubWFwX2Zyb21fcXVldWUoc3RydWN0IHNlX2Rldl9hdHRyaWIgKmF0dHJp
YiwKPiAgCSAqIEN1cnJlbnRseSBoYXJkY29kZWQgdG8gMSBpbiBMaW51eC9TQ1NJIGNvZGUuLgo+
ICAJICovCj4gIAlhdHRyaWItPm1heF91bm1hcF9ibG9ja19kZXNjX2NvdW50ID0gMTsKPiAtCWF0
dHJpYi0+dW5tYXBfZ3JhbnVsYXJpdHkgPSBxLT5saW1pdHMuZGlzY2FyZF9ncmFudWxhcml0eSAv
IGJsb2NrX3NpemU7Cj4gKwlhdHRyaWItPnVubWFwX2dyYW51bGFyaXR5ID0gYmRldl9kaXNjYXJk
X2dyYW51bGFyaXR5KGJkZXYpIC8gYmxvY2tfc2l6ZTsKPiAgCWF0dHJpYi0+dW5tYXBfZ3JhbnVs
YXJpdHlfYWxpZ25tZW50ID0KPiAgCQliZGV2X2Rpc2NhcmRfYWxpZ25tZW50KGJkZXYpIC8gYmxv
Y2tfc2l6ZTsKPiAgCXJldHVybiB0cnVlOwo+IGRpZmYgLS1naXQgYS9mcy9idHJmcy9pb2N0bC5j
IGIvZnMvYnRyZnMvaW9jdGwuYwo+IGluZGV4IGZjNzk1Mzc1NWZkOGIuLmYxYTFlOTUxOTgwOGUg
MTAwNjQ0Cj4gLS0tIGEvZnMvYnRyZnMvaW9jdGwuYwo+ICsrKyBiL2ZzL2J0cmZzL2lvY3RsLmMK
PiBAQCAtNDY4LDcgKzQ2OCw2IEBAIHN0YXRpYyBub2lubGluZSBpbnQgYnRyZnNfaW9jdGxfZml0
cmltKHN0cnVjdCBidHJmc19mc19pbmZvICpmc19pbmZvLAo+ICAJCQkJCXZvaWQgX191c2VyICph
cmcpCj4gIHsKPiAgCXN0cnVjdCBidHJmc19kZXZpY2UgKmRldmljZTsKPiAtCXN0cnVjdCByZXF1
ZXN0X3F1ZXVlICpxOwo+ICAJc3RydWN0IGZzdHJpbV9yYW5nZSByYW5nZTsKPiAgCXU2NCBtaW5s
ZW4gPSBVTExPTkdfTUFYOwo+ICAJdTY0IG51bV9kZXZpY2VzID0gMDsKPiBAQCAtNDk4LDE0ICs0
OTcsMTEgQEAgc3RhdGljIG5vaW5saW5lIGludCBidHJmc19pb2N0bF9maXRyaW0oc3RydWN0IGJ0
cmZzX2ZzX2luZm8gKmZzX2luZm8sCj4gIAlyY3VfcmVhZF9sb2NrKCk7Cj4gIAlsaXN0X2Zvcl9l
YWNoX2VudHJ5X3JjdShkZXZpY2UsICZmc19pbmZvLT5mc19kZXZpY2VzLT5kZXZpY2VzLAo+ICAJ
CQkJZGV2X2xpc3QpIHsKPiAtCQlpZiAoIWRldmljZS0+YmRldikKPiArCQlpZiAoIWRldmljZS0+
YmRldiB8fCAhYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKGRldmljZS0+YmRldikpCj4gIAkJCWNv
bnRpbnVlOwo+IC0JCXEgPSBiZGV2X2dldF9xdWV1ZShkZXZpY2UtPmJkZXYpOwo+IC0JCWlmIChi
ZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoZGV2aWNlLT5iZGV2KSkgewo+IC0JCQludW1fZGV2aWNl
cysrOwo+IC0JCQltaW5sZW4gPSBtaW5fdCh1NjQsIHEtPmxpbWl0cy5kaXNjYXJkX2dyYW51bGFy
aXR5LAo+IC0JCQkJICAgICBtaW5sZW4pOwo+IC0JCX0KPiArCQludW1fZGV2aWNlcysrOwo+ICsJ
CW1pbmxlbiA9IG1pbl90KHU2NCwgYmRldl9kaXNjYXJkX2dyYW51bGFyaXR5KGRldmljZS0+YmRl
diksCj4gKwkJCQkgICAgbWlubGVuKTsKPiAgCX0KPiAgCXJjdV9yZWFkX3VubG9jaygpOwo+ICAK
PiBkaWZmIC0tZ2l0IGEvZnMvZXhmYXQvZmlsZS5jIGIvZnMvZXhmYXQvZmlsZS5jCj4gaW5kZXgg
NzY1ZTRmNjNkZDE4ZC4uMjBkNGU0N2Y1N2FiMiAxMDA2NDQKPiAtLS0gYS9mcy9leGZhdC9maWxl
LmMKPiArKysgYi9mcy9leGZhdC9maWxlLmMKPiBAQCAtMzUxLDcgKzM1MSw2IEBAIGludCBleGZh
dF9zZXRhdHRyKHN0cnVjdCB1c2VyX25hbWVzcGFjZSAqbW50X3VzZXJucywgc3RydWN0IGRlbnRy
eSAqZGVudHJ5LAo+ICAKPiAgc3RhdGljIGludCBleGZhdF9pb2N0bF9maXRyaW0oc3RydWN0IGlu
b2RlICppbm9kZSwgdW5zaWduZWQgbG9uZyBhcmcpCj4gIHsKPiAtCXN0cnVjdCByZXF1ZXN0X3F1
ZXVlICpxID0gYmRldl9nZXRfcXVldWUoaW5vZGUtPmlfc2ItPnNfYmRldik7Cj4gIAlzdHJ1Y3Qg
ZnN0cmltX3JhbmdlIHJhbmdlOwo+ICAJaW50IHJldCA9IDA7Cj4gIAo+IEBAIC0zNjUsNyArMzY0
LDcgQEAgc3RhdGljIGludCBleGZhdF9pb2N0bF9maXRyaW0oc3RydWN0IGlub2RlICppbm9kZSwg
dW5zaWduZWQgbG9uZyBhcmcpCj4gIAkJcmV0dXJuIC1FRkFVTFQ7Cj4gIAo+ICAJcmFuZ2UubWlu
bGVuID0gbWF4X3QodW5zaWduZWQgaW50LCByYW5nZS5taW5sZW4sCj4gLQkJCQlxLT5saW1pdHMu
ZGlzY2FyZF9ncmFudWxhcml0eSk7Cj4gKwkJCQliZGV2X2Rpc2NhcmRfZ3JhbnVsYXJpdHkoaW5v
ZGUtPmlfc2ItPnNfYmRldikpOwo+ICAKPiAgCXJldCA9IGV4ZmF0X3RyaW1fZnMoaW5vZGUsICZy
YW5nZSk7Cj4gIAlpZiAocmV0IDwgMCkKPiBkaWZmIC0tZ2l0IGEvZnMvZXh0NC9tYmFsbG9jLmMg
Yi9mcy9leHQ0L21iYWxsb2MuYwo+IGluZGV4IGMzNjY4Yzk3N2NkOTkuLjZkMTgyMDUzNmQ4OGQg
MTAwNjQ0Cj4gLS0tIGEvZnMvZXh0NC9tYmFsbG9jLmMKPiArKysgYi9mcy9leHQ0L21iYWxsb2Mu
Ywo+IEBAIC02NDU1LDcgKzY0NTUsNyBAQCBleHQ0X3RyaW1fYWxsX2ZyZWUoc3RydWN0IHN1cGVy
X2Jsb2NrICpzYiwgZXh0NF9ncm91cF90IGdyb3VwLAo+ICAgKi8KPiAgaW50IGV4dDRfdHJpbV9m
cyhzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1Y3QgZnN0cmltX3JhbmdlICpyYW5nZSkKPiAg
ewo+IC0Jc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2X2dldF9xdWV1ZShzYi0+c19iZGV2
KTsKPiArCXVuc2lnbmVkIGludCBkaXNjYXJkX2dyYW51bGFyaXR5ID0gYmRldl9kaXNjYXJkX2dy
YW51bGFyaXR5KHNiLT5zX2JkZXYpOwo+ICAJc3RydWN0IGV4dDRfZ3JvdXBfaW5mbyAqZ3JwOwo+
ICAJZXh0NF9ncm91cF90IGdyb3VwLCBmaXJzdF9ncm91cCwgbGFzdF9ncm91cDsKPiAgCWV4dDRf
Z3JwYmxrX3QgY250ID0gMCwgZmlyc3RfY2x1c3RlciwgbGFzdF9jbHVzdGVyOwo+IEBAIC02NDc1
LDkgKzY0NzUsOSBAQCBpbnQgZXh0NF90cmltX2ZzKHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIHN0
cnVjdCBmc3RyaW1fcmFuZ2UgKnJhbmdlKQo+ICAJICAgIHJhbmdlLT5sZW4gPCBzYi0+c19ibG9j
a3NpemUpCj4gIAkJcmV0dXJuIC1FSU5WQUw7Cj4gIAkvKiBObyBwb2ludCB0byB0cnkgdG8gdHJp
bSBsZXNzIHRoYW4gZGlzY2FyZCBncmFudWxhcml0eSAqLwo+IC0JaWYgKHJhbmdlLT5taW5sZW4g
PCBxLT5saW1pdHMuZGlzY2FyZF9ncmFudWxhcml0eSkgewo+ICsJaWYgKHJhbmdlLT5taW5sZW4g
PCBkaXNjYXJkX2dyYW51bGFyaXR5KSB7Cj4gIAkJbWlubGVuID0gRVhUNF9OVU1fQjJDKEVYVDRf
U0Ioc2IpLAo+IC0JCQlxLT5saW1pdHMuZGlzY2FyZF9ncmFudWxhcml0eSA+PiBzYi0+c19ibG9j
a3NpemVfYml0cyk7Cj4gKwkJCQlkaXNjYXJkX2dyYW51bGFyaXR5ID4+IHNiLT5zX2Jsb2Nrc2l6
ZV9iaXRzKTsKPiAgCQlpZiAobWlubGVuID4gRVhUNF9DTFVTVEVSU19QRVJfR1JPVVAoc2IpKQo+
ICAJCQlnb3RvIG91dDsKPiAgCX0KPiBkaWZmIC0tZ2l0IGEvZnMvZjJmcy9maWxlLmMgYi9mcy9m
MmZzL2ZpbGUuYwo+IGluZGV4IDViODlhZjBmMjdmMDUuLjgwNTNkOTlmMzkyMGIgMTAwNjQ0Cj4g
LS0tIGEvZnMvZjJmcy9maWxlLmMKPiArKysgYi9mcy9mMmZzL2ZpbGUuYwo+IEBAIC0yMjg1LDcg
KzIyODUsNiBAQCBzdGF0aWMgaW50IGYyZnNfaW9jX2ZpdHJpbShzdHJ1Y3QgZmlsZSAqZmlscCwg
dW5zaWduZWQgbG9uZyBhcmcpCj4gIHsKPiAgCXN0cnVjdCBpbm9kZSAqaW5vZGUgPSBmaWxlX2lu
b2RlKGZpbHApOwo+ICAJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGlub2RlLT5pX3NiOwo+IC0J
c3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2X2dldF9xdWV1ZShzYi0+c19iZGV2KTsKPiAg
CXN0cnVjdCBmc3RyaW1fcmFuZ2UgcmFuZ2U7Cj4gIAlpbnQgcmV0Owo+ICAKPiBAQCAtMjMwNCw3
ICsyMzAzLDcgQEAgc3RhdGljIGludCBmMmZzX2lvY19maXRyaW0oc3RydWN0IGZpbGUgKmZpbHAs
IHVuc2lnbmVkIGxvbmcgYXJnKQo+ICAJCXJldHVybiByZXQ7Cj4gIAo+ICAJcmFuZ2UubWlubGVu
ID0gbWF4KCh1bnNpZ25lZCBpbnQpcmFuZ2UubWlubGVuLAo+IC0JCQkJcS0+bGltaXRzLmRpc2Nh
cmRfZ3JhbnVsYXJpdHkpOwo+ICsJCQkgICBiZGV2X2Rpc2NhcmRfZ3JhbnVsYXJpdHkoc2ItPnNf
YmRldikpOwo+ICAJcmV0ID0gZjJmc190cmltX2ZzKEYyRlNfU0Ioc2IpLCAmcmFuZ2UpOwo+ICAJ
bW50X2Ryb3Bfd3JpdGVfZmlsZShmaWxwKTsKPiAgCWlmIChyZXQgPCAwKQo+IGRpZmYgLS1naXQg
YS9mcy9mYXQvZmlsZS5jIGIvZnMvZmF0L2ZpbGUuYwo+IGluZGV4IGU0YzdkMTBlODAxMjkuLmJm
OTFmOTc3ZGViZWEgMTAwNjQ0Cj4gLS0tIGEvZnMvZmF0L2ZpbGUuYwo+ICsrKyBiL2ZzL2ZhdC9m
aWxlLmMKPiBAQCAtMTI3LDcgKzEyNyw2IEBAIHN0YXRpYyBpbnQgZmF0X2lvY3RsX2ZpdHJpbShz
dHJ1Y3QgaW5vZGUgKmlub2RlLCB1bnNpZ25lZCBsb25nIGFyZykKPiAgCXN0cnVjdCBzdXBlcl9i
bG9jayAqc2IgPSBpbm9kZS0+aV9zYjsKPiAgCXN0cnVjdCBmc3RyaW1fcmFuZ2UgX191c2VyICp1
c2VyX3JhbmdlOwo+ICAJc3RydWN0IGZzdHJpbV9yYW5nZSByYW5nZTsKPiAtCXN0cnVjdCByZXF1
ZXN0X3F1ZXVlICpxID0gYmRldl9nZXRfcXVldWUoc2ItPnNfYmRldik7Cj4gIAlpbnQgZXJyOwo+
ICAKPiAgCWlmICghY2FwYWJsZShDQVBfU1lTX0FETUlOKSkKPiBAQCAtMTQxLDcgKzE0MCw3IEBA
IHN0YXRpYyBpbnQgZmF0X2lvY3RsX2ZpdHJpbShzdHJ1Y3QgaW5vZGUgKmlub2RlLCB1bnNpZ25l
ZCBsb25nIGFyZykKPiAgCQlyZXR1cm4gLUVGQVVMVDsKPiAgCj4gIAlyYW5nZS5taW5sZW4gPSBt
YXhfdCh1bnNpZ25lZCBpbnQsIHJhbmdlLm1pbmxlbiwKPiAtCQkJICAgICBxLT5saW1pdHMuZGlz
Y2FyZF9ncmFudWxhcml0eSk7Cj4gKwkJCSAgICAgYmRldl9kaXNjYXJkX2dyYW51bGFyaXR5KHNi
LT5zX2JkZXYpKTsKPiAgCj4gIAllcnIgPSBmYXRfdHJpbV9mcyhpbm9kZSwgJnJhbmdlKTsKPiAg
CWlmIChlcnIgPCAwKQo+IGRpZmYgLS1naXQgYS9mcy9nZnMyL3JncnAuYyBiL2ZzL2dmczIvcmdy
cC5jCj4gaW5kZXggN2YyMGFjOTEzM2JjNi4uNmQyNmJiNTI1NDg0NCAxMDA2NDQKPiAtLS0gYS9m
cy9nZnMyL3JncnAuYwo+ICsrKyBiL2ZzL2dmczIvcmdycC5jCj4gQEAgLTEzODYsNyArMTM4Niw3
IEBAIGludCBnZnMyX2ZpdHJpbShzdHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCBfX3VzZXIgKmFyZ3Ap
Cj4gIHsKPiAgCXN0cnVjdCBpbm9kZSAqaW5vZGUgPSBmaWxlX2lub2RlKGZpbHApOwo+ICAJc3Ry
dWN0IGdmczJfc2JkICpzZHAgPSBHRlMyX1NCKGlub2RlKTsKPiAtCXN0cnVjdCByZXF1ZXN0X3F1
ZXVlICpxID0gYmRldl9nZXRfcXVldWUoc2RwLT5zZF92ZnMtPnNfYmRldik7Cj4gKwlzdHJ1Y3Qg
YmxvY2tfZGV2aWNlICpiZGV2ID0gc2RwLT5zZF92ZnMtPnNfYmRldjsKPiAgCXN0cnVjdCBidWZm
ZXJfaGVhZCAqYmg7Cj4gIAlzdHJ1Y3QgZ2ZzMl9yZ3JwZCAqcmdkOwo+ICAJc3RydWN0IGdmczJf
cmdycGQgKnJnZF9lbmQ7Cj4gQEAgLTE0MDUsNyArMTQwNSw3IEBAIGludCBnZnMyX2ZpdHJpbShz
dHJ1Y3QgZmlsZSAqZmlscCwgdm9pZCBfX3VzZXIgKmFyZ3ApCj4gIAlpZiAoIXRlc3RfYml0KFNE
Rl9KT1VSTkFMX0xJVkUsICZzZHAtPnNkX2ZsYWdzKSkKPiAgCQlyZXR1cm4gLUVST0ZTOwo+ICAK
PiAtCWlmICghYmRldl9tYXhfZGlzY2FyZF9zZWN0b3JzKHNkcC0+c2RfdmZzLT5zX2JkZXYpKQo+
ICsJaWYgKCFiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoYmRldikpCj4gIAkJcmV0dXJuIC1FT1BO
T1RTVVBQOwo+ICAKPiAgCWlmIChjb3B5X2Zyb21fdXNlcigmciwgYXJncCwgc2l6ZW9mKHIpKSkK
PiBAQCAtMTQxOCw4ICsxNDE4LDcgQEAgaW50IGdmczJfZml0cmltKHN0cnVjdCBmaWxlICpmaWxw
LCB2b2lkIF9fdXNlciAqYXJncCkKPiAgCXN0YXJ0ID0gci5zdGFydCA+PiBic19zaGlmdDsKPiAg
CWVuZCA9IHN0YXJ0ICsgKHIubGVuID4+IGJzX3NoaWZ0KTsKPiAgCW1pbmxlbiA9IG1heF90KHU2
NCwgci5taW5sZW4sIHNkcC0+c2Rfc2Iuc2JfYnNpemUpOwo+IC0JbWlubGVuID0gbWF4X3QodTY0
LCBtaW5sZW4sCj4gLQkJICAgICAgIHEtPmxpbWl0cy5kaXNjYXJkX2dyYW51bGFyaXR5KSA+PiBi
c19zaGlmdDsKPiArCW1pbmxlbiA9IG1heF90KHU2NCwgbWlubGVuLCBiZGV2X2Rpc2NhcmRfZ3Jh
bnVsYXJpdHkoYmRldikpID4+IGJzX3NoaWZ0Owo+ICAKPiAgCWlmIChlbmQgPD0gc3RhcnQgfHwg
bWlubGVuID4gc2RwLT5zZF9tYXhfcmdfZGF0YSkKPiAgCQlyZXR1cm4gLUVJTlZBTDsKPiBkaWZm
IC0tZ2l0IGEvZnMvamZzL2lvY3RsLmMgYi9mcy9qZnMvaW9jdGwuYwo+IGluZGV4IDM1N2FlNmU1
YzM2ZWMuLjFlN2IxNzdlY2U2MDUgMTAwNjQ0Cj4gLS0tIGEvZnMvamZzL2lvY3RsLmMKPiArKysg
Yi9mcy9qZnMvaW9jdGwuYwo+IEBAIC0xMTAsNyArMTEwLDYgQEAgbG9uZyBqZnNfaW9jdGwoc3Ry
dWN0IGZpbGUgKmZpbHAsIHVuc2lnbmVkIGludCBjbWQsIHVuc2lnbmVkIGxvbmcgYXJnKQo+ICAJ
Y2FzZSBGSVRSSU06Cj4gIAl7Cj4gIAkJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGlub2RlLT5p
X3NiOwo+IC0JCXN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxID0gYmRldl9nZXRfcXVldWUoc2ItPnNf
YmRldik7Cj4gIAkJc3RydWN0IGZzdHJpbV9yYW5nZSByYW5nZTsKPiAgCQlzNjQgcmV0ID0gMDsK
PiAgCj4gQEAgLTEyNyw3ICsxMjYsNyBAQCBsb25nIGpmc19pb2N0bChzdHJ1Y3QgZmlsZSAqZmls
cCwgdW5zaWduZWQgaW50IGNtZCwgdW5zaWduZWQgbG9uZyBhcmcpCj4gIAkJCXJldHVybiAtRUZB
VUxUOwo+ICAKPiAgCQlyYW5nZS5taW5sZW4gPSBtYXhfdCh1bnNpZ25lZCBpbnQsIHJhbmdlLm1p
bmxlbiwKPiAtCQkJcS0+bGltaXRzLmRpc2NhcmRfZ3JhbnVsYXJpdHkpOwo+ICsJCQkJICAgICBi
ZGV2X2Rpc2NhcmRfZ3JhbnVsYXJpdHkoc2ItPnNfYmRldikpOwo+ICAKPiAgCQlyZXQgPSBqZnNf
aW9jX3RyaW0oaW5vZGUsICZyYW5nZSk7Cj4gIAkJaWYgKHJldCA8IDApCj4gZGlmZiAtLWdpdCBh
L2ZzL25pbGZzMi9pb2N0bC5jIGIvZnMvbmlsZnMyL2lvY3RsLmMKPiBpbmRleCA1MmI3M2Y1NThm
Y2IxLi44N2UxMDA0YjYwNmQyIDEwMDY0NAo+IC0tLSBhL2ZzL25pbGZzMi9pb2N0bC5jCj4gKysr
IGIvZnMvbmlsZnMyL2lvY3RsLmMKPiBAQCAtMTA1Miw3ICsxMDUyLDYgQEAgc3RhdGljIGludCBu
aWxmc19pb2N0bF9yZXNpemUoc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbHAs
Cj4gIHN0YXRpYyBpbnQgbmlsZnNfaW9jdGxfdHJpbV9mcyhzdHJ1Y3QgaW5vZGUgKmlub2RlLCB2
b2lkIF9fdXNlciAqYXJncCkKPiAgewo+ICAJc3RydWN0IHRoZV9uaWxmcyAqbmlsZnMgPSBpbm9k
ZS0+aV9zYi0+c19mc19pbmZvOwo+IC0Jc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2X2dl
dF9xdWV1ZShuaWxmcy0+bnNfYmRldik7Cj4gIAlzdHJ1Y3QgZnN0cmltX3JhbmdlIHJhbmdlOwo+
ICAJaW50IHJldDsKPiAgCj4gQEAgLTEwNjUsNyArMTA2NCw4IEBAIHN0YXRpYyBpbnQgbmlsZnNf
aW9jdGxfdHJpbV9mcyhzdHJ1Y3QgaW5vZGUgKmlub2RlLCB2b2lkIF9fdXNlciAqYXJncCkKPiAg
CWlmIChjb3B5X2Zyb21fdXNlcigmcmFuZ2UsIGFyZ3AsIHNpemVvZihyYW5nZSkpKQo+ICAJCXJl
dHVybiAtRUZBVUxUOwo+ICAKPiAtCXJhbmdlLm1pbmxlbiA9IG1heF90KHU2NCwgcmFuZ2UubWlu
bGVuLCBxLT5saW1pdHMuZGlzY2FyZF9ncmFudWxhcml0eSk7Cj4gKwlyYW5nZS5taW5sZW4gPSBt
YXhfdCh1NjQsIHJhbmdlLm1pbmxlbiwKPiArCQkJICAgICBiZGV2X2Rpc2NhcmRfZ3JhbnVsYXJp
dHkobmlsZnMtPm5zX2JkZXYpKTsKPiAgCj4gIAlkb3duX3JlYWQoJm5pbGZzLT5uc19zZWdjdG9y
X3NlbSk7Cj4gIAlyZXQgPSBuaWxmc19zdWZpbGVfdHJpbV9mcyhuaWxmcy0+bnNfc3VmaWxlLCAm
cmFuZ2UpOwo+IGRpZmYgLS1naXQgYS9mcy9udGZzMy9maWxlLmMgYi9mcy9udGZzMy9maWxlLmMK
PiBpbmRleCBlNzYzMjM2MTY5MzMxLi4xNTgwNmVlYWUyMTdhIDEwMDY0NAo+IC0tLSBhL2ZzL250
ZnMzL2ZpbGUuYwo+ICsrKyBiL2ZzL250ZnMzL2ZpbGUuYwo+IEBAIC0yMiw3ICsyMiw2IEBAIHN0
YXRpYyBpbnQgbnRmc19pb2N0bF9maXRyaW0oc3RydWN0IG50ZnNfc2JfaW5mbyAqc2JpLCB1bnNp
Z25lZCBsb25nIGFyZykKPiAgewo+ICAJc3RydWN0IGZzdHJpbV9yYW5nZSBfX3VzZXIgKnVzZXJf
cmFuZ2U7Cj4gIAlzdHJ1Y3QgZnN0cmltX3JhbmdlIHJhbmdlOwo+IC0Jc3RydWN0IHJlcXVlc3Rf
cXVldWUgKnEgPSBiZGV2X2dldF9xdWV1ZShzYmktPnNiLT5zX2JkZXYpOwo+ICAJaW50IGVycjsK
PiAgCj4gIAlpZiAoIWNhcGFibGUoQ0FQX1NZU19BRE1JTikpCj4gQEAgLTM1LDcgKzM0LDggQEAg
c3RhdGljIGludCBudGZzX2lvY3RsX2ZpdHJpbShzdHJ1Y3QgbnRmc19zYl9pbmZvICpzYmksIHVu
c2lnbmVkIGxvbmcgYXJnKQo+ICAJaWYgKGNvcHlfZnJvbV91c2VyKCZyYW5nZSwgdXNlcl9yYW5n
ZSwgc2l6ZW9mKHJhbmdlKSkpCj4gIAkJcmV0dXJuIC1FRkFVTFQ7Cj4gIAo+IC0JcmFuZ2UubWlu
bGVuID0gbWF4X3QodTMyLCByYW5nZS5taW5sZW4sIHEtPmxpbWl0cy5kaXNjYXJkX2dyYW51bGFy
aXR5KTsKPiArCXJhbmdlLm1pbmxlbiA9IG1heF90KHUzMiwgcmFuZ2UubWlubGVuLAo+ICsJCQkg
ICAgIGJkZXZfZGlzY2FyZF9ncmFudWxhcml0eShzYmktPnNiLT5zX2JkZXYpKTsKPiAgCj4gIAll
cnIgPSBudGZzX3RyaW1fZnMoc2JpLCAmcmFuZ2UpOwo+ICAJaWYgKGVyciA8IDApCj4gZGlmZiAt
LWdpdCBhL2ZzL250ZnMzL3N1cGVyLmMgYi9mcy9udGZzMy9zdXBlci5jCj4gaW5kZXggYzczNDA4
NWJjY2U0YS4uNWYyZTQxNGNmYTc5YiAxMDA2NDQKPiAtLS0gYS9mcy9udGZzMy9zdXBlci5jCj4g
KysrIGIvZnMvbnRmczMvc3VwZXIuYwo+IEBAIC04ODIsNyArODgyLDYgQEAgc3RhdGljIGludCBu
dGZzX2ZpbGxfc3VwZXIoc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgc3RydWN0IGZzX2NvbnRleHQg
KmZjKQo+ICAJaW50IGVycjsKPiAgCXN0cnVjdCBudGZzX3NiX2luZm8gKnNiaSA9IHNiLT5zX2Zz
X2luZm87Cj4gIAlzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2ID0gc2ItPnNfYmRldjsKPiAtCXN0
cnVjdCByZXF1ZXN0X3F1ZXVlICpycTsKPiAgCXN0cnVjdCBpbm9kZSAqaW5vZGU7Cj4gIAlzdHJ1
Y3QgbnRmc19pbm9kZSAqbmk7Cj4gIAlzaXplX3QgaSwgdHQ7Cj4gQEAgLTkxMiw5ICs5MTEsOCBA
QCBzdGF0aWMgaW50IG50ZnNfZmlsbF9zdXBlcihzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLCBzdHJ1
Y3QgZnNfY29udGV4dCAqZmMpCj4gIAkJZ290byBvdXQ7Cj4gIAl9Cj4gIAo+IC0JcnEgPSBiZGV2
X2dldF9xdWV1ZShiZGV2KTsKPiAtCWlmIChiZGV2X21heF9kaXNjYXJkX3NlY3RvcnMoYmRldikg
JiYgcnEtPmxpbWl0cy5kaXNjYXJkX2dyYW51bGFyaXR5KSB7Cj4gLQkJc2JpLT5kaXNjYXJkX2dy
YW51bGFyaXR5ID0gcnEtPmxpbWl0cy5kaXNjYXJkX2dyYW51bGFyaXR5Owo+ICsJaWYgKGJkZXZf
bWF4X2Rpc2NhcmRfc2VjdG9ycyhiZGV2KSAmJiBiZGV2X2Rpc2NhcmRfZ3JhbnVsYXJpdHkoYmRl
dikpIHsKPiArCQlzYmktPmRpc2NhcmRfZ3JhbnVsYXJpdHkgPSBiZGV2X2Rpc2NhcmRfZ3JhbnVs
YXJpdHkoYmRldik7Cj4gIAkJc2JpLT5kaXNjYXJkX2dyYW51bGFyaXR5X21hc2tfaW52ID0KPiAg
CQkJfih1NjQpKHNiaS0+ZGlzY2FyZF9ncmFudWxhcml0eSAtIDEpOwo+ICAJfQo+IGRpZmYgLS1n
aXQgYS9mcy9vY2ZzMi9pb2N0bC5jIGIvZnMvb2NmczIvaW9jdGwuYwo+IGluZGV4IDliNzhlZjEw
M2FkYTYuLmFmZDU0ZWM2NjEwMzAgMTAwNjQ0Cj4gLS0tIGEvZnMvb2NmczIvaW9jdGwuYwo+ICsr
KyBiL2ZzL29jZnMyL2lvY3RsLmMKPiBAQCAtOTAzLDcgKzkwMyw2IEBAIGxvbmcgb2NmczJfaW9j
dGwoc3RydWN0IGZpbGUgKmZpbHAsIHVuc2lnbmVkIGludCBjbWQsIHVuc2lnbmVkIGxvbmcgYXJn
KQo+ICAJY2FzZSBGSVRSSU06Cj4gIAl7Cj4gIAkJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiA9IGlu
b2RlLT5pX3NiOwo+IC0JCXN0cnVjdCByZXF1ZXN0X3F1ZXVlICpxID0gYmRldl9nZXRfcXVldWUo
c2ItPnNfYmRldik7Cj4gIAkJc3RydWN0IGZzdHJpbV9yYW5nZSByYW5nZTsKPiAgCQlpbnQgcmV0
ID0gMDsKPiAgCj4gQEAgLTkxNiw3ICs5MTUsNyBAQCBsb25nIG9jZnMyX2lvY3RsKHN0cnVjdCBm
aWxlICpmaWxwLCB1bnNpZ25lZCBpbnQgY21kLCB1bnNpZ25lZCBsb25nIGFyZykKPiAgCQlpZiAo
Y29weV9mcm9tX3VzZXIoJnJhbmdlLCBhcmdwLCBzaXplb2YocmFuZ2UpKSkKPiAgCQkJcmV0dXJu
IC1FRkFVTFQ7Cj4gIAo+IC0JCXJhbmdlLm1pbmxlbiA9IG1heF90KHU2NCwgcS0+bGltaXRzLmRp
c2NhcmRfZ3JhbnVsYXJpdHksCj4gKwkJcmFuZ2UubWlubGVuID0gbWF4X3QodTY0LCBiZGV2X2Rp
c2NhcmRfZ3JhbnVsYXJpdHkoc2ItPnNfYmRldiksCj4gIAkJCQkgICAgIHJhbmdlLm1pbmxlbik7
Cj4gIAkJcmV0ID0gb2NmczJfdHJpbV9mcyhzYiwgJnJhbmdlKTsKPiAgCQlpZiAocmV0IDwgMCkK
PiBkaWZmIC0tZ2l0IGEvZnMveGZzL3hmc19kaXNjYXJkLmMgYi9mcy94ZnMveGZzX2Rpc2NhcmQu
Ywo+IGluZGV4IGE0ZTY2MDlkNjE2YjcuLmUyYWRhMTE1YzIzZjkgMTAwNjQ0Cj4gLS0tIGEvZnMv
eGZzL3hmc19kaXNjYXJkLmMKPiArKysgYi9mcy94ZnMveGZzX2Rpc2NhcmQuYwo+IEBAIC0xNTIs
OCArMTUyLDggQEAgeGZzX2lvY190cmltKAo+ICAJc3RydWN0IHhmc19tb3VudAkJKm1wLAo+ICAJ
c3RydWN0IGZzdHJpbV9yYW5nZSBfX3VzZXIJKnVyYW5nZSkKPiAgewo+IC0Jc3RydWN0IHJlcXVl
c3RfcXVldWUJKnEgPSBiZGV2X2dldF9xdWV1ZShtcC0+bV9kZGV2X3RhcmdwLT5idF9iZGV2KTsK
PiAtCXVuc2lnbmVkIGludAkJZ3JhbnVsYXJpdHkgPSBxLT5saW1pdHMuZGlzY2FyZF9ncmFudWxh
cml0eTsKPiArCXVuc2lnbmVkIGludAkJZ3JhbnVsYXJpdHkgPQo+ICsJCWJkZXZfZGlzY2FyZF9n
cmFudWxhcml0eShtcC0+bV9kZGV2X3RhcmdwLT5idF9iZGV2KTsKPiAgCXN0cnVjdCBmc3RyaW1f
cmFuZ2UJcmFuZ2U7Cj4gIAl4ZnNfZGFkZHJfdAkJc3RhcnQsIGVuZCwgbWlubGVuOwo+ICAJeGZz
X2FnbnVtYmVyX3QJCXN0YXJ0X2Fnbm8sIGVuZF9hZ25vLCBhZ25vOwo+IGRpZmYgLS1naXQgYS9p
bmNsdWRlL2xpbnV4L2Jsa2Rldi5oIGIvaW5jbHVkZS9saW51eC9ibGtkZXYuaAo+IGluZGV4IGNl
MTYyNDdkM2FmYWIuLjdiOWMwY2Y5NWQyZDUgMTAwNjQ0Cj4gLS0tIGEvaW5jbHVkZS9saW51eC9i
bGtkZXYuaAo+ICsrKyBiL2luY2x1ZGUvbGludXgvYmxrZGV2LmgKPiBAQCAtMTI1OSw2ICsxMjU5
LDExIEBAIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50IGJkZXZfbWF4X2Rpc2NhcmRfc2VjdG9y
cyhzdHJ1Y3QgYmxvY2tfZGV2aWNlICpiZGV2KQo+ICAJcmV0dXJuIGJkZXZfZ2V0X3F1ZXVlKGJk
ZXYpLT5saW1pdHMubWF4X2Rpc2NhcmRfc2VjdG9yczsKPiAgfQo+ICAKPiArc3RhdGljIGlubGlu
ZSB1bnNpZ25lZCBpbnQgYmRldl9kaXNjYXJkX2dyYW51bGFyaXR5KHN0cnVjdCBibG9ja19kZXZp
Y2UgKmJkZXYpCj4gK3sKPiArCXJldHVybiBiZGV2X2dldF9xdWV1ZShiZGV2KS0+bGltaXRzLmRp
c2NhcmRfZ3JhbnVsYXJpdHk7Cj4gK30KPiArCj4gIHN0YXRpYyBpbmxpbmUgdW5zaWduZWQgaW50
IGJkZXZfd3JpdGVfemVyb2VzX3NlY3RvcnMoc3RydWN0IGJsb2NrX2RldmljZSAqYmRldikKPiAg
ewo+ICAJc3RydWN0IHJlcXVlc3RfcXVldWUgKnEgPSBiZGV2X2dldF9xdWV1ZShiZGV2KTsKCi0t
IApDaHJpc3RvcGggQsO2aG13YWxkZXIKTElOQklUIHwgS2VlcGluZyB0aGUgRGlnaXRhbCBXb3Js
ZCBSdW5uaW5nCkRSQkQgSEEg4oCUICBEaXNhc3RlciBSZWNvdmVyeSDigJQgU29mdHdhcmUgZGVm
aW5lZCBTdG9yYWdlCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCmRyYmQtZGV2IG1haWxpbmcgbGlzdApkcmJkLWRldkBsaXN0cy5saW5iaXQuY29tCmh0dHBz
Oi8vbGlzdHMubGluYml0LmNvbS9tYWlsbWFuL2xpc3RpbmZvL2RyYmQtZGV2Cg==
